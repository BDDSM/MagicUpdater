<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<DOCUMENT Type="Advanced Installer" CreateVersion="13.5" version="13.5" Modules="architect" RootPath="." Language="ru" Id="{011EDBB3-EC46-4B0D-A0C5-797A6C5637CF}">
  <COMPONENT cid="caphyon.advinst.msicomp.ProjectOptionsComponent">
    <ROW Name="HiddenItems" Value="AppXProductDetailsComponent;AppXDependenciesComponent;AppXAppDetailsComponent;AppXVisualAssetsComponent;AppXCapabilitiesComponent;AppXAppDeclarationsComponent;AppXUriRulesComponent;ActSyncAppComponent"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.MsiPropsComponent">
    <ROW Property="AI_BITMAP_DISPLAY_MODE" Value="0"/>
    <ROW Property="AI_CLEAN_RESOURCES_DISABLE_UPGRADE" Value="1"/>
    <ROW Property="AI_CLEAN_RESOURCES_UNINSTALL" Value="1"/>
    <ROW Property="AI_CLEAN_RESOURCES_USER_PROMPT_BASIC_UI" Value="0"/>
    <ROW Property="AI_CLEAN_RESOURCES_USER_PROMPT_FULL_UI" Value="0"/>
    <ROW Property="AI_FINDEXE_TITLE" Value="Выберите установочный пакет для [|ProductName]" ValueLocId="AI.Property.FindExeTitle"/>
    <ROW Property="AI_ThemeStyle" Value="default" MultiBuildValue="DefaultBuild:classic" MsiKey="AI_ThemeStyle"/>
    <ROW Property="ALLUSERS" Value="1"/>
    <ROW Property="ARPCOMMENTS" Value="Эта база данных установщика содержит логику и данные, необходимые для установки [|[ProductName]." ValueLocId="*"/>
    <ROW Property="ARPNOMODIFY" MultiBuildValue="DefaultBuild:1"/>
    <ROW Property="ARPNOREPAIR" Value="1"/>
    <ROW Property="BASE1C_PROP" Value="base1c" Type="4"/>
    <ROW Property="CONFIG1C_PROP" Value="1С:Розница 2.2" Type="4"/>
    <ROW Property="FTPCATALOG_PROP" Value="MagicUpdater" Type="4"/>
    <ROW Property="FTPLOGIN_PROP" Value="ftpuser" Type="4"/>
    <ROW Property="FTPSERVER_PROP" Value="ftpserver.orgname.ru" Type="4"/>
    <ROW Property="FTPTMPCATALOG_PROP" Value="MagicUpdater\TempFiles" Type="4"/>
    <ROW Property="Manufacturer" Value="Magic Updater"/>
    <ROW Property="ONLY_MONITOR" Value="0"/>
    <ROW Property="OnlyMonitor" Value="1"/>
    <ROW Property="PLATFORM1C_PROP" Value="8.3.7.1970" Type="4"/>
    <ROW Property="ProductCode" Value="1049:{D39CC5F7-2281-462D-B6F0-EF40CAAA0E65} " Type="16"/>
    <ROW Property="ProductLanguage" Value="1049"/>
    <ROW Property="ProductName" Value="Magic Updater"/>
    <ROW Property="ProductVersion" Value="1.0.0" Type="32"/>
    <ROW Property="SERVER1C_PROP" Value="server1c" Type="4"/>
    <ROW Property="SQL_TRUSTED_CONNECTION" Type="4" MsiKey="SQL_TRUSTED_CONNECTION"/>
    <ROW Property="SecureCustomProperties" Value="OLDPRODUCTS;AI_NEWERPRODUCTFOUND;AI_SETUPEXEPATH;SETUPEXEDIR"/>
    <ROW Property="USER1C_PROP" Value="Администратор" Type="4"/>
    <ROW Property="UpgradeCode" Value="{630C245A-2752-4751-AE30-5F0729877696}"/>
    <ROW Property="WindowsType9X" MultiBuildValue="DefaultBuild:Windows 9x/ME" ValueLocId="-"/>
    <ROW Property="WindowsType9XDisplay" MultiBuildValue="DefaultBuild:Windows 9x/ME" ValueLocId="-"/>
    <ROW Property="WindowsTypeNT" MultiBuildValue="DefaultBuild:Windows XP x86 Service Pack 3, Windows Server 2003 x86 Service Pack 2, Windows Vista x86, Windows Vista x86 Service Pack 1, Windows Vista x86 Service Pack 2" ValueLocId="-"/>
    <ROW Property="WindowsTypeNT40" MultiBuildValue="DefaultBuild:Windows NT 4.0" ValueLocId="-"/>
    <ROW Property="WindowsTypeNT40Display" MultiBuildValue="DefaultBuild:Windows NT 4.0" ValueLocId="-"/>
    <ROW Property="WindowsTypeNT50" MultiBuildValue="DefaultBuild:Windows 2000" ValueLocId="-"/>
    <ROW Property="WindowsTypeNT50Display" MultiBuildValue="DefaultBuild:Windows 2000" ValueLocId="-"/>
    <ROW Property="WindowsTypeNT5X" MultiBuildValue="DefaultBuild:Windows XP/2003 RTM, Windows XP/2003 SP1, Windows XP SP2 x86" ValueLocId="-"/>
    <ROW Property="WindowsTypeNT5XDisplay" MultiBuildValue="DefaultBuild:Windows XP/2003 RTM, Windows XP/2003 SP1, Windows XP SP2 x86" ValueLocId="-"/>
    <ROW Property="WindowsTypeNT64" MultiBuildValue="DefaultBuild:Windows XP x64 Service Pack 2, Windows Server 2003 x64 Service Pack 2, Windows Vista x64, Windows Vista x64 Service Pack 1, Windows Vista x64 Service Pack 2" ValueLocId="-"/>
    <ROW Property="WindowsTypeNT64Display" MultiBuildValue="DefaultBuild:Windows XP x64 Service Pack 2, Windows Server 2003 x64 Service Pack 2, Windows Vista x64" ValueLocId="-"/>
    <ROW Property="WindowsTypeNTDisplay" MultiBuildValue="DefaultBuild:Windows XP x86 Service Pack 3, Windows Server 2003 x86 Service Pack 2, Windows Vista x86" ValueLocId="-"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.MsiDirsComponent">
    <ROW Directory="APPDIR" Directory_Parent="TARGETDIR" DefaultDir="APPDIR:." IsPseudoRoot="1"/>
    <ROW Directory="BinariesToFTP_Dir" Directory_Parent="APPDIR" DefaultDir="BINARI~1|BinariesToFTP"/>
    <ROW Directory="CProcs_Dir" Directory_Parent="APPDIR" DefaultDir="1CProcs"/>
    <ROW Directory="DesktopFolder" Directory_Parent="TARGETDIR" DefaultDir="DESKTO~1|DesktopFolder" IsPseudoRoot="1"/>
    <ROW Directory="HelpFiles_Dir" Directory_Parent="BinariesToFTP_Dir" DefaultDir="HELPFI~1|HelpFiles"/>
    <ROW Directory="MagicUpdater_Dir" Directory_Parent="ProgramMenuFolder" DefaultDir="MAGICU~1|Magic Updater"/>
    <ROW Directory="OperationPlugin_1_Dir" Directory_Parent="BinariesToFTP_Dir" DefaultDir="OPERAT~1|OperationPlugin"/>
    <ROW Directory="OperationPlugin_Dir" Directory_Parent="APPDIR" DefaultDir="OPERAT~1|OperationPlugin"/>
    <ROW Directory="ProgramMenuFolder" Directory_Parent="TARGETDIR" DefaultDir="PROGRA~1|ProgramMenuFolder" IsPseudoRoot="1"/>
    <ROW Directory="SHORTCUTDIR" Directory_Parent="TARGETDIR" DefaultDir="SHORTC~1|SHORTCUTDIR" IsPseudoRoot="1"/>
    <ROW Directory="ServiceInstaller_Dir" Directory_Parent="APPDIR" DefaultDir="SERVIC~1|ServiceInstaller"/>
    <ROW Directory="Sources_Dir" Directory_Parent="OperationPlugin_Dir" DefaultDir="Sources"/>
    <ROW Directory="TARGETDIR" DefaultDir="SourceDir"/>
    <ROW Directory="restart_Dir" Directory_Parent="BinariesToFTP_Dir" DefaultDir="restart"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.MsiCompsComponent">
    <ROW Component="AI_ExePath" ComponentId="{DA71CC39-10F2-4C93-9BDA-79400215C504}" Directory_="APPDIR" Attributes="4" KeyPath="AI_ExePath"/>
    <ROW Component="BackupBaseSqlPlugin.dll" ComponentId="{0BD6CFA6-BE70-4802-AF4C-7EFDFAA4DFDD}" Directory_="OperationPlugin_Dir" Attributes="0" KeyPath="BackupBaseSqlPlugin.dll"/>
    <ROW Component="BackupBaseSqlPlugin.dll_1" ComponentId="{D105C4E1-B303-4B69-8C46-74A93667CE31}" Directory_="OperationPlugin_1_Dir" Attributes="0" KeyPath="BackupBaseSqlPlugin.dll_1"/>
    <ROW Component="CacheClear1CPlugin.dll" ComponentId="{A814A6C7-4AB1-4A0E-B5C4-601B319ED010}" Directory_="OperationPlugin_Dir" Attributes="0" KeyPath="CacheClear1CPlugin.dll"/>
    <ROW Component="CacheClear1CPlugin.dll_2" ComponentId="{5110D3D1-5DFB-42A3-B88B-C8FEF4C6F6E1}" Directory_="OperationPlugin_1_Dir" Attributes="0" KeyPath="CacheClear1CPlugin.dll_2"/>
    <ROW Component="CheckFileExistsPlugin.dll" ComponentId="{558F77D2-21D3-4EA9-ADBC-99B959F9DB9C}" Directory_="OperationPlugin_Dir" Attributes="0" KeyPath="CheckFileExistsPlugin.dll"/>
    <ROW Component="CheckFileExistsPlugin.dll_1" ComponentId="{73C30A15-BB51-4EAC-ADBD-A6D8E722A3D5}" Directory_="OperationPlugin_1_Dir" Attributes="0" KeyPath="CheckFileExistsPlugin.dll_1"/>
    <ROW Component="Communications.dll" ComponentId="{5B52C1C9-78B7-4658-B96D-2701E303E0BF}" Directory_="APPDIR" Attributes="0" KeyPath="Communications.dll"/>
    <ROW Component="Communications.dll_1" ComponentId="{650E141F-ACF0-4D11-8D0B-0D694F33D7BA}" Directory_="BinariesToFTP_Dir" Attributes="0" KeyPath="Communications.dll_1"/>
    <ROW Component="Communications.dll_2" ComponentId="{C6B951D4-DD79-480A-A048-B0D8248AB680}" Directory_="restart_Dir" Attributes="0" KeyPath="Communications.dll_2"/>
    <ROW Component="CouchDBDeployerPlugin.dll" ComponentId="{C538C9CF-CB13-4091-A097-FC01D0596359}" Directory_="OperationPlugin_Dir" Attributes="0" KeyPath="CouchDBDeployerPlugin.dll"/>
    <ROW Component="CouchDBDeployerPlugin.dll_1" ComponentId="{8B3033E4-336E-49A6-A810-F06ACB4FBFD2}" Directory_="OperationPlugin_1_Dir" Attributes="0" KeyPath="CouchDBDeployerPlugin.dll_1"/>
    <ROW Component="CouchDbExecuteCommandPlugin.dll" ComponentId="{0FD62A08-CEDE-4153-9B6B-A9BF332748E8}" Directory_="OperationPlugin_Dir" Attributes="0" KeyPath="CouchDbExecuteCommandPlugin.dll"/>
    <ROW Component="CouchDbExecuteCommandPlugin.dll_1" ComponentId="{0E049832-4F92-447E-8051-1DE8AF12AB73}" Directory_="OperationPlugin_1_Dir" Attributes="0" KeyPath="CouchDbExecuteCommandPlugin.dll_1"/>
    <ROW Component="CouchDbInitIndexPlugin.dll" ComponentId="{2FBBA85D-D643-4302-A08A-83846E690B7C}" Directory_="OperationPlugin_Dir" Attributes="0" KeyPath="CouchDbInitIndexPlugin.dll"/>
    <ROW Component="CouchDbInitIndexPlugin.dll_1" ComponentId="{D2B527F6-7400-4D7F-B1AA-D3049142BA37}" Directory_="OperationPlugin_1_Dir" Attributes="0" KeyPath="CouchDbInitIndexPlugin.dll_1"/>
    <ROW Component="DotNetZip.dll" ComponentId="{4BE153FB-060D-418D-8FA7-7205CB0AB385}" Directory_="APPDIR" Attributes="0" KeyPath="DotNetZip.dll"/>
    <ROW Component="DotNetZip.dll_1" ComponentId="{D3F02071-035E-467B-93BE-1A52ADCB1D64}" Directory_="BinariesToFTP_Dir" Attributes="0" KeyPath="DotNetZip.dll_1"/>
    <ROW Component="DotNetZip.dll_2" ComponentId="{11850764-B078-4502-86DA-9535D97314D4}" Directory_="restart_Dir" Attributes="0" KeyPath="DotNetZip.dll_2"/>
    <ROW Component="DownloadAnyFilesPlugin.dll" ComponentId="{2A9948B2-5E6C-4EE6-A30A-515CE93F5CAA}" Directory_="OperationPlugin_Dir" Attributes="0" KeyPath="DownloadAnyFilesPlugin.dll"/>
    <ROW Component="DownloadAnyFilesPlugin.dll_1" ComponentId="{F62443B1-99E8-41E9-BCF3-93765EAF295E}" Directory_="OperationPlugin_1_Dir" Attributes="0" KeyPath="DownloadAnyFilesPlugin.dll_1"/>
    <ROW Component="DynamicUpdate1CPlugin.dll" ComponentId="{84854A8F-EAF6-46AE-BCBB-16695C3D8B8D}" Directory_="OperationPlugin_Dir" Attributes="0" KeyPath="DynamicUpdate1CPlugin.dll"/>
    <ROW Component="DynamicUpdate1CPlugin.dll_2" ComponentId="{A81BA4F8-42C2-45ED-A112-944DE32B730E}" Directory_="OperationPlugin_1_Dir" Attributes="0" KeyPath="DynamicUpdate1CPlugin.dll_2"/>
    <ROW Component="EntityFramework.SqlServer.dll" ComponentId="{1B020E0F-0B88-4F68-91DD-C6957BA54C49}" Directory_="APPDIR" Attributes="0" KeyPath="EntityFramework.SqlServer.dll"/>
    <ROW Component="EntityFramework.dll" ComponentId="{38CAD36F-75E3-46C2-AC3D-EAA2B9B0ED21}" Directory_="APPDIR" Attributes="0" KeyPath="EntityFramework.dll"/>
    <ROW Component="ExecAnySqlPlugin.dll" ComponentId="{82778A21-682E-446C-BFF6-1ED57A5A7B74}" Directory_="OperationPlugin_Dir" Attributes="0" KeyPath="ExecAnySqlPlugin.dll"/>
    <ROW Component="ExecAnySqlPlugin.dll_1" ComponentId="{AD9CD697-1F27-4B0D-84E3-37DFFECAF83C}" Directory_="OperationPlugin_1_Dir" Attributes="0" KeyPath="ExecAnySqlPlugin.dll_1"/>
    <ROW Component="ExecProcessing1CPlugin.dll" ComponentId="{EDD5503C-A84F-4388-AD18-02E36012A001}" Directory_="OperationPlugin_Dir" Attributes="0" KeyPath="ExecProcessing1CPlugin.dll"/>
    <ROW Component="ExecProcessing1CPlugin.dll_1" ComponentId="{9189227F-8B72-400C-B1D3-714A413402D9}" Directory_="OperationPlugin_1_Dir" Attributes="0" KeyPath="ExecProcessing1CPlugin.dll_1"/>
    <ROW Component="FileBackupBasePlugin.dll" ComponentId="{D3C2DECF-31E9-40A2-929B-22E01DC0C5E6}" Directory_="OperationPlugin_Dir" Attributes="0" KeyPath="FileBackupBasePlugin.dll"/>
    <ROW Component="FileBackupBasePlugin.dll_2" ComponentId="{02F781FA-8884-4174-AA5A-C51264B9E102}" Directory_="OperationPlugin_1_Dir" Attributes="0" KeyPath="FileBackupBasePlugin.dll_2"/>
    <ROW Component="FileDynamicUpdate1CPlugin.dll" ComponentId="{DDEAE6C4-9D68-43B2-85AC-93D29FD7658D}" Directory_="OperationPlugin_Dir" Attributes="0" KeyPath="FileDynamicUpdate1CPlugin.dll"/>
    <ROW Component="FileDynamicUpdate1CPlugin.dll_2" ComponentId="{A4F8187D-200B-4F77-BF0B-A69B1B930E8B}" Directory_="OperationPlugin_1_Dir" Attributes="0" KeyPath="FileDynamicUpdate1CPlugin.dll_2"/>
    <ROW Component="FileUpdate1CPlugin.dll" ComponentId="{4CB48C77-18FF-4C95-BE93-D619500E1FCC}" Directory_="OperationPlugin_Dir" Attributes="0" KeyPath="FileUpdate1CPlugin.dll"/>
    <ROW Component="FileUpdate1CPlugin.dll_2" ComponentId="{A0D4EAE9-502B-47AE-96E9-AADB231084D4}" Directory_="OperationPlugin_1_Dir" Attributes="0" KeyPath="FileUpdate1CPlugin.dll_2"/>
    <ROW Component="ForceStaticUpdate1CPlugin.dll" ComponentId="{69FC9370-E735-4056-B7D2-723E0E42C8AE}" Directory_="OperationPlugin_Dir" Attributes="0" KeyPath="ForceStaticUpdate1CPlugin.dll"/>
    <ROW Component="ForceStaticUpdate1CPlugin.dll_1" ComponentId="{D6B66645-B877-4BB1-9574-8D3C6B41CE28}" Directory_="OperationPlugin_1_Dir" Attributes="0" KeyPath="ForceStaticUpdate1CPlugin.dll_1"/>
    <ROW Component="KillForceStaticUpdate1CPlugin.dll" ComponentId="{A254254B-A047-46AB-B3E8-BB1FA8D8A278}" Directory_="OperationPlugin_Dir" Attributes="0" KeyPath="KillForceStaticUpdate1CPlugin.dll"/>
    <ROW Component="KillForceStaticUpdate1CPlugin.dll_1" ComponentId="{32664912-EA41-4FCA-A5BE-6F3BC8BCDD75}" Directory_="OperationPlugin_1_Dir" Attributes="0" KeyPath="KillForceStaticUpdate1CPlugin.dll_1"/>
    <ROW Component="LockBackgroundJobsPlugin.dll" ComponentId="{B238D0E2-85AD-4E9A-8849-9D775DE74674}" Directory_="OperationPlugin_Dir" Attributes="0" KeyPath="LockBackgroundJobsPlugin.dll"/>
    <ROW Component="LockBackgroundJobsPlugin.dll_2" ComponentId="{DAA12EA1-D6C4-4B94-A77C-E57F4EAB14BF}" Directory_="OperationPlugin_1_Dir" Attributes="0" KeyPath="LockBackgroundJobsPlugin.dll_2"/>
    <ROW Component="MagicUpdater" ComponentId="{11A63900-6EB6-430B-A4F0-499FC627D1EC}" Directory_="MagicUpdater_Dir" Attributes="0"/>
    <ROW Component="MagicUpdater.DL.dll" ComponentId="{4AAEC33B-6B34-4EDF-BD3E-FFE3431C9578}" Directory_="APPDIR" Attributes="0" KeyPath="MagicUpdater.DL.dll"/>
    <ROW Component="MagicUpdater.InstallLog" ComponentId="{2C6086FF-6F12-4E07-9E78-BE6A41744D30}" Directory_="BinariesToFTP_Dir" Attributes="0" KeyPath="MagicUpdater.InstallLog" Type="0"/>
    <ROW Component="MagicUpdater.exe" ComponentId="{72455A62-BD01-4860-9ACA-42C080FC8B50}" Directory_="BinariesToFTP_Dir" Attributes="0" KeyPath="MagicUpdater.exe"/>
    <ROW Component="MagicUpdaterCommon.dll" ComponentId="{54679AC5-EFC3-4E13-BB0E-41E912FBACF8}" Directory_="APPDIR" Attributes="0" KeyPath="MagicUpdaterCommon.dll"/>
    <ROW Component="MagicUpdaterCommon.dll_1" ComponentId="{37645A91-B90F-4A6B-B390-6E39585B91DF}" Directory_="BinariesToFTP_Dir" Attributes="0" KeyPath="MagicUpdaterCommon.dll_1"/>
    <ROW Component="MagicUpdaterCommon.dll_2" ComponentId="{1E8F5195-C40A-4F12-8731-657A285084DC}" Directory_="restart_Dir" Attributes="0" KeyPath="MagicUpdaterCommon.dll_2"/>
    <ROW Component="MagicUpdaterMonitor.exe" ComponentId="{6E47E967-B7BD-4E1E-8C8B-F60C68ADA5CD}" Directory_="APPDIR" Attributes="0" KeyPath="MagicUpdaterMonitor.exe"/>
    <ROW Component="MagicUpdaterPluginSources.rar" ComponentId="{FAA8F48D-1062-4F0D-BAA9-CC4D0F2C6E76}" Directory_="Sources_Dir" Attributes="0" KeyPath="MagicUpdaterPluginSources.rar" Type="0"/>
    <ROW Component="MagicUpdaterRestart.exe" ComponentId="{09793202-8AB2-43F5-9D2A-D280AB211BF0}" Directory_="restart_Dir" Attributes="0" KeyPath="MagicUpdaterRestart.exe"/>
    <ROW Component="MagicUpdaterRestart.exe.config" ComponentId="{44B427B1-2B82-47DA-ABA8-7279B8447EC2}" Directory_="restart_Dir" Attributes="0" KeyPath="MagicUpdaterRestart.exe.config" Type="0"/>
    <ROW Component="MagicUpdaterSetup.exe" ComponentId="{4A228572-35CF-489A-BB8C-97C3D0783F42}" Directory_="ServiceInstaller_Dir" Attributes="0" KeyPath="MagicUpdaterSetup.exe"/>
    <ROW Component="NLog.dll" ComponentId="{3F6ADD41-EF24-4E51-AB74-286D96130297}" Directory_="APPDIR" Attributes="0" KeyPath="NLog.dll"/>
    <ROW Component="NLog.dll_1" ComponentId="{B9065CD6-E5B7-417C-9D42-E2575B0426B5}" Directory_="BinariesToFTP_Dir" Attributes="0" KeyPath="NLog.dll_1"/>
    <ROW Component="NLog.dll_2" ComponentId="{D7FFF774-2B50-461D-85DE-3E9742F5C4C8}" Directory_="restart_Dir" Attributes="0" KeyPath="NLog.dll_2"/>
    <ROW Component="Newtonsoft.Json.dll" ComponentId="{D913470E-3EDA-4A67-B4C4-2BD77F457522}" Directory_="APPDIR" Attributes="0" KeyPath="Newtonsoft.Json.dll"/>
    <ROW Component="Newtonsoft.Json.dll_1" ComponentId="{36EE77FC-01C4-4EAC-B898-C5CD0F3F69EE}" Directory_="BinariesToFTP_Dir" Attributes="0" KeyPath="Newtonsoft.Json.dll_1"/>
    <ROW Component="Newtonsoft.Json.dll_2" ComponentId="{5A00E518-4DEF-4DE4-BC13-0A3823F7BF9B}" Directory_="restart_Dir" Attributes="0" KeyPath="Newtonsoft.Json.dll_2"/>
    <ROW Component="OperationExchangeToCenterPlugin.dll" ComponentId="{D6765319-F87C-44CD-B925-92EAE2EAF496}" Directory_="OperationPlugin_Dir" Attributes="0" KeyPath="OperationExchangeToCenterPlugin.dll"/>
    <ROW Component="OperationExchangeToCenterPlugin.dll_1" ComponentId="{E91D7ACA-9EAA-45EB-866E-A46014D8EA70}" Directory_="OperationPlugin_1_Dir" Attributes="0" KeyPath="OperationExchangeToCenterPlugin.dll_1"/>
    <ROW Component="ProductInformation" ComponentId="{03B8E4C4-07A7-4C84-92DF-A7B7880271B4}" Directory_="APPDIR" Attributes="4" KeyPath="Version"/>
    <ROW Component="RenameAnyFilePlugin.dll" ComponentId="{D58D4B98-B722-48E6-9750-2D9399CB716F}" Directory_="OperationPlugin_Dir" Attributes="0" KeyPath="RenameAnyFilePlugin.dll"/>
    <ROW Component="RenameAnyFilePlugin.dll_1" ComponentId="{DD9E0BE8-F16D-4119-90F2-E8B04307586D}" Directory_="OperationPlugin_1_Dir" Attributes="0" KeyPath="RenameAnyFilePlugin.dll_1"/>
    <ROW Component="RestartComputerPlugin.dll" ComponentId="{1E9D6436-0100-4795-8FD5-B5E8FE8341D3}" Directory_="OperationPlugin_Dir" Attributes="0" KeyPath="RestartComputerPlugin.dll"/>
    <ROW Component="RestartComputerPlugin.dll_2" ComponentId="{C5448CE6-4E63-4732-B4A7-DF2432AC15F5}" Directory_="OperationPlugin_1_Dir" Attributes="0" KeyPath="RestartComputerPlugin.dll_2"/>
    <ROW Component="RestartServer1CPlugin.dll" ComponentId="{6E9B8AC9-F9CD-4209-9981-11B9D1ADEBC3}" Directory_="OperationPlugin_Dir" Attributes="0" KeyPath="RestartServer1CPlugin.dll"/>
    <ROW Component="RestartServer1CPlugin.dll_2" ComponentId="{C35E78E2-706E-4D25-9B86-84E439F46C1B}" Directory_="OperationPlugin_1_Dir" Attributes="0" KeyPath="RestartServer1CPlugin.dll_2"/>
    <ROW Component="SHORTCUTDIR" ComponentId="{F4BD07F5-4911-431D-9F95-D96D08D836C8}" Directory_="SHORTCUTDIR" Attributes="0"/>
    <ROW Component="Scs.dll" ComponentId="{1E8B598B-4059-46B9-AA24-078B62D5DF60}" Directory_="APPDIR" Attributes="0" KeyPath="Scs.dll"/>
    <ROW Component="Scs.dll_2" ComponentId="{0750DCBA-6B36-4559-AF13-D2566CC7C461}" Directory_="BinariesToFTP_Dir" Attributes="0" KeyPath="Scs.dll_2"/>
    <ROW Component="Scs.dll_3" ComponentId="{51BF4BF4-5D90-4CBC-B767-4A37DB3EBF6F}" Directory_="restart_Dir" Attributes="0" KeyPath="Scs.dll_3"/>
    <ROW Component="SetAutomaticDelayedStartPlugin.dll" ComponentId="{7025D3BC-36A3-4F1E-9274-5FAC549B6D89}" Directory_="OperationPlugin_Dir" Attributes="0" KeyPath="SetAutomaticDelayedStartPlugin.dll"/>
    <ROW Component="SetAutomaticDelayedStartPlugin.dll_1" ComponentId="{4C6FD31B-2BFE-4C1F-BF54-F1164CE76D42}" Directory_="OperationPlugin_1_Dir" Attributes="0" KeyPath="SetAutomaticDelayedStartPlugin.dll_1"/>
    <ROW Component="epf" ComponentId="{769443BE-1809-4B77-9E0D-112DEAC1CAB7}" Directory_="CProcs_Dir" Attributes="0" KeyPath="epf" Type="0"/>
    <ROW Component="wget.exe" ComponentId="{3DB44109-0E98-4990-99C6-EE2F913D5143}" Directory_="HelpFiles_Dir" Attributes="0" KeyPath="wget.exe"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.MsiFeatsComponent">
    <ROW Feature="Client" Title="Client" Description="Описание" Display="3" Level="1" Directory_="APPDIR" Attributes="0"/>
    <ROW Feature="Common" Title="Common" Description="Описание" Display="7" Level="1" Directory_="APPDIR" Attributes="0"/>
    <ROW Feature="MainFeature" Title="MainFeature" Description="Description" Display="1" Level="1" Directory_="APPDIR" Attributes="0" Components="AI_ExePath BackupBaseSqlPlugin.dll BackupBaseSqlPlugin.dll_1 CacheClear1CPlugin.dll CacheClear1CPlugin.dll_2 CheckFileExistsPlugin.dll CheckFileExistsPlugin.dll_1 Communications.dll Communications.dll_1 Communications.dll_2 CouchDBDeployerPlugin.dll CouchDBDeployerPlugin.dll_1 CouchDbExecuteCommandPlugin.dll CouchDbExecuteCommandPlugin.dll_1 CouchDbInitIndexPlugin.dll CouchDbInitIndexPlugin.dll_1 DotNetZip.dll DotNetZip.dll_1 DotNetZip.dll_2 DownloadAnyFilesPlugin.dll DownloadAnyFilesPlugin.dll_1 DynamicUpdate1CPlugin.dll DynamicUpdate1CPlugin.dll_2 EntityFramework.SqlServer.dll EntityFramework.dll ExecAnySqlPlugin.dll ExecAnySqlPlugin.dll_1 ExecProcessing1CPlugin.dll ExecProcessing1CPlugin.dll_1 FileBackupBasePlugin.dll FileBackupBasePlugin.dll_2 FileDynamicUpdate1CPlugin.dll FileDynamicUpdate1CPlugin.dll_2 FileUpdate1CPlugin.dll FileUpdate1CPlugin.dll_2 ForceStaticUpdate1CPlugin.dll ForceStaticUpdate1CPlugin.dll_1 KillForceStaticUpdate1CPlugin.dll KillForceStaticUpdate1CPlugin.dll_1 LockBackgroundJobsPlugin.dll LockBackgroundJobsPlugin.dll_2 MagicUpdater MagicUpdater.DL.dll MagicUpdater.InstallLog MagicUpdater.exe MagicUpdaterCommon.dll MagicUpdaterCommon.dll_1 MagicUpdaterCommon.dll_2 MagicUpdaterMonitor.exe MagicUpdaterPluginSources.rar MagicUpdaterRestart.exe MagicUpdaterRestart.exe.config MagicUpdaterSetup.exe NLog.dll NLog.dll_1 NLog.dll_2 Newtonsoft.Json.dll Newtonsoft.Json.dll_1 Newtonsoft.Json.dll_2 OperationExchangeToCenterPlugin.dll OperationExchangeToCenterPlugin.dll_1 ProductInformation RenameAnyFilePlugin.dll RenameAnyFilePlugin.dll_1 RestartComputerPlugin.dll RestartComputerPlugin.dll_2 RestartServer1CPlugin.dll RestartServer1CPlugin.dll_2 SHORTCUTDIR Scs.dll Scs.dll_2 Scs.dll_3 SetAutomaticDelayedStartPlugin.dll SetAutomaticDelayedStartPlugin.dll_1 epf wget.exe"/>
    <ROW Feature="Server" Title="Server" Description="Описание" Display="5" Level="1" Directory_="APPDIR" Attributes="0"/>
    <ATTRIBUTE name="CurrentFeature" value="MainFeature"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.MsiFilesComponent">
    <ROW File="BackupBaseSqlPlugin.dll" Component_="BackupBaseSqlPlugin.dll" FileName="BACKUP~1.DLL|BackupBaseSqlPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\BackupBaseSqlPlugin.dll" SelfReg="false" NextFile="CacheClear1CPlugin.dll"/>
    <ROW File="BackupBaseSqlPlugin.dll_1" Component_="BackupBaseSqlPlugin.dll_1" FileName="BACKUP~1.DLL|BackupBaseSqlPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\BackupBaseSqlPlugin.dll" SelfReg="false" NextFile="CacheClear1CPlugin.dll_2"/>
    <ROW File="CacheClear1CPlugin.dll" Component_="CacheClear1CPlugin.dll" FileName="CACHEC~1.DLL|CacheClear1CPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\CacheClear1CPlugin.dll" SelfReg="false" NextFile="CheckFileExistsPlugin.dll"/>
    <ROW File="CacheClear1CPlugin.dll_2" Component_="CacheClear1CPlugin.dll_2" FileName="CACHEC~1.DLL|CacheClear1CPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\CacheClear1CPlugin.dll" SelfReg="false" NextFile="CheckFileExistsPlugin.dll_1"/>
    <ROW File="CheckFileExistsPlugin.dll" Component_="CheckFileExistsPlugin.dll" FileName="CHECKF~1.DLL|CheckFileExistsPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\CheckFileExistsPlugin.dll" SelfReg="false" NextFile="CouchDBDeployerPlugin.dll"/>
    <ROW File="CheckFileExistsPlugin.dll_1" Component_="CheckFileExistsPlugin.dll_1" FileName="CHECKF~1.DLL|CheckFileExistsPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\CheckFileExistsPlugin.dll" SelfReg="false" NextFile="CouchDBDeployerPlugin.dll_1"/>
    <ROW File="Communications.dll" Component_="Communications.dll" FileName="COMMUN~1.DLL|Communications.dll" Attributes="0" SourcePath="..\..\..\..\..\..\Program Files (x86)\MagicUpdaterMonitor\Communications.dll" SelfReg="false" NextFile="DotNetZip.dll"/>
    <ROW File="Communications.dll_1" Component_="Communications.dll_1" FileName="COMMUN~1.DLL|Communications.dll" Attributes="0" SourcePath="..\..\..\MUReady\Agent\Communications.dll" SelfReg="false" NextFile="DotNetZip.dll_1"/>
    <ROW File="Communications.dll_2" Component_="Communications.dll_2" FileName="COMMUN~1.DLL|Communications.dll" Attributes="0" SourcePath="..\..\..\MUReady\Agent\restart\Communications.dll" SelfReg="false" NextFile="DotNetZip.dll_2"/>
    <ROW File="CouchDBDeployerPlugin.dll" Component_="CouchDBDeployerPlugin.dll" FileName="COUCHD~1.DLL|CouchDBDeployerPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\CouchDBDeployerPlugin.dll" SelfReg="false" NextFile="CouchDbExecuteCommandPlugin.dll"/>
    <ROW File="CouchDBDeployerPlugin.dll_1" Component_="CouchDBDeployerPlugin.dll_1" FileName="COUCHD~1.DLL|CouchDBDeployerPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\CouchDBDeployerPlugin.dll" SelfReg="false" NextFile="CouchDbExecuteCommandPlugin.dll_1"/>
    <ROW File="CouchDbExecuteCommandPlugin.dll" Component_="CouchDbExecuteCommandPlugin.dll" FileName="COUCHD~2.DLL|CouchDbExecuteCommandPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\CouchDbExecuteCommandPlugin.dll" SelfReg="false" NextFile="CouchDbInitIndexPlugin.dll"/>
    <ROW File="CouchDbExecuteCommandPlugin.dll_1" Component_="CouchDbExecuteCommandPlugin.dll_1" FileName="COUCHD~2.DLL|CouchDbExecuteCommandPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\CouchDbExecuteCommandPlugin.dll" SelfReg="false" NextFile="CouchDbInitIndexPlugin.dll_1"/>
    <ROW File="CouchDbInitIndexPlugin.dll" Component_="CouchDbInitIndexPlugin.dll" FileName="COUCHD~3.DLL|CouchDbInitIndexPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\CouchDbInitIndexPlugin.dll" SelfReg="false" NextFile="DownloadAnyFilesPlugin.dll"/>
    <ROW File="CouchDbInitIndexPlugin.dll_1" Component_="CouchDbInitIndexPlugin.dll_1" FileName="COUCHD~3.DLL|CouchDbInitIndexPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\CouchDbInitIndexPlugin.dll" SelfReg="false" NextFile="DownloadAnyFilesPlugin.dll_1"/>
    <ROW File="DotNetZip.dll" Component_="DotNetZip.dll" FileName="DOTNET~1.DLL|DotNetZip.dll" Attributes="0" SourcePath="..\..\..\..\..\..\Program Files (x86)\MagicUpdaterMonitor\DotNetZip.dll" SelfReg="false" NextFile="EntityFramework.dll"/>
    <ROW File="DotNetZip.dll_1" Component_="DotNetZip.dll_1" FileName="DOTNET~1.DLL|DotNetZip.dll" Attributes="0" SourcePath="..\..\..\MUReady\Agent\DotNetZip.dll" SelfReg="false" NextFile="MagicUpdater.exe"/>
    <ROW File="DotNetZip.dll_2" Component_="DotNetZip.dll_2" FileName="DOTNET~1.DLL|DotNetZip.dll" Attributes="0" SourcePath="..\..\..\MUReady\Agent\restart\DotNetZip.dll" SelfReg="false" NextFile="MagicUpdaterCommon.dll_2"/>
    <ROW File="DownloadAnyFilesPlugin.dll" Component_="DownloadAnyFilesPlugin.dll" FileName="DOWNLO~1.DLL|DownloadAnyFilesPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\DownloadAnyFilesPlugin.dll" SelfReg="false" NextFile="DynamicUpdate1CPlugin.dll"/>
    <ROW File="DownloadAnyFilesPlugin.dll_1" Component_="DownloadAnyFilesPlugin.dll_1" FileName="DOWNLO~1.DLL|DownloadAnyFilesPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\DownloadAnyFilesPlugin.dll" SelfReg="false" NextFile="DynamicUpdate1CPlugin.dll_2"/>
    <ROW File="DynamicUpdate1CPlugin.dll" Component_="DynamicUpdate1CPlugin.dll" FileName="DYNAMI~1.DLL|DynamicUpdate1CPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\DynamicUpdate1CPlugin.dll" SelfReg="false" NextFile="ExecAnySqlPlugin.dll"/>
    <ROW File="DynamicUpdate1CPlugin.dll_2" Component_="DynamicUpdate1CPlugin.dll_2" FileName="DYNAMI~1.DLL|DynamicUpdate1CPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\DynamicUpdate1CPlugin.dll" SelfReg="false" NextFile="ExecAnySqlPlugin.dll_1"/>
    <ROW File="EntityFramework.SqlServer.dll" Component_="EntityFramework.SqlServer.dll" FileName="ENTITY~2.DLL|EntityFramework.SqlServer.dll" Attributes="0" SourcePath="..\..\..\..\..\..\Program Files (x86)\MagicUpdaterMonitor\EntityFramework.SqlServer.dll" SelfReg="false" NextFile="MagicUpdater.DL.dll"/>
    <ROW File="EntityFramework.dll" Component_="EntityFramework.dll" FileName="ENTITY~1.DLL|EntityFramework.dll" Attributes="0" SourcePath="..\..\..\..\..\..\Program Files (x86)\MagicUpdaterMonitor\EntityFramework.dll" SelfReg="false" NextFile="EntityFramework.SqlServer.dll"/>
    <ROW File="ExecAnySqlPlugin.dll" Component_="ExecAnySqlPlugin.dll" FileName="EXECAN~1.DLL|ExecAnySqlPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\ExecAnySqlPlugin.dll" SelfReg="false" NextFile="ExecProcessing1CPlugin.dll"/>
    <ROW File="ExecAnySqlPlugin.dll_1" Component_="ExecAnySqlPlugin.dll_1" FileName="EXECAN~1.DLL|ExecAnySqlPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\ExecAnySqlPlugin.dll" SelfReg="false" NextFile="ExecProcessing1CPlugin.dll_1"/>
    <ROW File="ExecProcessing1CPlugin.dll" Component_="ExecProcessing1CPlugin.dll" FileName="EXECPR~1.DLL|ExecProcessing1CPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\ExecProcessing1CPlugin.dll" SelfReg="false" NextFile="FileBackupBasePlugin.dll"/>
    <ROW File="ExecProcessing1CPlugin.dll_1" Component_="ExecProcessing1CPlugin.dll_1" FileName="EXECPR~1.DLL|ExecProcessing1CPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\ExecProcessing1CPlugin.dll" SelfReg="false" NextFile="FileBackupBasePlugin.dll_2"/>
    <ROW File="FileBackupBasePlugin.dll" Component_="FileBackupBasePlugin.dll" FileName="FILEBA~1.DLL|FileBackupBasePlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\FileBackupBasePlugin.dll" SelfReg="false" NextFile="FileDynamicUpdate1CPlugin.dll"/>
    <ROW File="FileBackupBasePlugin.dll_2" Component_="FileBackupBasePlugin.dll_2" FileName="FILEBA~1.DLL|FileBackupBasePlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\FileBackupBasePlugin.dll" SelfReg="false" NextFile="FileDynamicUpdate1CPlugin.dll_2"/>
    <ROW File="FileDynamicUpdate1CPlugin.dll" Component_="FileDynamicUpdate1CPlugin.dll" FileName="FILEDY~1.DLL|FileDynamicUpdate1CPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\FileDynamicUpdate1CPlugin.dll" SelfReg="false" NextFile="FileUpdate1CPlugin.dll"/>
    <ROW File="FileDynamicUpdate1CPlugin.dll_2" Component_="FileDynamicUpdate1CPlugin.dll_2" FileName="FILEDY~1.DLL|FileDynamicUpdate1CPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\FileDynamicUpdate1CPlugin.dll" SelfReg="false" NextFile="FileUpdate1CPlugin.dll_2"/>
    <ROW File="FileUpdate1CPlugin.dll" Component_="FileUpdate1CPlugin.dll" FileName="FILEUP~1.DLL|FileUpdate1CPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\FileUpdate1CPlugin.dll" SelfReg="false" NextFile="ForceStaticUpdate1CPlugin.dll"/>
    <ROW File="FileUpdate1CPlugin.dll_2" Component_="FileUpdate1CPlugin.dll_2" FileName="FILEUP~1.DLL|FileUpdate1CPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\FileUpdate1CPlugin.dll" SelfReg="false" NextFile="ForceStaticUpdate1CPlugin.dll_1"/>
    <ROW File="ForceStaticUpdate1CPlugin.dll" Component_="ForceStaticUpdate1CPlugin.dll" FileName="FORCES~1.DLL|ForceStaticUpdate1CPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\ForceStaticUpdate1CPlugin.dll" SelfReg="false" NextFile="KillForceStaticUpdate1CPlugin.dll"/>
    <ROW File="ForceStaticUpdate1CPlugin.dll_1" Component_="ForceStaticUpdate1CPlugin.dll_1" FileName="FORCES~1.DLL|ForceStaticUpdate1CPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\ForceStaticUpdate1CPlugin.dll" SelfReg="false" NextFile="KillForceStaticUpdate1CPlugin.dll_1"/>
    <ROW File="KillForceStaticUpdate1CPlugin.dll" Component_="KillForceStaticUpdate1CPlugin.dll" FileName="KILLFO~1.DLL|KillForceStaticUpdate1CPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\KillForceStaticUpdate1CPlugin.dll" SelfReg="false" NextFile="LockBackgroundJobsPlugin.dll"/>
    <ROW File="KillForceStaticUpdate1CPlugin.dll_1" Component_="KillForceStaticUpdate1CPlugin.dll_1" FileName="KILLFO~1.DLL|KillForceStaticUpdate1CPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\KillForceStaticUpdate1CPlugin.dll" SelfReg="false" NextFile="LockBackgroundJobsPlugin.dll_2"/>
    <ROW File="LockBackgroundJobsPlugin.dll" Component_="LockBackgroundJobsPlugin.dll" FileName="LOCKBA~1.DLL|LockBackgroundJobsPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\LockBackgroundJobsPlugin.dll" SelfReg="false" NextFile="OperationExchangeToCenterPlugin.dll"/>
    <ROW File="LockBackgroundJobsPlugin.dll_2" Component_="LockBackgroundJobsPlugin.dll_2" FileName="LOCKBA~1.DLL|LockBackgroundJobsPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\LockBackgroundJobsPlugin.dll" SelfReg="false" NextFile="OperationExchangeToCenterPlugin.dll_1"/>
    <ROW File="MagicUpdater.DL.dll" Component_="MagicUpdater.DL.dll" FileName="MAGICU~1.DLL|MagicUpdater.DL.dll" Attributes="0" SourcePath="..\..\..\..\..\..\Program Files (x86)\MagicUpdaterMonitor\MagicUpdater.DL.dll" SelfReg="false" NextFile="MagicUpdaterCommon.dll"/>
    <ROW File="MagicUpdater.InstallLog" Component_="MagicUpdater.InstallLog" FileName="MAGICU~1.INS|MagicUpdater.InstallLog" Attributes="0" SourcePath="..\..\..\MUReady\Agent\MagicUpdater.InstallLog" SelfReg="false" NextFile="MagicUpdater.InstallState"/>
    <ROW File="MagicUpdater.InstallState" Component_="MagicUpdater.InstallLog" FileName="MAGICU~2.INS|MagicUpdater.InstallState" Attributes="0" SourcePath="..\..\..\MUReady\Agent\MagicUpdater.InstallState" SelfReg="false" NextFile="MagicUpdaterCommon.dll_1"/>
    <ROW File="MagicUpdater.exe" Component_="MagicUpdater.exe" FileName="MAGICU~1.EXE|MagicUpdater.exe" Attributes="0" SourcePath="..\..\..\MUReady\Agent\MagicUpdater.exe" SelfReg="false" NextFile="MagicUpdater.InstallLog" DigSign="true"/>
    <ROW File="MagicUpdaterCommon.dll" Component_="MagicUpdaterCommon.dll" FileName="MAGICU~2.DLL|MagicUpdaterCommon.dll" Attributes="0" SourcePath="..\..\..\..\..\..\Program Files (x86)\MagicUpdaterMonitor\MagicUpdaterCommon.dll" SelfReg="false" NextFile="MagicUpdaterMonitor.exe"/>
    <ROW File="MagicUpdaterCommon.dll_1" Component_="MagicUpdaterCommon.dll_1" FileName="MAGICU~1.DLL|MagicUpdaterCommon.dll" Attributes="0" SourcePath="..\..\..\MUReady\Agent\MagicUpdaterCommon.dll" SelfReg="false" NextFile="Newtonsoft.Json.dll_1"/>
    <ROW File="MagicUpdaterCommon.dll_2" Component_="MagicUpdaterCommon.dll_2" FileName="MAGICU~1.DLL|MagicUpdaterCommon.dll" Attributes="0" SourcePath="..\..\..\MUReady\Agent\restart\MagicUpdaterCommon.dll" SelfReg="false" NextFile="MagicUpdaterRestart.exe"/>
    <ROW File="MagicUpdaterMonitor.exe" Component_="MagicUpdaterMonitor.exe" FileName="MAGICU~1.EXE|MagicUpdaterMonitor.exe" Attributes="0" SourcePath="..\..\..\..\..\..\Program Files (x86)\MagicUpdaterMonitor\MagicUpdaterMonitor.exe" SelfReg="false" NextFile="Newtonsoft.Json.dll" DigSign="true"/>
    <ROW File="MagicUpdaterPluginSources.rar" Component_="MagicUpdaterPluginSources.rar" FileName="MAGICU~1.RAR|MagicUpdaterPluginSources.rar" Attributes="0" SourcePath="..\..\..\..\..\..\Program Files (x86)\MagicUpdaterMonitor\OperationPlugin\Sources\MagicUpdaterPluginSources.rar" SelfReg="false" NextFile="BackupBaseSqlPlugin.dll"/>
    <ROW File="MagicUpdaterRestart.exe" Component_="MagicUpdaterRestart.exe" FileName="MAGICU~1.EXE|MagicUpdaterRestart.exe" Attributes="0" SourcePath="..\..\..\MUReady\Agent\restart\MagicUpdaterRestart.exe" SelfReg="false" NextFile="Newtonsoft.Json.dll_2" DigSign="true"/>
    <ROW File="MagicUpdaterRestart.exe.config" Component_="MagicUpdaterRestart.exe.config" FileName="MAGICU~1.CON|MagicUpdaterRestart.exe.config" Attributes="0" SourcePath="..\..\..\MUReady\Agent\restart\MagicUpdaterRestart.exe.config" SelfReg="false" NextFile="NLog.config_1"/>
    <ROW File="MagicUpdaterSetup.exe" Component_="MagicUpdaterSetup.exe" FileName="MAGICU~1.EXE|MagicUpdaterSetup.exe" Attributes="0" SourcePath="..\..\..\MUReady\AgentInstaller\MagicUpdaterSetup.exe" SelfReg="false" DigSign="true"/>
    <ROW File="NLog.config" Component_="MagicUpdater.InstallLog" FileName="NLOG~1.CON|NLog.config" Attributes="0" SourcePath="..\..\..\MUReady\Agent\NLog.config" SelfReg="false" NextFile="Communications.dll_2"/>
    <ROW File="NLog.config_1" Component_="MagicUpdaterRestart.exe.config" FileName="NLOG~1.CON|NLog.config" Attributes="0" SourcePath="..\..\..\MUReady\Agent\restart\NLog.config" SelfReg="false" NextFile="MagicUpdaterSetup.exe"/>
    <ROW File="NLog.dll" Component_="NLog.dll" FileName="NLog.dll" Attributes="0" SourcePath="..\..\..\..\..\..\Program Files (x86)\MagicUpdaterMonitor\NLog.dll" SelfReg="false" NextFile="Scs.dll"/>
    <ROW File="NLog.dll_1" Component_="NLog.dll_1" FileName="NLog.dll" Attributes="0" SourcePath="..\..\..\MUReady\Agent\NLog.dll" SelfReg="false" NextFile="Scs.dll_2"/>
    <ROW File="NLog.dll_2" Component_="NLog.dll_2" FileName="NLog.dll" Attributes="0" SourcePath="..\..\..\MUReady\Agent\restart\NLog.dll" SelfReg="false" NextFile="Scs.dll_3"/>
    <ROW File="Newtonsoft.Json.dll" Component_="Newtonsoft.Json.dll" FileName="NEWTON~1.DLL|Newtonsoft.Json.dll" Attributes="0" SourcePath="..\..\..\..\..\..\Program Files (x86)\MagicUpdaterMonitor\Newtonsoft.Json.dll" SelfReg="false" NextFile="NLog.dll"/>
    <ROW File="Newtonsoft.Json.dll_1" Component_="Newtonsoft.Json.dll_1" FileName="NEWTON~1.DLL|Newtonsoft.Json.dll" Attributes="0" SourcePath="..\..\..\MUReady\Agent\Newtonsoft.Json.dll" SelfReg="false" NextFile="NLog.dll_1"/>
    <ROW File="Newtonsoft.Json.dll_2" Component_="Newtonsoft.Json.dll_2" FileName="NEWTON~1.DLL|Newtonsoft.Json.dll" Attributes="0" SourcePath="..\..\..\MUReady\Agent\restart\Newtonsoft.Json.dll" SelfReg="false" NextFile="NLog.dll_2"/>
    <ROW File="OperationExchangeToCenterPlugin.dll" Component_="OperationExchangeToCenterPlugin.dll" FileName="OPERAT~1.DLL|OperationExchangeToCenterPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\OperationExchangeToCenterPlugin.dll" SelfReg="false" NextFile="RenameAnyFilePlugin.dll"/>
    <ROW File="OperationExchangeToCenterPlugin.dll_1" Component_="OperationExchangeToCenterPlugin.dll_1" FileName="OPERAT~1.DLL|OperationExchangeToCenterPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\OperationExchangeToCenterPlugin.dll" SelfReg="false" NextFile="RenameAnyFilePlugin.dll_1"/>
    <ROW File="RenameAnyFilePlugin.dll" Component_="RenameAnyFilePlugin.dll" FileName="RENAME~1.DLL|RenameAnyFilePlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\RenameAnyFilePlugin.dll" SelfReg="false" NextFile="RestartComputerPlugin.dll"/>
    <ROW File="RenameAnyFilePlugin.dll_1" Component_="RenameAnyFilePlugin.dll_1" FileName="RENAME~1.DLL|RenameAnyFilePlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\RenameAnyFilePlugin.dll" SelfReg="false" NextFile="RestartComputerPlugin.dll_2"/>
    <ROW File="RestartComputerPlugin.dll" Component_="RestartComputerPlugin.dll" FileName="RESTAR~1.DLL|RestartComputerPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\RestartComputerPlugin.dll" SelfReg="false" NextFile="RestartServer1CPlugin.dll"/>
    <ROW File="RestartComputerPlugin.dll_2" Component_="RestartComputerPlugin.dll_2" FileName="RESTAR~1.DLL|RestartComputerPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\RestartComputerPlugin.dll" SelfReg="false" NextFile="RestartServer1CPlugin.dll_2"/>
    <ROW File="RestartServer1CPlugin.dll" Component_="RestartServer1CPlugin.dll" FileName="RESTAR~2.DLL|RestartServer1CPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\RestartServer1CPlugin.dll" SelfReg="false" NextFile="SetAutomaticDelayedStartPlugin.dll"/>
    <ROW File="RestartServer1CPlugin.dll_2" Component_="RestartServer1CPlugin.dll_2" FileName="RESTAR~2.DLL|RestartServer1CPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\RestartServer1CPlugin.dll" SelfReg="false" NextFile="SetAutomaticDelayedStartPlugin.dll_1"/>
    <ROW File="Scs.dll" Component_="Scs.dll" FileName="Scs.dll" Attributes="0" SourcePath="..\..\..\..\..\..\Program Files (x86)\MagicUpdaterMonitor\Scs.dll" SelfReg="false" NextFile="epf"/>
    <ROW File="Scs.dll_2" Component_="Scs.dll_2" FileName="Scs.dll" Attributes="0" SourcePath="..\..\..\MUReady\Agent\Scs.dll" SelfReg="false" NextFile="NLog.config"/>
    <ROW File="Scs.dll_3" Component_="Scs.dll_3" FileName="Scs.dll" Attributes="0" SourcePath="..\..\..\MUReady\Agent\restart\Scs.dll" SelfReg="false" NextFile="MagicUpdaterRestart.exe.config"/>
    <ROW File="SetAutomaticDelayedStartPlugin.dll" Component_="SetAutomaticDelayedStartPlugin.dll" FileName="SETAUT~1.DLL|SetAutomaticDelayedStartPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\SetAutomaticDelayedStartPlugin.dll" SelfReg="false" NextFile="BackupBaseSqlPlugin.dll_1"/>
    <ROW File="SetAutomaticDelayedStartPlugin.dll_1" Component_="SetAutomaticDelayedStartPlugin.dll_1" FileName="SETAUT~1.DLL|SetAutomaticDelayedStartPlugin.dll" Attributes="0" SourcePath="\\sela.ru\data\RUS\MSK_Office\==FTP==\cis_obmen\MagicUpdater\OperationPlugin\SetAutomaticDelayedStartPlugin.dll" SelfReg="false" NextFile="Communications.dll_1"/>
    <ROW File="epf" Component_="epf" FileName="РОЗНИЦ~1.EPF|Розница22.epf" Attributes="0" SourcePath="..\..\..\..\..\..\Program Files (x86)\MagicUpdaterMonitor\1CProcs\Розница22.epf" SelfReg="false" NextFile="epf_2"/>
    <ROW File="epf_1" Component_="epf" FileName="Розница1.epf" Attributes="0" SourcePath="..\..\..\..\..\..\Program Files (x86)\MagicUpdaterMonitor\1CProcs\Розница1.epf" SelfReg="false" NextFile="MagicUpdaterPluginSources.rar"/>
    <ROW File="epf_2" Component_="epf" FileName="УТ103.epf" Attributes="0" SourcePath="..\..\..\..\..\..\Program Files (x86)\MagicUpdaterMonitor\1CProcs\УТ103.epf" SelfReg="false" NextFile="epf_3"/>
    <ROW File="epf_3" Component_="epf" FileName="УТ11.epf" Attributes="0" SourcePath="..\..\..\..\..\..\Program Files (x86)\MagicUpdaterMonitor\1CProcs\УТ11.epf" SelfReg="false" NextFile="wget.exe"/>
    <ROW File="wget.exe" Component_="wget.exe" FileName="wget.exe" Attributes="0" SourcePath="..\..\..\..\..\..\Program Files (x86)\MagicUpdaterMonitor\BinariesToFTP\HelpFiles\wget.exe" SelfReg="false" NextFile="epf_1" DigSign="true"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.AiRemoveFileComponent">
    <ROW RemoveFile="_" Condition="(AI_CLEAN_RESOURCES_UNINSTALL = &quot;1&quot;) AND (NOT UPGRADINGPRODUCTCODE)" Options="3"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.BuildComponent">
    <ROW BuildKey="DefaultBuild" BuildName="DefaultBuild" BuildOrder="1" BuildType="1" Languages="ru" InstallationType="4" CabsLocation="1" PackageType="1" FilesInsideExe="true" ExeIconPath="..\..\..\..\..\..\Program Files (x86)\MagicUpdaterMonitor\MagicUpdaterMonitor.exe" ExtractionFolder="[AppDataFolder][|Manufacturer]\[|ProductName] [|ProductVersion]\install" ExtUI="true" UseLargeSchema="true" ExeName="SetupMU" UACExecutionLevel="2"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.DictionaryComponent">
    <ROW Path="&lt;AI_DICTS&gt;ui.ail"/>
    <ROW Path="&lt;AI_DICTS&gt;ui_ru.ail"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.FragmentComponent">
    <ROW Fragment="ClientServerDlg.aip" Path="&lt;AI_THEMES&gt;classic\fragments\ClientServerDlg.aip"/>
    <ROW Fragment="CommonUI.aip" Path="&lt;AI_FRAGS&gt;CommonUI.aip"/>
    <ROW Fragment="FolderDlg.aip" Path="&lt;AI_THEMES&gt;classic\fragments\FolderDlg.aip"/>
    <ROW Fragment="MaintenanceTypeDlg.aip" Path="&lt;AI_THEMES&gt;classic\fragments\MaintenanceTypeDlg.aip"/>
    <ROW Fragment="MaintenanceWelcomeDlg.aip" Path="&lt;AI_THEMES&gt;classic\fragments\MaintenanceWelcomeDlg.aip"/>
    <ROW Fragment="PreparePrereqDlg.aip" Path="&lt;AI_THEMES&gt;classic\fragments\PreparePrereqDlg.aip"/>
    <ROW Fragment="PrerequisitesDlg.aip" Path="&lt;AI_THEMES&gt;classic\fragments\PrerequisitesDlg.aip"/>
    <ROW Fragment="ProgressPrereqDlg.aip" Path="&lt;AI_THEMES&gt;classic\fragments\ProgressPrereqDlg.aip"/>
    <ROW Fragment="SQLServerConnectionDlg.aip" Path="&lt;AI_THEMES&gt;classic\fragments\SQLServerConnectionDlg.aip"/>
    <ROW Fragment="SequenceDialogs.aip" Path="&lt;AI_THEMES&gt;classic\fragments\SequenceDialogs.aip"/>
    <ROW Fragment="Sequences.aip" Path="&lt;AI_FRAGS&gt;Sequences.aip"/>
    <ROW Fragment="StaticUIStrings.aip" Path="&lt;AI_FRAGS&gt;StaticUIStrings.aip"/>
    <ROW Fragment="UI.aip" Path="&lt;AI_THEMES&gt;classic\fragments\UI.aip"/>
    <ROW Fragment="Validation.aip" Path="&lt;AI_FRAGS&gt;Validation.aip"/>
    <ROW Fragment="VerifyRemoveDlg.aip" Path="&lt;AI_THEMES&gt;classic\fragments\VerifyRemoveDlg.aip"/>
    <ROW Fragment="VerifyRepairDlg.aip" Path="&lt;AI_THEMES&gt;classic\fragments\VerifyRepairDlg.aip"/>
    <ROW Fragment="WelcomeDlg.aip" Path="&lt;AI_THEMES&gt;classic\fragments\WelcomeDlg.aip"/>
    <ROW Fragment="WelcomePrereqDlg.aip" Path="&lt;AI_THEMES&gt;classic\fragments\WelcomePrereqDlg.aip"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.MsiActionTextComponent">
    <ROW Action="AI_AiRemoveFilesCommit" Description="Выполнение операции удаления файлов." Template="Удаление файла: [1]" DescriptionLocId="ActionText.Description.AI_AiRemoveFilesCommit" TemplateLocId="ActionText.Template.AI_AiRemoveFilesCommit"/>
    <ROW Action="AI_AiRemoveFilesDeferred_Permanent" Description="Подготовка файлов для удаления" Template="Подготовка файла: [1]" DescriptionLocId="ActionText.Description.AI_AiRemoveFilesDeferred_Permanent" TemplateLocId="ActionText.Template.AI_AiRemoveFilesDeferred_Permanent"/>
    <ROW Action="AI_AiRemoveFilesDeferred_Undoable" Description="Подготовка файлов для удаления" Template="Подготовка файла: [1]" DescriptionLocId="ActionText.Description.AI_AiRemoveFilesDeferred_Undoable" TemplateLocId="ActionText.Template.AI_AiRemoveFilesDeferred_Undoable"/>
    <ROW Action="AI_AiRemoveFilesImmediate" Description="Подготовка файлов для удаления" Template="Подготовка файла: [1]" DescriptionLocId="ActionText.Description.AI_AiRemoveFilesImmediate" TemplateLocId="ActionText.Template.AI_AiRemoveFilesImmediate"/>
    <ROW Action="AI_AiRemoveFilesRollback" Description="Восстановление удаленных файлов" Template="Восстановление файла: [1]" DescriptionLocId="ActionText.Description.AI_AiRemoveFilesRollback" TemplateLocId="ActionText.Template.AI_AiRemoveFilesRollback"/>
    <ROW Action="AI_DeleteLzma" Description="Удаление извлеченных файлов из архива" DescriptionLocId="ActionText.Description.AI_DeleteLzma" TemplateLocId="-"/>
    <ROW Action="AI_DeleteRLzma" Description="Удаление извлеченных файлов из архива" DescriptionLocId="ActionText.Description.AI_DeleteLzma" TemplateLocId="-"/>
    <ROW Action="AI_ExtractFiles" Description="Извлечение файлов из архива" DescriptionLocId="ActionText.Description.AI_ExtractLzma" TemplateLocId="-"/>
    <ROW Action="AI_ExtractLzma" Description="Извлечение файлов из архива" DescriptionLocId="ActionText.Description.AI_ExtractLzma" TemplateLocId="-"/>
    <ROW Action="AI_SqlConfig" Description="Выполнение установки SQL-сценария" Template="Подключение: [1]  Сценарий: [2]" DescriptionLocId="ActionText.Description.AI_SqlConfig" TemplateLocId="ActionText.Template.AI_SqlConfig"/>
    <ROW Action="AI_SqlInstall" Description="Создание действий для настройки базы данных для установки выполнения сценария SQL" DescriptionLocId="ActionText.Description.AI_SqlInstall"/>
    <ROW Action="AI_SqlMaint" Description="Выполнение обслуживания SQL-сценариев" Template="Подключение: [1]  Сценарий: [2]" DescriptionLocId="ActionText.Description.AI_SqlMaint" TemplateLocId="ActionText.Template.AI_SqlMaint"/>
    <ROW Action="AI_SqlRemove" Description="Выполнение удаления SQL-сценариев" Template="Подключение: [1]  Сценарий: [2]" DescriptionLocId="ActionText.Description.AI_SqlRemove" TemplateLocId="ActionText.Template.AI_SqlRemove"/>
    <ROW Action="AI_SqlRollback" Description="Выполнение отката SQL-сценариев" Template="Подключение: [1]  Сценарий: [2]" DescriptionLocId="ActionText.Description.AI_SqlRollback" TemplateLocId="ActionText.Template.AI_SqlRollback"/>
    <ROW Action="AI_SqlUninstall" Description="Создание действий для настройки базы данных для удаления выполнения SQL-сценария" DescriptionLocId="ActionText.Description.AI_SqlUninstall"/>
    <ROW Action="AI_XmlCommit" Description="Фиксация XML-файла конфигурации." Template="Фиксация XML-файла конфигурации." DescriptionLocId="ActionText.Description.AI_XmlCommit" TemplateLocId="ActionText.Template.AI_XmlCommit"/>
    <ROW Action="AI_XmlConfig" Description="Выполнение файла конфигурации XML" Template="Настройка XML-файла: &quot;[1]&quot;" DescriptionLocId="ActionText.Description.AI_XmlConfig" TemplateLocId="ActionText.Template.AI_XmlConfig"/>
    <ROW Action="AI_XmlInstall" Description="Создание действий для настройки XML-файлов" DescriptionLocId="ActionText.Description.AI_XmlInstall"/>
    <ROW Action="AI_XmlRemove" Description="Выполнение файла конфигурации XML" Template="Настройка XML-файла: &quot;[1]&quot;" DescriptionLocId="ActionText.Description.AI_XmlRemove" TemplateLocId="ActionText.Template.AI_XmlRemove"/>
    <ROW Action="AI_XmlRollback" Description="Откат файлов конфигурации XML." Template="Откат файлов конфигурации XML." DescriptionLocId="ActionText.Description.AI_XmlRollback" TemplateLocId="ActionText.Template.AI_XmlRollback"/>
    <ROW Action="AI_XmlUninstall" Description="Создание действий для настройки XML-файлов" DescriptionLocId="ActionText.Description.AI_XmlUninstall"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.MsiAppSearchComponent">
    <ROW Property="AI_SETUPEXEPATH" Signature_="AI_EXE_PATH_CU" Builds="DefaultBuild"/>
    <ROW Property="AI_SETUPEXEPATH" Signature_="AI_EXE_PATH_LM" Builds="DefaultBuild"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.MsiBinaryComponent">
    <ROW Name="CheckFTPAction.CA.dll" SourcePath="CustomActions\CheckFTPAction.CA.dll"/>
    <ROW Name="CopyToFTPAction.CA.dll" SourcePath="CustomActions\CopyToFTPAction.CA.dll"/>
    <ROW Name="CreateSettingsFile.CA.dll" SourcePath="CustomActions\CreateSettingsFile.CA.dll"/>
    <ROW Name="Lunch1CProc.CA.dll" SourcePath="CustomActions\Lunch1CProc.CA.dll"/>
    <ROW Name="Prereq.dll" SourcePath="&lt;AI_CUSTACTS&gt;Prereq.dll"/>
    <ROW Name="ResourceCleaner.dll" SourcePath="&lt;AI_CUSTACTS&gt;ResourceCleaner.dll"/>
    <ROW Name="aicustact.dll" SourcePath="&lt;AI_CUSTACTS&gt;aicustact.dll"/>
    <ROW Name="lzmaextractor.dll" SourcePath="&lt;AI_CUSTACTS&gt;lzmaextractor.dll"/>
    <ROW Name="sql.dll" SourcePath="&lt;AI_CUSTACTS&gt;sql.dll"/>
    <ROW Name="xmlCfg.dll" SourcePath="&lt;AI_CUSTACTS&gt;xmlCfg.dll"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.MsiCheckBoxComponent">
    <ROW Property="SQL_TRUSTED_CONNECTION" Value="0" MsiKey="SQL_TRUSTED_CONNECTION"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.MsiComboBoxComponent">
    <ROW Property="CONFIG1C_PROP" Order="1" Value="1С:Розница 2.2" Text="1С:Розница 2.2"/>
    <ROW Property="CONFIG1C_PROP" Order="2" Value="1С:Управление торговлей 11" Text="1С:Управление торговлей 11"/>
    <ROW Property="CONFIG1C_PROP" Order="3" Value="1С:Управление торговлей 10.3" Text="1С:Управление торговлей 10.3"/>
    <ROW Property="CONFIG1C_PROP" Order="4" Value="1С:Розница 1.0" Text="1С:Розница 1.0"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.MsiControlComponent">
    <ROW Dialog_="AdminBrowseDlg" Control="OK" Type="PushButton" X="304" Y="243" Width="56" Height="17" Attributes="3" Text="[ButtonText_OK]" Order="300" TextLocId="-" MsiKey="AdminBrowseDlg#OK"/>
    <ROW Dialog_="AdminBrowseDlg" Control="Cancel" Type="PushButton" X="240" Y="243" Width="56" Height="17" Attributes="3" Text="[ButtonText_Cancel]" Order="400" TextLocId="-" MsiKey="AdminBrowseDlg#Cancel"/>
    <ROW Dialog_="AdminBrowseDlg" Control="ComboLabel" Type="Text" X="25" Y="58" Width="60" Height="10" Attributes="3" Text="&amp;Поиск в:" Order="500" TextLocId="Control.Text.AdminBrowseDlg#ComboLabel" MsiKey="AdminBrowseDlg#ComboLabel"/>
    <ROW Dialog_="AdminBrowseDlg" Control="DirectoryCombo" Type="DirectoryCombo" X="86" Y="55" Width="204" Height="80" Attributes="458755" Property="TARGETDIR" Order="600" MsiKey="AdminBrowseDlg#DirectoryCombo"/>
    <ROW Dialog_="AdminBrowseDlg" Control="Up" Type="PushButton" X="298" Y="55" Width="19" Height="19" Attributes="3670019" Text="[UpDirIcon]" Help="Переход на один уровень вверх|" Order="700" HelpLocId="Control.Help.AdminBrowseDlg#Up" MsiKey="AdminBrowseDlg#Up"/>
    <ROW Dialog_="AdminBrowseDlg" Control="NewFolder" Type="PushButton" X="325" Y="55" Width="19" Height="19" Attributes="3670019" Text="[NewDirIcon]" Help="Создать новую папку|" Order="800" HelpLocId="Control.Help.AdminBrowseDlg#NewFolder" MsiKey="AdminBrowseDlg#NewFolder"/>
    <ROW Dialog_="AdminBrowseDlg" Control="DirectoryList" Type="DirectoryList" X="25" Y="83" Width="320" Height="110" Attributes="7" Property="TARGETDIR" Order="900" MsiKey="AdminBrowseDlg#DirectoryList"/>
    <ROW Dialog_="AdminBrowseDlg" Control="PathLabel" Type="Text" X="25" Y="205" Width="75" Height="10" Attributes="3" Text="&amp;Имя папки:" Order="1000" TextLocId="Control.Text.AdminBrowseDlg#PathLabel" MsiKey="AdminBrowseDlg#PathLabel"/>
    <ROW Dialog_="AdminBrowseDlg" Control="BannerBitmap" Type="Bitmap" X="0" Y="0" Width="370" Height="44" Attributes="1048577" Text="[BannerBitmap]" Order="1100" MsiKey="AdminBrowseDlg#BannerBitmap"/>
    <ROW Dialog_="AdminBrowseDlg" Control="Title" Type="Text" X="15" Y="6" Width="200" Height="15" Attributes="65539" Text="Изменение папки назначения" TextStyle="[DlgTitleFont]" Order="1200" TextLocId="Control.Text.AdminBrowseDlg#Title" MsiKey="AdminBrowseDlg#Title"/>
    <ROW Dialog_="AdminBrowseDlg" Control="Description" Type="Text" X="25" Y="23" Width="280" Height="20" Attributes="196611" Text="Указание папки назначения" Order="1300" TextLocId="Control.Text.AdminBrowseDlg#Description" MsiKey="AdminBrowseDlg#Description"/>
    <ROW Dialog_="AdminBrowseDlg" Control="BannerLine" Type="Line" X="0" Y="44" Width="372" Height="0" Attributes="1" Order="1400" MsiKey="AdminBrowseDlg#BannerLine"/>
    <ROW Dialog_="AdminInstallPointDlg" Control="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Attributes="3" Text="[ButtonText_Back]" Order="500" TextLocId="-" MsiKey="AdminInstallPointDlg#Back" Options="1"/>
    <ROW Dialog_="AdminInstallPointDlg" Control="Next" Type="PushButton" X="236" Y="243" Width="56" Height="17" Attributes="3" Text="[ButtonText_Next]" Order="600" TextLocId="-" MsiKey="AdminInstallPointDlg#Next" Options="1"/>
    <ROW Dialog_="AdminInstallPointDlg" Control="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Attributes="3" Text="[ButtonText_Cancel]" Order="700" TextLocId="-" MsiKey="AdminInstallPointDlg#Cancel" Options="1"/>
    <ROW Dialog_="AdminInstallPointDlg" Control="BannerBitmap" Type="Bitmap" X="0" Y="0" Width="370" Height="44" Attributes="1048577" Text="[BannerBitmap]" Order="800" MsiKey="AdminInstallPointDlg#BannerBitmap"/>
    <ROW Dialog_="AdminInstallPointDlg" Control="Title" Type="Text" X="15" Y="6" Width="200" Height="15" Attributes="196611" Text="Сетевой путь" TextStyle="[DlgTitleFont]" Order="900" TextLocId="Control.Text.AdminInstallPointDlg#Title" MsiKey="AdminInstallPointDlg#Title"/>
    <ROW Dialog_="AdminInstallPointDlg" Control="Description" Type="Text" X="25" Y="20" Width="280" Height="20" Attributes="196611" Text="Укажите сетевой путь для сервера приложения [ProductName]" Order="1000" TextLocId="Control.Text.AdminInstallPointDlg#Description" MsiKey="AdminInstallPointDlg#Description"/>
    <ROW Dialog_="AdminInstallPointDlg" Control="BannerLine" Type="Line" X="0" Y="44" Width="372" Height="0" Attributes="1" Order="1100" MsiKey="AdminInstallPointDlg#BannerLine"/>
    <ROW Dialog_="BrowseDlg" Control="OK" Type="PushButton" X="304" Y="243" Width="56" Height="17" Attributes="3" Text="[ButtonText_OK]" Order="300" TextLocId="-" MsiKey="BrowseDlg#OK"/>
    <ROW Dialog_="BrowseDlg" Control="Cancel" Type="PushButton" X="240" Y="243" Width="56" Height="17" Attributes="3" Text="[ButtonText_Cancel]" Order="400" TextLocId="-" MsiKey="BrowseDlg#Cancel"/>
    <ROW Dialog_="BrowseDlg" Control="ComboLabel" Type="Text" X="25" Y="58" Width="60" Height="10" Attributes="3" Text="&amp;Поиск в:" Order="500" TextLocId="Control.Text.BrowseDlg#ComboLabel" MsiKey="BrowseDlg#ComboLabel"/>
    <ROW Dialog_="BrowseDlg" Control="DirectoryCombo" Type="DirectoryCombo" X="86" Y="55" Width="204" Height="80" Attributes="393227" Property="_BrowseProperty" Order="600" MsiKey="BrowseDlg#DirectoryCombo"/>
    <ROW Dialog_="BrowseDlg" Control="Up" Type="PushButton" X="298" Y="55" Width="19" Height="19" Attributes="3670019" Text="[UpDirIcon]" Help="Переход на один уровень вверх|" Order="700" HelpLocId="Control.Help.BrowseDlg#Up" MsiKey="BrowseDlg#Up"/>
    <ROW Dialog_="BrowseDlg" Control="NewFolder" Type="PushButton" X="325" Y="55" Width="19" Height="19" Attributes="3670019" Text="[NewDirIcon]" Help="Создать новую папку|" Order="800" HelpLocId="Control.Help.BrowseDlg#NewFolder" MsiKey="BrowseDlg#NewFolder"/>
    <ROW Dialog_="BrowseDlg" Control="DirectoryList" Type="DirectoryList" X="25" Y="83" Width="320" Height="110" Attributes="15" Property="_BrowseProperty" Order="900" MsiKey="BrowseDlg#DirectoryList"/>
    <ROW Dialog_="BrowseDlg" Control="PathLabel" Type="Text" X="25" Y="205" Width="75" Height="10" Attributes="3" Text="&amp;Имя папки:" Order="1000" TextLocId="Control.Text.BrowseDlg#PathLabel" MsiKey="BrowseDlg#PathLabel"/>
    <ROW Dialog_="BrowseDlg" Control="BannerBitmap" Type="Bitmap" X="0" Y="0" Width="370" Height="44" Attributes="1048577" Text="[BannerBitmap]" Order="1100" MsiKey="BrowseDlg#BannerBitmap"/>
    <ROW Dialog_="BrowseDlg" Control="Title" Type="Text" X="15" Y="6" Width="200" Height="15" Attributes="196611" Text="Изменение папки назначения" TextStyle="[DlgTitleFont]" Order="1200" TextLocId="Control.Text.BrowseDlg#Title" MsiKey="BrowseDlg#Title"/>
    <ROW Dialog_="BrowseDlg" Control="Description" Type="Text" X="25" Y="23" Width="280" Height="20" Attributes="196611" Text="Указание папки назначения" Order="1300" TextLocId="Control.Text.BrowseDlg#Description" MsiKey="BrowseDlg#Description"/>
    <ROW Dialog_="BrowseDlg" Control="BannerLine" Type="Line" X="0" Y="44" Width="372" Height="0" Attributes="1" Order="1400" MsiKey="BrowseDlg#BannerLine"/>
    <ROW Dialog_="ClientServerDlg" Control="Title" Type="Text" X="15" Y="6" Width="200" Height="15" Attributes="196611" Text="Выбор типа установки" TextStyle="[DlgTitleFont]" Order="800" TextLocId="Control.Text.ClientServerDlg#Title" MsiKey="ClientServerDlg#Title"/>
    <ROW Dialog_="ClientServerDlg" Control="ClientButton" Type="PushButton" X="50" Y="79" Width="38" Height="38" Attributes="5767171" Text="[ClientIcon]" Help="Установка клиента|" Order="900" HelpLocId="Control.Help.ClientServerDlg#TypicalButton" MsiKey="ClientServerDlg#ClientButton" Options="1"/>
    <ROW Dialog_="ClientServerDlg" Control="ClientLabel" Type="Text" X="105" Y="79" Width="100" Height="11" Attributes="3" Text="&amp;Только клиент" TextStyle="[DlgTitleFont]" Order="1000" TextLocId="Control.Text.ClientServerDlg#TypicalLabel" MsiKey="ClientServerDlg#ClientLabel"/>
    <ROW Dialog_="ClientServerDlg" Control="ClientText" Type="Text" X="105" Y="92" Width="230" Height="20" Attributes="3" Text="Только установка монитора" Order="1100" TextLocId="Control.Text.ClientServerDlg#TypicalText" MsiKey="ClientServerDlg#ClientText"/>
    <ROW Dialog_="ClientServerDlg" Control="ServerButton" Type="PushButton" X="180" Y="197" Width="38" Height="38" Attributes="5767170" Text="[ServerIcon]" Help="Установка сервера|" Order="1200" HelpLocId="Control.Help.ClientServerDlg#CustomButton" MsiKey="ClientServerDlg#ServerButton" Options="1"/>
    <ROW Dialog_="ClientServerDlg" Control="ServerLabel" Type="Text" X="227" Y="204" Width="100" Height="11" Attributes="2" Text="&amp;Сервер" TextStyle="[DlgTitleFont]" Order="1300" TextLocId="Control.Text.ClientServerDlg#CustomLabel" MsiKey="ClientServerDlg#ServerLabel"/>
    <ROW Dialog_="ClientServerDlg" Control="ServerText" Type="Text" X="5" Y="204" Width="158" Height="30" Attributes="2" Text="Установка конфигурации сервера." Order="1400" TextLocId="Control.Text.ClientServerDlg#CustomText" MsiKey="ClientServerDlg#ServerText"/>
    <ROW Dialog_="ClientServerDlg" Control="CompleteButton" Type="PushButton" X="50" Y="138" Width="38" Height="38" Attributes="5767171" Text="[ClientServerIcon]" Help="Полная установка|" Order="1500" HelpLocId="Control.Help.ClientServerDlg#CompleteButton" MsiKey="ClientServerDlg#CompleteButton" Options="1"/>
    <ROW Dialog_="ClientServerDlg" Control="CompleteLabel" Type="Text" X="105" Y="138" Width="147" Height="11" Attributes="3" Text="&amp;Установка монитора и настройка БД" TextStyle="[DlgTitleFont]" Order="1600" TextLocId="Control.Text.ClientServerDlg#CompleteLabel" MsiKey="ClientServerDlg#CompleteLabel"/>
    <ROW Dialog_="ClientServerDlg" Control="CompleteText" Type="Text" X="105" Y="151" Width="230" Height="20" Attributes="3" Text="Создать базу, выполнить первоначальные настройки" Order="1700" TextLocId="Control.Text.ClientServerDlg#CompleteText" MsiKey="ClientServerDlg#CompleteText"/>
    <ROW Dialog_="CustomizeDlg" Control="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Attributes="3" Text="[ButtonText_Back]" Order="600" TextLocId="-" MsiKey="CustomizeDlg#Back" Options="1"/>
    <ROW Dialog_="CustomizeDlg" Control="Next" Type="PushButton" X="236" Y="243" Width="56" Height="17" Attributes="3" Text="[ButtonText_Next]" Order="700" TextLocId="-" MsiKey="CustomizeDlg#Next" Options="1"/>
    <ROW Dialog_="CustomizeDlg" Control="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Attributes="3" Text="[ButtonText_Cancel]" Order="800" TextLocId="-" MsiKey="CustomizeDlg#Cancel" Options="1"/>
    <ROW Dialog_="CustomizeDlg" Control="BannerBitmap" Type="Bitmap" X="0" Y="0" Width="370" Height="44" Attributes="1048577" Text="[BannerBitmap]" Order="900" MsiKey="CustomizeDlg#BannerBitmap"/>
    <ROW Dialog_="CustomizeDlg" Control="LocationLabel" Type="Text" X="25" Y="200" Width="50" Height="10" Attributes="3" Text="Размещение:" Order="1000" TextLocId="Control.Text.CustomizeDlg#LocationLabel" MsiKey="CustomizeDlg#LocationLabel"/>
    <ROW Dialog_="CustomizeDlg" Control="Location" Type="Text" X="75" Y="200" Width="215" Height="20" Attributes="3" Property="APPDIR" Text="&lt;Путь элемента&gt;" Order="1100" TextLocId="Control.Text.CustomizeDlg#Location" MsiKey="CustomizeDlg#Location"/>
    <ROW Dialog_="CustomizeDlg" Control="Description" Type="Text" X="25" Y="23" Width="280" Height="20" Attributes="196611" Text="Укажите компоненты приложения и способы их установки." Order="1200" TextLocId="Control.Text.CustomizeDlg#Description" MsiKey="CustomizeDlg#Description"/>
    <ROW Dialog_="CustomizeDlg" Control="Box" Type="GroupBox" X="210" Y="81" Width="140" Height="98" Attributes="1" Order="1300" MsiKey="CustomizeDlg#Box"/>
    <ROW Dialog_="CustomizeDlg" Control="ItemSize" Type="Text" X="215" Y="128" Width="131" Height="50" Attributes="3" Text="Размер текущего выбранного элемента." Order="1400" TextLocId="Control.Text.CustomizeDlg#ItemSize" MsiKey="CustomizeDlg#ItemSize"/>
    <ROW Dialog_="CustomizeDlg" Control="ItemDescription" Type="Text" X="215" Y="90" Width="131" Height="30" Attributes="3" Text="Многострочное описание выбранного элемента." Order="1500" TextLocId="Control.Text.CustomizeDlg#ItemDescription" MsiKey="CustomizeDlg#ItemDescription"/>
    <ROW Dialog_="CustomizeDlg" Control="BannerLine" Type="Line" X="0" Y="44" Width="372" Height="0" Attributes="1" Order="1600" MsiKey="CustomizeDlg#BannerLine"/>
    <ROW Dialog_="CustomizeDlg" Control="Title" Type="Text" X="15" Y="6" Width="200" Height="15" Attributes="196611" Text="Выборочная установка" TextStyle="[DlgTitleFont]" Order="1700" TextLocId="Control.Text.CustomizeDlg#Title" MsiKey="CustomizeDlg#Title"/>
    <ROW Dialog_="CustomizeDlg" Control="Text" Type="Text" X="25" Y="55" Width="320" Height="20" Attributes="3" Text="Для изменения свойств компонентов щелкайте на их значки." Order="1800" TextLocId="Control.Text.CustomizeDlg#Text" MsiKey="CustomizeDlg#Text"/>
    <ROW Dialog_="DiskCostDlg" Control="VolumeList" Type="VolumeCostList" X="20" Y="100" Width="330" Height="120" Attributes="393223" Text="{120}{70}{70}{70}{70}" Order="400" TextLocId="Control.Text.DiskCostDlg#VolumeList" MsiKey="DiskCostDlg#VolumeList"/>
    <ROW Dialog_="DiskCostDlg" Control="Title" Type="Text" X="15" Y="6" Width="200" Height="15" Attributes="196611" Text="Требования к дисковому пространству" TextStyle="[DlgTitleFont]" Order="500" TextLocId="Control.Text.DiskCostDlg#Title" MsiKey="DiskCostDlg#Title"/>
    <ROW Dialog_="DiskCostDlg" Control="Text" Type="Text" X="20" Y="53" Width="330" Height="40" Attributes="3" Text="На указанных дисках недостаточно места для установки выбранных компонентов. Освободите место на этих дисках, измените состав устанавливаемых компонентов или выберите другие диски для установки." Order="600" TextLocId="Control.Text.DiskCostDlg#Text" MsiKey="DiskCostDlg#Text"/>
    <ROW Dialog_="DiskCostDlg" Control="Description" Type="Text" X="20" Y="20" Width="280" Height="20" Attributes="196611" Text="Место на диске, необходимое для установки выбранных компонентов." Order="700" TextLocId="Control.Text.DiskCostDlg#Description" MsiKey="DiskCostDlg#Description"/>
    <ROW Dialog_="DiskCostDlg" Control="BannerLine" Type="Line" X="0" Y="44" Width="372" Height="0" Attributes="1" Order="800" MsiKey="DiskCostDlg#BannerLine"/>
    <ROW Dialog_="FilesInUse" Control="Title" Type="Text" X="15" Y="6" Width="200" Height="15" Attributes="196611" Text="Файлы в использовании" TextStyle="[DlgTitleFont]" Order="600" TextLocId="Control.Text.FilesInUse#Title" MsiKey="FilesInUse#Title"/>
    <ROW Dialog_="FilesInUse" Control="Text" Type="Text" X="20" Y="55" Width="330" Height="30" Attributes="3" Text="Следующие приложения используют файлы, которые нужно обновить с помощью этой установки. Вы можете закрыть приложения и затем нажать кнопку &quot;Повторить&quot; или &quot;Пропустить&quot;, чтобы продолжить установку и заменить файлы при перезагрузке системы." Order="700" TextLocId="Control.Text.FilesInUse#Text" MsiKey="FilesInUse#Text"/>
    <ROW Dialog_="FilesInUse" Control="List" Type="ListBox" X="20" Y="87" Width="330" Height="130" Attributes="7" Property="FileInUseProcess" Order="800" MsiKey="FilesInUse#List"/>
    <ROW Dialog_="FilesInUse" Control="Description" Type="Text" X="20" Y="23" Width="280" Height="20" Attributes="196611" Text="В настоящий момент используются некоторые файлы, которые необходимо обновить." Order="900" TextLocId="Control.Text.FilesInUse#Description" MsiKey="FilesInUse#Description"/>
    <ROW Dialog_="FilesInUse" Control="BannerLine" Type="Line" X="0" Y="44" Width="372" Height="0" Attributes="1" Order="1000" MsiKey="FilesInUse#BannerLine"/>
    <ROW Dialog_="FolderDlg" Control="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Attributes="3" Text="[ButtonText_Cancel]" Order="600" TextLocId="-" MsiKey="FolderDlg#Cancel" Options="1"/>
    <ROW Dialog_="FolderDlg" Control="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Attributes="3" Text="[ButtonText_Back]" Order="700" TextLocId="-" MsiKey="FolderDlg#Back" Options="1"/>
    <ROW Dialog_="FolderDlg" Control="BannerBitmap" Type="Bitmap" X="0" Y="0" Width="370" Height="44" Attributes="1048577" Text="[BannerBitmap]" Help="|" Order="800" HelpLocId="Control.Help.FolderDlg#BannerBitmap" MsiKey="FolderDlg#BannerBitmap"/>
    <ROW Dialog_="FolderDlg" Control="Title" Type="Text" X="15" Y="6" Width="200" Height="15" Attributes="196611" Text="Выбор папки установки" TextStyle="[DlgTitleFont]" Order="900" TextLocId="Control.Text.FolderDlg#Title" MsiKey="FolderDlg#Title"/>
    <ROW Dialog_="FolderDlg" Control="Text" Type="Text" X="25" Y="70" Width="320" Height="40" Attributes="3" Text="Для установки в эту папку, нажмите кнопку &quot;[Text_Next]&quot;. Чтобы установить в другую папку, введите ее ниже, или нажмите кнопку &quot;Обзор&quot;, чтобы указать ее." Order="1000" TextLocId="Control.Text.FolderDlg#Text" MsiKey="FolderDlg#Text"/>
    <ROW Dialog_="FolderDlg" Control="Description" Type="Text" X="25" Y="23" Width="280" Height="15" Attributes="196611" Text="Выбор папки для установки [ProductName]." Order="1100" TextLocId="Control.Text.FolderDlg#Description" MsiKey="FolderDlg#Description"/>
    <ROW Dialog_="FolderDlg" Control="BannerLine" Type="Line" X="0" Y="44" Width="372" Height="0" Attributes="1" Order="1200" MsiKey="FolderDlg#BannerLine"/>
    <ROW Dialog_="FtpConnectionDialog" Control="Next" Type="PushButton" X="236" Y="243" Width="56" Height="17" Attributes="3" Text="[ButtonText_Next]" Order="100" TextLocId="-" Options="1"/>
    <ROW Dialog_="FtpConnectionDialog" Control="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Attributes="3" Text="[ButtonText_Cancel]" Order="200" TextLocId="-" Options="1"/>
    <ROW Dialog_="FtpConnectionDialog" Control="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Attributes="3" Text="[ButtonText_Back]" Order="300" TextLocId="-" Options="1"/>
    <ROW Dialog_="FtpConnectionDialog" Control="BannerBitmap" Type="Bitmap" X="0" Y="0" Width="370" Height="44" Attributes="1048577" Text="[BannerBitmap]" Order="400"/>
    <ROW Dialog_="FtpConnectionDialog" Control="BannerLine" Type="Line" X="0" Y="44" Width="372" Height="0" Attributes="1" Order="500"/>
    <ROW Dialog_="FtpConnectionDialog" Control="BottomLine" Type="Line" X="5" Y="234" Width="368" Height="0" Attributes="1" Order="600"/>
    <ROW Dialog_="FtpConnectionDialog" Control="Description" Type="Text" X="25" Y="23" Width="280" Height="15" Attributes="196611" Text="Настройка подключения к серверу FTP" Order="700"/>
    <ROW Dialog_="FtpConnectionDialog" Control="Title" Type="Text" X="15" Y="6" Width="200" Height="15" Attributes="196611" Text="FTP Сервер" TextStyle="[DlgTitleFont]" Order="800"/>
    <ROW Dialog_="FtpConnectionDialog" Control="btnCheckFTP" Type="PushButton" X="15" Y="243" Width="113" Height="17" Attributes="3" Text="Проверить подключение" Order="900"/>
    <ROW Dialog_="FtpConnectionDialog" Control="edFtpServer" Type="Edit" X="83" Y="56" Width="269" Height="18" Attributes="3" Property="FTPSERVER_PROP" Text="{260}" Order="1000"/>
    <ROW Dialog_="FtpConnectionDialog" Control="lbFtpServer" Type="Text" X="13" Y="63" Width="50" Height="11" Attributes="65539" Property="TEXT_1_PROP" Text="FTP сервер:" Order="1100"/>
    <ROW Dialog_="FtpConnectionDialog" Control="edFTPLogin" Type="Edit" X="83" Y="82" Width="269" Height="18" Attributes="3" Property="FTPLOGIN_PROP" Text="{260}" Order="1200"/>
    <ROW Dialog_="FtpConnectionDialog" Control="lbFTPLogin" Type="Text" X="14" Y="89" Width="50" Height="11" Attributes="65539" Property="TEXT_1_PROP_1" Text="Логин:" Order="1300"/>
    <ROW Dialog_="FtpConnectionDialog" Control="edFTPPassword" Type="Edit" X="83" Y="107" Width="269" Height="18" Attributes="2097155" Property="FTPPASSWORD_PROP" Text="{260}" Order="1400"/>
    <ROW Dialog_="FtpConnectionDialog" Control="lbFTPPassword" Type="Text" X="14" Y="113" Width="50" Height="11" Attributes="65539" Property="TEXT_1_PROP_2" Text="Пароль:" Order="1500"/>
    <ROW Dialog_="FtpConnectionDialog" Control="edFTPCatalog" Type="Edit" X="83" Y="131" Width="269" Height="18" Attributes="3" Property="FTPCATALOG_PROP" Text="MagicUpdater" Order="1600"/>
    <ROW Dialog_="FtpConnectionDialog" Control="lbFTPCatalog" Type="Text" X="14" Y="137" Width="50" Height="11" Attributes="65539" Property="TEXT_1_PROP_3" Text="Каталог:" Order="1700"/>
    <ROW Dialog_="FtpConnectionDialog" Control="edFTPTmpCatalog" Type="Edit" X="83" Y="178" Width="269" Height="18" Attributes="3" Property="FTPTMPCATALOG_PROP" Text="MagicUpdater\TmpFiles" Order="1800"/>
    <ROW Dialog_="FtpConnectionDialog" Control="lbFTPTmpCatalog" Type="Text" X="14" Y="163" Width="50" Height="33" Attributes="65539" Property="TEXT_1_PROP_4" Text="Каталог временных файлов:" Order="1900"/>
    <ROW Dialog_="MaintenanceTypeDlg" Control="Description" Type="Text" X="25" Y="23" Width="280" Height="20" Attributes="196611" Text="Выберите операцию, которую вы хотите выполнить." Order="1200" TextLocId="Control.Text.MaintenanceTypeDlg#Description" MsiKey="MaintenanceTypeDlg#Description"/>
    <ROW Dialog_="MaintenanceTypeDlg" Control="ChangeText" Type="Text" X="105" Y="78" Width="230" Height="20" Attributes="3" Text="Позволяет изменить способ установки компонентов." Order="1300" TextLocId="Control.Text.MaintenanceTypeDlg#ChangeText" MsiKey="MaintenanceTypeDlg#ChangeText"/>
    <ROW Dialog_="MaintenanceTypeDlg" Control="BannerLine" Type="Line" X="0" Y="44" Width="372" Height="0" Attributes="1" Order="1400" MsiKey="MaintenanceTypeDlg#BannerLine"/>
    <ROW Dialog_="MaintenanceTypeDlg" Control="Title" Type="Text" X="15" Y="6" Width="240" Height="15" Attributes="196611" Text="Изменение, восстановление или удаление установки" TextStyle="[DlgTitleFont]" Order="1500" TextLocId="Control.Text.MaintenanceTypeDlg#Title" MsiKey="MaintenanceTypeDlg#Title"/>
    <ROW Dialog_="MaintenanceTypeDlg" Control="RepairText" Type="Text" X="105" Y="127" Width="230" Height="30" Attributes="3" Text="Восстановление недостающих или поврежденных файлов, ярлыков и записей реестра." Order="1600" TextLocId="Control.Text.MaintenanceTypeDlg#RepairText" MsiKey="MaintenanceTypeDlg#RepairText"/>
    <ROW Dialog_="MaintenanceTypeDlg" Control="RemoveText" Type="Text" X="105" Y="176" Width="230" Height="20" Attributes="3" Text="Удаление [ProductName] с вашего компьютера." Order="1700" TextLocId="Control.Text.MaintenanceTypeDlg#RemoveText" MsiKey="MaintenanceTypeDlg#RemoveText"/>
    <ROW Dialog_="OdinAssConnectionDialog" Control="Next" Type="PushButton" X="236" Y="243" Width="56" Height="17" Attributes="3" Text="[ButtonText_Next]" Order="100" TextLocId="-" Options="1"/>
    <ROW Dialog_="OdinAssConnectionDialog" Control="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Attributes="3" Text="[ButtonText_Cancel]" Order="200" TextLocId="-" Options="1"/>
    <ROW Dialog_="OdinAssConnectionDialog" Control="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Attributes="3" Text="[ButtonText_Back]" Order="300" TextLocId="-" Options="1"/>
    <ROW Dialog_="OdinAssConnectionDialog" Control="BannerBitmap" Type="Bitmap" X="0" Y="0" Width="370" Height="44" Attributes="1048577" Text="[BannerBitmap]" Order="400"/>
    <ROW Dialog_="OdinAssConnectionDialog" Control="BannerLine" Type="Line" X="0" Y="44" Width="372" Height="0" Attributes="1" Order="500"/>
    <ROW Dialog_="OdinAssConnectionDialog" Control="BottomLine" Type="Line" X="5" Y="234" Width="368" Height="0" Attributes="1" Order="600"/>
    <ROW Dialog_="OdinAssConnectionDialog" Control="Description" Type="Text" X="25" Y="23" Width="280" Height="15" Attributes="196611" Text="Настройка подключения к серверу 1С" Order="700"/>
    <ROW Dialog_="OdinAssConnectionDialog" Control="Title" Type="Text" X="15" Y="6" Width="200" Height="15" Attributes="196611" Text="Сервер 1C" TextStyle="[DlgTitleFont]" Order="800"/>
    <ROW Dialog_="OdinAssConnectionDialog" Control="lb1CServer" Type="Text" X="25" Y="62" Width="54" Height="11" Attributes="65539" Property="TEXT_1_PROP_5" Text="Сервер 1С:" Order="900"/>
    <ROW Dialog_="OdinAssConnectionDialog" Control="ed1CServer" Type="Edit" X="85" Y="54" Width="90" Height="18" Attributes="3" Property="SERVER1C_PROP" Text="{260}" Order="1000"/>
    <ROW Dialog_="OdinAssConnectionDialog" Control="lb1CBase" Type="Text" X="190" Y="62" Width="62" Height="11" Attributes="65539" Property="TEXT_1_PROP_5_1" Text="База 1С:" Order="1100"/>
    <ROW Dialog_="OdinAssConnectionDialog" Control="ed1CBase" Type="Edit" X="252" Y="53" Width="90" Height="18" Attributes="3" Property="BASE1C_PROP" Text="{260}" Order="1200"/>
    <ROW Dialog_="OdinAssConnectionDialog" Control="lb1CUser" Type="Text" X="24" Y="93" Width="61" Height="11" Attributes="65539" Property="TEXT_1_PROP_5_2" Text="Пользователь:" Order="1300"/>
    <ROW Dialog_="OdinAssConnectionDialog" Control="ed1CUser" Type="Edit" X="85" Y="85" Width="90" Height="18" Attributes="3" Property="USER1C_PROP" Text="{260}" Order="1400"/>
    <ROW Dialog_="OdinAssConnectionDialog" Control="lb1CPassword" Type="Text" X="190" Y="93" Width="62" Height="11" Attributes="65539" Property="TEXT_1_PROP_5_1_1" Text="Пароль:" Order="1500"/>
    <ROW Dialog_="OdinAssConnectionDialog" Control="ed1CPassword" Type="Edit" X="252" Y="84" Width="90" Height="18" Attributes="2097155" Property="PASSWORD1C_PROP" Text="{260}" Order="1600"/>
    <ROW Dialog_="OdinAssConnectionDialog" Control="lb1CPlatform" Type="Text" X="25" Y="122" Width="52" Height="11" Attributes="65539" Property="TEXT_5_PROP" Text="Платформа:" Order="1700"/>
    <ROW Dialog_="OdinAssConnectionDialog" Control="ed1CPlatform" Type="Edit" X="85" Y="114" Width="257" Height="18" Attributes="3" Property="PLATFORM1C_PROP" Text="{260}" Order="1800"/>
    <ROW Dialog_="OdinAssConnectionDialog" Control="lb1CConfig" Type="Text" X="25" Y="150" Width="317" Height="38" Attributes="65539" Property="TEXT_6_PROP" Text="Конфигурация (выбирает обработку для инициализации узлов обмена для типовых конфигураций, если конфигурация собственной разработки - обработку в папке программы нужно поправить вручную):" Order="1900"/>
    <ROW Dialog_="OdinAssConnectionDialog" Control="cb1CConfig" Type="ComboBox" X="25" Y="187" Width="317" Height="16" Attributes="3" Property="CONFIG1C_PROP" Text="1С:Розница 2.2" Order="2000"/>
    <ROW Dialog_="OutOfDiskDlg" Control="VolumeList" Type="VolumeCostList" X="20" Y="100" Width="330" Height="120" Attributes="393223" Text="{120}{70}{70}{70}{70}" Order="400" TextLocId="Control.Text.OutOfDiskDlg#VolumeList" MsiKey="OutOfDiskDlg#VolumeList"/>
    <ROW Dialog_="OutOfDiskDlg" Control="Title" Type="Text" X="15" Y="6" Width="200" Height="15" Attributes="196611" Text="Недостаточно места на диске" TextStyle="[DlgTitleFont]" Order="500" TextLocId="Control.Text.OutOfDiskDlg#Title" MsiKey="OutOfDiskDlg#Title"/>
    <ROW Dialog_="OutOfDiskDlg" Control="Text" Type="Text" X="20" Y="53" Width="330" Height="40" Attributes="3" Text="На указанных дисках недостаточно места для установки выбранных компонентов приложения. Вы можете удалить ненужные файлы с данных дисков, установить меньше компонентов, либо выбрать для установки другие диски." Order="600" TextLocId="Control.Text.OutOfDiskDlg#Text" MsiKey="OutOfDiskDlg#Text"/>
    <ROW Dialog_="OutOfDiskDlg" Control="Description" Type="Text" X="20" Y="20" Width="280" Height="20" Attributes="196611" Text="На диске недостаточно свободного места для установки выбранных компонентов." Order="700" TextLocId="Control.Text.OutOfDiskDlg#Description" MsiKey="OutOfDiskDlg#Description"/>
    <ROW Dialog_="OutOfDiskDlg" Control="BannerLine" Type="Line" X="0" Y="44" Width="372" Height="0" Attributes="1" Order="800" MsiKey="OutOfDiskDlg#BannerLine"/>
    <ROW Dialog_="OutOfRbDiskDlg" Control="Text2" Type="Text" X="20" Y="94" Width="330" Height="40" Attributes="3" Text="Кроме того можно отключить функцию отката установки. Откат позволяет вернуть исходное состояние настроек компьютера в случае, если установка была прервана. Для отключения функции отката нажмите кнопку &quot;Да&quot;." Order="500" TextLocId="Control.Text.OutOfRbDiskDlg#Text2" MsiKey="OutOfRbDiskDlg#Text2"/>
    <ROW Dialog_="OutOfRbDiskDlg" Control="Text" Type="Text" X="20" Y="53" Width="330" Height="40" Attributes="3" Text="На указанных дисках недостаточно места для установки выбранных компонентов приложения. Вы можете удалить ненужные файлы с данных дисков, установить меньше компонентов, либо выбрать для установки другие диски." Order="600" TextLocId="Control.Text.OutOfRbDiskDlg#Text" MsiKey="OutOfRbDiskDlg#Text"/>
    <ROW Dialog_="OutOfRbDiskDlg" Control="Description" Type="Text" X="20" Y="20" Width="280" Height="20" Attributes="196611" Text="На диске недостаточно свободного места для установки выбранных компонентов." Order="700" TextLocId="Control.Text.OutOfRbDiskDlg#Description" MsiKey="OutOfRbDiskDlg#Description"/>
    <ROW Dialog_="OutOfRbDiskDlg" Control="BannerLine" Type="Line" X="0" Y="44" Width="372" Height="0" Attributes="1" Order="800" MsiKey="OutOfRbDiskDlg#BannerLine"/>
    <ROW Dialog_="OutOfRbDiskDlg" Control="VolumeList" Type="VolumeCostList" X="20" Y="140" Width="330" Height="80" Attributes="4587527" Text="{120}{70}{70}{70}{70}" Order="900" TextLocId="Control.Text.OutOfRbDiskDlg#VolumeList" MsiKey="OutOfRbDiskDlg#VolumeList"/>
    <ROW Dialog_="OutOfRbDiskDlg" Control="Title" Type="Text" X="15" Y="6" Width="200" Height="15" Attributes="196611" Text="Недостаточно места на диске" TextStyle="[DlgTitleFont]" Order="1000" TextLocId="Control.Text.OutOfRbDiskDlg#Title" MsiKey="OutOfRbDiskDlg#Title"/>
    <ROW Dialog_="PrerequisitesDlg" Control="Title" Type="Text" X="15" Y="6" Width="200" Height="15" Attributes="196611" Text="Предварительные условия" TextStyle="[DlgTitleFont]" Order="800" TextLocId="Control.Text.PrerequisitesDlg#Title" MsiKey="PrerequisitesDlg#Title"/>
    <ROW Dialog_="PrerequisitesDlg" Control="PrerequisiteSelector" Type="PrerequisiteSelector" X="15" Y="57" Width="344" Height="162" Attributes="3" Property="PREREQUISITESDLGPREREQUISITESELECTOR_0_PROP" Text="{110}{90}{90}{90}Имя,Требование,Найдено,Действие" Order="900" TextLocId="Control.Text.PrerequisitesDlg#PrerequisiteSelector" MsiKey="PrerequisitesDlg#PrerequisiteSelector" ExtType="PrerequisiteSelector"/>
    <ROW Dialog_="ProgressDlg" Control="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Attributes="1" Text="[ButtonText_Back]" Order="400" TextLocId="-" MsiKey="ProgressDlg#Back" Options="1"/>
    <ROW Dialog_="ProgressDlg" Control="Next" Type="PushButton" X="236" Y="243" Width="56" Height="17" Attributes="1" Text="[ButtonText_Next]" Order="500" TextLocId="-" MsiKey="ProgressDlg#Next" Options="1"/>
    <ROW Dialog_="ProgressDlg" Control="BannerLine" Type="Line" X="0" Y="44" Width="372" Height="0" Attributes="1" Order="600" MsiKey="ProgressDlg#BannerLine"/>
    <ROW Dialog_="ProgressDlg" Control="ActionText" Type="Text" X="80" Y="100" Width="255" Height="10" Attributes="3" Order="700" MsiKey="ProgressDlg#ActionText"/>
    <ROW Dialog_="ProgressDlg" Control="Title" Type="Text" X="20" Y="15" Width="250" Height="15" Attributes="196611" Text="[Progress1] [ProductName]" TextStyle="[DlgTitleFont]" Order="800" TextLocId="Control.Text.ProgressDlg#Title" MsiKey="ProgressDlg#Title"/>
    <ROW Dialog_="ProgressDlg" Control="Text" Type="Text" X="35" Y="65" Width="300" Height="30" Attributes="196611" Text="Подождите, пока мастер [Progress2] [ProductName]. Это может занять несколько минут." Order="900" TextLocId="Control.Text.ProgressDlg#Text" MsiKey="ProgressDlg#Text"/>
    <ROW Dialog_="ProgressDlg" Control="StatusLabel" Type="Text" X="35" Y="100" Width="45" Height="10" Attributes="3" Text="Состояние:" Order="1000" TextLocId="Control.Text.ProgressDlg#StatusLabel" MsiKey="ProgressDlg#StatusLabel"/>
    <ROW Dialog_="ProgressDlg" Control="ProgressBar" Type="ProgressBar" X="35" Y="115" Width="300" Height="10" Attributes="65537" Text="Выполнено" Order="1100" TextLocId="Control.Text.ProgressDlg#ProgressBar" MsiKey="ProgressDlg#ProgressBar"/>
    <ROW Dialog_="ProgressPrereqDlg" Control="BannerLine" Type="Line" X="0" Y="44" Width="370" Height="0" Attributes="1" Order="600" MsiKey="ProgressPrereqDlg#BannerLine"/>
    <ROW Dialog_="ProgressPrereqDlg" Control="ActionText" Type="Text" X="80" Y="100" Width="255" Height="10" Attributes="3" Order="700" MsiKey="ProgressPrereqDlg#ActionText"/>
    <ROW Dialog_="ProgressPrereqDlg" Control="Title" Type="Text" X="20" Y="15" Width="250" Height="15" Attributes="196611" Text="[Progress1] prerequisites for [ProductName]" TextStyle="[DlgTitleFont]" Order="800" TextLocId="Control.Text.ProgressPrereqDlg#Title" MsiKey="ProgressPrereqDlg#Title"/>
    <ROW Dialog_="ProgressPrereqDlg" Control="Text" Type="Text" X="35" Y="65" Width="300" Height="30" Attributes="196611" Text="Please wait while the [Wizard] [Progress2] prerequisites for [ProductName].  This may take several minutes." Order="900" TextLocId="Control.Text.ProgressPrereqDlg#Text" MsiKey="ProgressPrereqDlg#Text"/>
    <ROW Dialog_="ProgressPrereqDlg" Control="StatusLabel" Type="Text" X="35" Y="100" Width="45" Height="10" Attributes="3" Text="Status:" Order="1000" TextLocId="Control.Text.ProgressPrereqDlg#StatusLabel" MsiKey="ProgressPrereqDlg#StatusLabel"/>
    <ROW Dialog_="ProgressPrereqDlg" Control="ProgressBar" Type="ProgressBar" X="35" Y="115" Width="300" Height="10" Attributes="65537" Text="Progress done" Order="1100" TextLocId="Control.Text.ProgressPrereqDlg#ProgressBar" MsiKey="ProgressPrereqDlg#ProgressBar"/>
    <ROW Dialog_="SQLServerConnectionDlg" Control="SQLServerConnectionDlgDialogInitializer" Type="DialogInitializer" X="0" Y="0" Width="0" Height="0" Attributes="0" Order="-1" TextLocId="-" HelpLocId="-" ExtDataLocId="-"/>
    <ROW Dialog_="SQLServerConnectionDlg" Control="ServerCombo" Type="ComboBox" X="95" Y="63" Width="250" Height="16" Attributes="3" Property="SERVER_PROP" Text="{260}" Order="200" MsiKey="SQLServerConnectionDlg#ServerCombo"/>
    <ROW Dialog_="SQLServerConnectionDlg" Control="UsernameLabel" Type="Text" X="25" Y="124" Width="53" Height="11" Attributes="196611" Text="Пользователь:" Order="300" TextLocId="Control.Text.SQLConnectionDlg#UsernameLabel" MsiKey="SQLServerConnectionDlg#UsernameLabel"/>
    <ROW Dialog_="SQLServerConnectionDlg" Control="UsernameEdit" Type="Edit" X="95" Y="121" Width="250" Height="18" Attributes="1" Property="USERNAME_PROP" Text="{255}" Order="400" TextLocId="Control.Text.SQLConnectionDlg#UsernameEdit" MsiKey="SQLServerConnectionDlg#UsernameEdit"/>
    <ROW Dialog_="SQLServerConnectionDlg" Control="Title" Type="Text" X="15" Y="6" Width="200" Height="15" Attributes="196611" Text="База данных SQL" TextStyle="[DlgTitleFont]" Order="500" TextLocId="Control.Text.SQLConnectionDlg#Title" MsiKey="SQLServerConnectionDlg#Title"/>
    <ROW Dialog_="SQLServerConnectionDlg" Control="PasswordEdit" Type="Edit" X="95" Y="147" Width="250" Height="18" Attributes="2097153" Property="PASSWORD_PROP" Text="{255}" Order="600" TextLocId="Control.Text.SQLConnectionDlg#PasswordEdit" MsiKey="SQLServerConnectionDlg#PasswordEdit"/>
    <ROW Dialog_="SQLServerConnectionDlg" Control="DatabaseCombo" Type="ComboBox" X="95" Y="186" Width="230" Height="16" Attributes="3" Property="DATABASE_PROP" Text="MagicUpdater" Order="700" MsiKey="SQLServerConnectionDlg#DatabaseCombo"/>
    <ROW Dialog_="SQLServerConnectionDlg" Control="Description" Type="Text" X="25" Y="23" Width="280" Height="15" Attributes="196611" Text="Настройка подключения SQL..." Order="800" TextLocId="Control.Text.SQLConnectionDlg#Description" MsiKey="SQLServerConnectionDlg#Description"/>
    <ROW Dialog_="SQLServerConnectionDlg" Control="BannerLine" Type="Line" X="0" Y="44" Width="372" Height="0" Attributes="1" Order="900" MsiKey="SQLServerConnectionDlg#BannerLine"/>
    <ROW Dialog_="SQLServerConnectionDlg" Control="ServerLabel" Type="Text" X="25" Y="66" Width="53" Height="11" Attributes="196611" Text="Сервер:" Order="1000" TextLocId="Control.Text.SQLConnectionDlg#ServerLabel" MsiKey="SQLServerConnectionDlg#ServerLabel"/>
    <ROW Dialog_="SQLServerConnectionDlg" Control="TrustedConnectionCheck" Type="CheckBox" X="25" Y="99" Width="320" Height="13" Attributes="0" Property="SQL_TRUSTED_CONNECTION" Text="Trusted Connection (Windows integrated authentication)" Order="1100" TextLocId="Control.ExtData.SQLServerConnectionDlg#TrustedConnectionCheckBox" MsiKey="SQLServerConnectionDlg#TrustedConnectionCheck"/>
    <ROW Dialog_="SQLServerConnectionDlg" Control="Next" Type="PushButton" X="236" Y="243" Width="56" Height="17" Attributes="3" Text="[ButtonText_Next]" Order="1200" TextLocId="-" MsiKey="SQLServerConnectionDlg#Next" Options="1"/>
    <ROW Dialog_="SQLServerConnectionDlg" Control="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Attributes="3" Text="[ButtonText_Back]" Order="1300" TextLocId="-" MsiKey="SQLServerConnectionDlg#Back" Options="1"/>
    <ROW Dialog_="SQLServerConnectionDlg" Control="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Attributes="3" Text="[ButtonText_Cancel]" Order="1400" TextLocId="-" MsiKey="SQLServerConnectionDlg#Cancel" Options="1"/>
    <ROW Dialog_="SQLServerConnectionDlg" Control="PasswordLabel" Type="Text" X="25" Y="150" Width="53" Height="11" Attributes="196611" Text="Пароль:" Order="1500" TextLocId="Control.Text.SQLConnectionDlg#PasswordLabel" MsiKey="SQLServerConnectionDlg#PasswordLabel"/>
    <ROW Dialog_="SQLServerConnectionDlg" Control="DatabaseLabel" Type="Text" X="25" Y="189" Width="53" Height="11" Attributes="196611" Text="База данных:" Order="1600" TextLocId="Control.Text.SQLConnectionDlg#DatabaseLabel" MsiKey="SQLServerConnectionDlg#DatabaseLabel"/>
    <ROW Dialog_="SQLServerConnectionDlg" Control="BrowseDatabases" Type="PushButton" X="327" Y="185" Width="18" Height="18" Attributes="3" Text="..." Order="1700" TextLocId="Metro.Control.ExtData.WelcomeDlg.BrowseTxt" MsiKey="SQLServerConnectionDlg#BrowseDatabases"/>
    <ROW Dialog_="SQLServerConnectionDlg" Control="TestConnectionLink" Type="PushButton" X="25" Y="243" Width="115" Height="17" Attributes="65539" Text="Проверить подключение" Order="1800" TextLocId="Control.Text.SQLServerConnectionDlg#TestSqlConnectionLabel" MsiKey="SQLServerConnectionDlg#TestConnectionLink"/>
    <ROW Dialog_="VerifyReadyDlg" Control="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Attributes="3" Text="[ButtonText_Back]" Order="500" TextLocId="-" MsiKey="VerifyReadyDlg#Back" Options="1"/>
    <ROW Dialog_="VerifyReadyDlg" Control="Text" Type="Text" X="25" Y="70" Width="320" Height="40" Attributes="196611" Text="Нажмите кнопку &quot;Установить&quot;, чтобы начать установку. Если вы хотите просмотреть или изменить какие-либо параметры установки, нажмите кнопку &quot;Назад&quot;, чтобы завершить работу мастера нажмите кнопку &quot;Отмена&quot;." Order="600" TextLocId="Control.Text.VerifyReadyDlg#Text" MsiKey="VerifyReadyDlg#Text"/>
    <ROW Dialog_="VerifyReadyDlg" Control="Description" Type="Text" X="25" Y="23" Width="304" Height="20" Attributes="196611" Text="Мастер готов выполнить установку [ProductName]." Order="700" TextLocId="Control.Text.VerifyReadyDlg#Description" MsiKey="VerifyReadyDlg#Description"/>
    <ROW Dialog_="VerifyReadyDlg" Control="BannerLine" Type="Line" X="0" Y="44" Width="372" Height="0" Attributes="1" Order="800" MsiKey="VerifyReadyDlg#BannerLine"/>
    <ROW Dialog_="VerifyReadyDlg" Control="Title" Type="Text" X="15" Y="6" Width="304" Height="15" Attributes="196611" Text="Все готово для начала установки" TextStyle="[DlgTitleFont]" Order="900" TextLocId="Control.Text.VerifyReadyDlg#Title" MsiKey="VerifyReadyDlg#Title"/>
    <ATTRIBUTE name="DeletedRows" value="AdminBrowseDlg#Logo@AdminInstallPointDlg#Logo@BrowseDlg#Logo@ClientServerDlg#Logo@CustomizeDlg#Logo@DiskCostDlg#Logo@FilesInUse#Logo@FolderDlg#Logo@MaintenanceTypeDlg#Logo@MsiRMFilesInUse#Logo@OutOfDiskDlg#Logo@OutOfRbDiskDlg#Logo@PrerequisitesDlg#Logo@ProgressDlg#Logo@ProgressPrereqDlg#Logo@SQLServerConnectionDlg#Logo@VerifyReadyDlg#Logo"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.MsiControlEventComponent">
    <ROW Dialog_="WelcomeDlg" Control_="Next" Event="NewDialog" Argument="FolderDlg" Condition="AI_INSTALL" Ordering="1"/>
    <ROW Dialog_="VerifyReadyDlg" Control_="Install" Event="EndDialog" Argument="Return" Condition="AI_INSTALL" Ordering="197"/>
    <ROW Dialog_="VerifyReadyDlg" Control_="Back" Event="NewDialog" Argument="OdinAssConnectionDialog" Condition="AI_INSTALL" Ordering="201"/>
    <ROW Dialog_="MaintenanceWelcomeDlg" Control_="Next" Event="NewDialog" Argument="MaintenanceTypeDlg" Condition="AI_MAINT" Ordering="99"/>
    <ROW Dialog_="CustomizeDlg" Control_="Next" Event="NewDialog" Argument="VerifyReadyDlg" Condition="AI_MAINT" Ordering="101"/>
    <ROW Dialog_="CustomizeDlg" Control_="Back" Event="NewDialog" Argument="MaintenanceTypeDlg" Condition="AI_MAINT" Ordering="1"/>
    <ROW Dialog_="VerifyReadyDlg" Control_="Install" Event="EndDialog" Argument="Return" Condition="AI_MAINT" Ordering="198"/>
    <ROW Dialog_="VerifyReadyDlg" Control_="Back" Event="NewDialog" Argument="CustomizeDlg" Condition="AI_MAINT" Ordering="204"/>
    <ROW Dialog_="MaintenanceTypeDlg" Control_="ChangeButton" Event="NewDialog" Argument="CustomizeDlg" Condition="AI_MAINT" Ordering="501"/>
    <ROW Dialog_="MaintenanceTypeDlg" Control_="Back" Event="NewDialog" Argument="MaintenanceWelcomeDlg" Condition="AI_MAINT" Ordering="1"/>
    <ROW Dialog_="MaintenanceTypeDlg" Control_="RemoveButton" Event="NewDialog" Argument="VerifyRemoveDlg" Condition="AI_MAINT AND InstallMode=&quot;Remove&quot;" Ordering="601"/>
    <ROW Dialog_="VerifyRemoveDlg" Control_="Back" Event="NewDialog" Argument="MaintenanceTypeDlg" Condition="AI_MAINT AND InstallMode=&quot;Remove&quot;" Ordering="1"/>
    <ROW Dialog_="MaintenanceTypeDlg" Control_="RepairButton" Event="NewDialog" Argument="VerifyRepairDlg" Condition="AI_MAINT AND InstallMode=&quot;Repair&quot;" Ordering="601"/>
    <ROW Dialog_="VerifyRepairDlg" Control_="Back" Event="NewDialog" Argument="MaintenanceTypeDlg" Condition="AI_MAINT AND InstallMode=&quot;Repair&quot;" Ordering="1"/>
    <ROW Dialog_="VerifyRepairDlg" Control_="Repair" Event="EndDialog" Argument="Return" Condition="AI_MAINT AND InstallMode=&quot;Repair&quot;" Ordering="399" Options="1"/>
    <ROW Dialog_="VerifyRemoveDlg" Control_="Remove" Event="EndDialog" Argument="Return" Condition="AI_MAINT AND InstallMode=&quot;Remove&quot;" Ordering="299" Options="1"/>
    <ROW Dialog_="PatchWelcomeDlg" Control_="Next" Event="NewDialog" Argument="VerifyReadyDlg" Condition="AI_PATCH" Ordering="201"/>
    <ROW Dialog_="ResumeDlg" Control_="Install" Event="EndDialog" Argument="Return" Condition="AI_RESUME" Ordering="299"/>
    <ROW Dialog_="WelcomePrereqDlg" Control_="Next" Event="NewDialog" Argument="PrerequisitesDlg" Condition="AI_BOOTSTRAPPER" Ordering="1"/>
    <ROW Dialog_="PrerequisitesDlg" Control_="Next" Event="EndDialog" Argument="Return" Condition="AI_BOOTSTRAPPER" Ordering="1"/>
    <ROW Dialog_="PrerequisitesDlg" Control_="Back" Event="NewDialog" Argument="WelcomePrereqDlg" Condition="AI_BOOTSTRAPPER" Ordering="1"/>
    <ROW Dialog_="VerifyReadyDlg" Control_="Install" Event="EndDialog" Argument="Return" Condition="AI_PATCH" Ordering="199"/>
    <ROW Dialog_="VerifyReadyDlg" Control_="Back" Event="NewDialog" Argument="PatchWelcomeDlg" Condition="AI_PATCH" Ordering="205"/>
    <ROW Dialog_="SQLServerConnectionDlg" Control_="Next" Event="NewDialog" Argument="FtpConnectionDialog" Condition="AI_INSTALL AND ( ONLY_MONITOR = &quot;0&quot; )" Ordering="2"/>
    <ROW Dialog_="SQLServerConnectionDlg" Control_="Back" Event="NewDialog" Argument="ClientServerDlg" Condition="AI_INSTALL" Ordering="1"/>
    <ROW Dialog_="SQLServerConnectionDlg" Control_="SQLServerConnectionDlgDialogInitializer" Event="DoAction" Argument="BrowseSqlServers" Condition="1" Ordering="1"/>
    <ROW Dialog_="SQLServerConnectionDlg" Control_="SQLServerConnectionDlgDialogInitializer" Event="DoAction" Argument="AI_DATA_SETTER_2" Condition="1" Ordering="0"/>
    <ROW Dialog_="SQLServerConnectionDlg" Control_="BrowseDatabases" Event="DoAction" Argument="ShowDatabases" Condition="1" Ordering="1"/>
    <ROW Dialog_="SQLServerConnectionDlg" Control_="BrowseDatabases" Event="DoAction" Argument="AI_DATA_SETTER_3" Condition="1" Ordering="0"/>
    <ROW Dialog_="SQLServerConnectionDlg" Control_="BrowseDatabases" Event="[AiRefreshDlg]" Argument="1" Condition="1" Ordering="2"/>
    <ROW Dialog_="SQLServerConnectionDlg" Control_="TestConnectionLink" Event="DoAction" Argument="TestODBCConnection" Condition="NOT (SqlConnectionString = &quot;&quot;)" Ordering="200"/>
    <ROW Dialog_="FtpConnectionDialog" Control_="Cancel" Event="SpawnDialog" Argument="CancelDlg" Condition="1" Ordering="100"/>
    <ROW Dialog_="FtpConnectionDialog" Control_="Next" Event="NewDialog" Argument="OdinAssConnectionDialog" Condition="AI_INSTALL" Ordering="1"/>
    <ROW Dialog_="FtpConnectionDialog" Control_="Back" Event="NewDialog" Argument="SQLServerConnectionDlg" Condition="AI_INSTALL" Ordering="1"/>
    <ROW Dialog_="OdinAssConnectionDialog" Control_="Cancel" Event="SpawnDialog" Argument="CancelDlg" Condition="1" Ordering="100"/>
    <ROW Dialog_="OdinAssConnectionDialog" Control_="Next" Event="NewDialog" Argument="VerifyReadyDlg" Condition="AI_INSTALL" Ordering="1"/>
    <ROW Dialog_="OdinAssConnectionDialog" Control_="Back" Event="NewDialog" Argument="FtpConnectionDialog" Condition="AI_INSTALL" Ordering="1"/>
    <ROW Dialog_="FtpConnectionDialog" Control_="btnCheckFTP" Event="DoAction" Argument="CheckFTPAction" Condition="AI_INSTALL" Ordering="0"/>
    <ROW Dialog_="ClientServerDlg" Control_="CompleteButton" Event="NewDialog" Argument="SQLServerConnectionDlg" Condition="AI_INSTALL AND ( ONLY_MONITOR = &quot;0&quot; )" Ordering="104"/>
    <ROW Dialog_="ClientServerDlg" Control_="ClientButton" Event="NewDialog" Argument="SQLServerConnectionDlg" Condition="AI_INSTALL" Ordering="107"/>
    <ROW Dialog_="ClientServerDlg" Control_="Back" Event="NewDialog" Argument="FolderDlg" Condition="AI_INSTALL" Ordering="1"/>
    <ROW Dialog_="ClientServerDlg" Control_="ServerButton" Event="NewDialog" Argument="SQLServerConnectionDlg" Condition="AI_INSTALL AND InstallMode=&quot;Server&quot;" Ordering="101"/>
    <ROW Dialog_="SQLServerConnectionDlg" Control_="Back" Event="NewDialog" Argument="ClientServerDlg" Condition="AI_INSTALL AND InstallMode=&quot;Server&quot;" Ordering="3"/>
    <ROW Dialog_="ClientServerDlg" Control_="CompleteButton" Event="NewDialog" Argument="SQLServerConnectionDlg" Condition="AI_INSTALL AND InstallMode=&quot;ClientServer&quot;" Ordering="105"/>
    <ROW Dialog_="SQLServerConnectionDlg" Control_="Back" Event="NewDialog" Argument="ClientServerDlg" Condition="AI_INSTALL AND InstallMode=&quot;ClientServer&quot;" Ordering="2"/>
    <ROW Dialog_="ClientServerDlg" Control_="ClientButton" Event="[ONLY_MONITOR]" Argument="1" Condition="AI_INSTALL" Ordering="105"/>
    <ROW Dialog_="ClientServerDlg" Control_="ServerButton" Event="AddLocal" Argument="Server" Condition="1" Ordering="102"/>
    <ROW Dialog_="ClientServerDlg" Control_="ServerButton" Event="AddLocal" Argument="Common" Condition="1" Ordering="103"/>
    <ROW Dialog_="ClientServerDlg" Control_="ClientButton" Event="NewDialog" Argument="VerifyReadyDlg" Condition="AI_INSTALL" Ordering="106"/>
    <ROW Dialog_="SQLServerConnectionDlg" Control_="Next" Event="NewDialog" Argument="VerifyReadyDlg" Condition="AI_INSTALL AND ( ONLY_MONITOR = &quot;1&quot; )" Ordering="1"/>
    <ROW Dialog_="ClientServerDlg" Control_="CompleteButton" Event="[ONLY_MONITOR]" Argument="0" Condition="AI_INSTALL" Ordering="102"/>
    <ROW Dialog_="FolderDlg" Control_="Next" Event="NewDialog" Argument="ClientServerDlg" Condition="AI_INSTALL" Ordering="201"/>
    <ROW Dialog_="FolderDlg" Control_="Back" Event="NewDialog" Argument="WelcomeDlg" Condition="AI_INSTALL" Ordering="1"/>
    <ATTRIBUTE name="DeletedRows" value="ClientServerDlg#ClientButton#[InstallMode]#Client#1@ClientServerDlg#CompleteButton#[InstallMode]#ClientServer#1"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.MsiCreateFolderComponent">
    <ROW Directory_="SHORTCUTDIR" Component_="SHORTCUTDIR" ManualDelete="false"/>
    <ROW Directory_="MagicUpdater_Dir" Component_="MagicUpdater" ManualDelete="false"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.MsiCustActComponent">
    <ROW Action="AI_AiRemoveFilesCommit" Type="11777" Source="ResourceCleaner.dll" Target="OnAiRemoveFilesCommit" WithoutSeq="true"/>
    <ROW Action="AI_AiRemoveFilesDeferred_Permanent" Type="11265" Source="ResourceCleaner.dll" Target="OnAiRemoveFilesPermanent" WithoutSeq="true"/>
    <ROW Action="AI_AiRemoveFilesDeferred_Undoable" Type="11265" Source="ResourceCleaner.dll" Target="OnAiRemoveFilesUndoable" WithoutSeq="true"/>
    <ROW Action="AI_AiRemoveFilesImmediate" Type="1" Source="ResourceCleaner.dll" Target="OnAiRemoveFilesImmediate"/>
    <ROW Action="AI_AiRemoveFilesRollback" Type="11521" Source="ResourceCleaner.dll" Target="OnAiUndoRemoveFiles"/>
    <ROW Action="AI_AppSearchEx" Type="1" Source="Prereq.dll" Target="DoAppSearchEx"/>
    <ROW Action="AI_BACKUP_AI_SETUPEXEPATH" Type="51" Source="AI_SETUPEXEPATH_ORIGINAL" Target="[AI_SETUPEXEPATH]"/>
    <ROW Action="AI_DATA_SETTER" Type="51" Source="CustomActionData" Target="[~]"/>
    <ROW Action="AI_DATA_SETTER_1" Type="51" Source="CustomActionData" Target="[~]"/>
    <ROW Action="AI_DATA_SETTER_2" Type="51" Source="CustomActionData" Target="DlgServerBrowse"/>
    <ROW Action="AI_DATA_SETTER_3" Type="51" Source="CustomActionData" Target="DlgDatabaseBrowse"/>
    <ROW Action="AI_DATA_SETTER_4" Type="51" Source="CustomActionData" Target="[~]"/>
    <ROW Action="AI_DATA_SETTER_5" Type="51" Source="CustomActionData" Target="[~]"/>
    <ROW Action="AI_DATA_SETTER_6" Type="51" Source="AI_ExtractFiles" Target="[AI_SETUPEXEPATH]"/>
    <ROW Action="AI_DOWNGRADE" Type="19" Target="4010"/>
    <ROW Action="AI_DeleteCadLzma" Type="51" Source="AI_DeleteLzma" Target="[AI_SETUPEXEPATH]"/>
    <ROW Action="AI_DeleteLzma" Type="1025" Source="lzmaextractor.dll" Target="DeleteLZMAFiles"/>
    <ROW Action="AI_DeleteRCadLzma" Type="51" Source="AI_DeleteRLzma" Target="[AI_SETUPEXEPATH]"/>
    <ROW Action="AI_DeleteRLzma" Type="1281" Source="lzmaextractor.dll" Target="DeleteLZMAFiles"/>
    <ROW Action="AI_DpiContentScale" Type="1" Source="aicustact.dll" Target="DpiContentScale"/>
    <ROW Action="AI_EnableDebugLog" Type="321" Source="aicustact.dll" Target="EnableDebugLog"/>
    <ROW Action="AI_EstimateExtractFiles" Type="1" Source="Prereq.dll" Target="EstimateExtractFiles"/>
    <ROW Action="AI_ExtractCadLzma" Type="51" Source="AI_ExtractLzma" Target="[AI_SETUPEXEPATH]"/>
    <ROW Action="AI_ExtractFiles" Type="1025" Source="Prereq.dll" Target="ExtractSourceFiles" AdditionalSeq="AI_DATA_SETTER_6"/>
    <ROW Action="AI_ExtractLzma" Type="1025" Source="lzmaextractor.dll" Target="ExtractLZMAFiles"/>
    <ROW Action="AI_FindExeLzma" Type="1" Source="lzmaextractor.dll" Target="FindEXE"/>
    <ROW Action="AI_InstallModeCheck" Type="1" Source="aicustact.dll" Target="UpdateInstallMode" WithoutSeq="true"/>
    <ROW Action="AI_PREPARE_UPGRADE" Type="65" Source="aicustact.dll" Target="PrepareUpgrade"/>
    <ROW Action="AI_RESTORE_AI_SETUPEXEPATH" Type="51" Source="AI_SETUPEXEPATH" Target="[AI_SETUPEXEPATH_ORIGINAL]"/>
    <ROW Action="AI_RESTORE_LOCATION" Type="65" Source="aicustact.dll" Target="RestoreLocation"/>
    <ROW Action="AI_ResolveKnownFolders" Type="1" Source="aicustact.dll" Target="AI_ResolveKnownFolders"/>
    <ROW Action="AI_SHOW_LOG" Type="65" Source="aicustact.dll" Target="LaunchLogFile" WithoutSeq="true"/>
    <ROW Action="AI_STORE_LOCATION" Type="51" Source="ARPINSTALLLOCATION" Target="[APPDIR]"/>
    <ROW Action="AI_SqlConfig" Type="9217" Source="sql.dll" Target="OnSqlConfig" WithoutSeq="true"/>
    <ROW Action="AI_SqlInstall" Type="1" Source="sql.dll" Target="OnSqlInstall" AdditionalSeq="AI_DATA_SETTER_4"/>
    <ROW Action="AI_SqlMaint" Type="9217" Source="sql.dll" Target="OnSqlMaint" WithoutSeq="true"/>
    <ROW Action="AI_SqlRemove" Type="9217" Source="sql.dll" Target="OnSqlRemove" WithoutSeq="true"/>
    <ROW Action="AI_SqlRollback" Type="9473" Source="sql.dll" Target="OnSqlRollback" WithoutSeq="true"/>
    <ROW Action="AI_SqlUninstall" Type="1" Source="sql.dll" Target="OnSqlUninstall" AdditionalSeq="AI_DATA_SETTER_5"/>
    <ROW Action="AI_XmlCommit" Type="11777" Source="xmlCfg.dll" Target="OnXmlCommit" WithoutSeq="true"/>
    <ROW Action="AI_XmlConfig" Type="11265" Source="xmlCfg.dll" Target="OnXmlConfig" WithoutSeq="true"/>
    <ROW Action="AI_XmlInstall" Type="1" Source="xmlCfg.dll" Target="OnXmlInstall" AdditionalSeq="AI_DATA_SETTER"/>
    <ROW Action="AI_XmlRemove" Type="11265" Source="xmlCfg.dll" Target="OnXmlRemove" WithoutSeq="true"/>
    <ROW Action="AI_XmlRollback" Type="11521" Source="xmlCfg.dll" Target="OnXmlRollback" WithoutSeq="true"/>
    <ROW Action="AI_XmlUninstall" Type="1" Source="xmlCfg.dll" Target="OnXmlUninstall" AdditionalSeq="AI_DATA_SETTER_1"/>
    <ROW Action="BrowseSqlServers" Type="1" Source="sql.dll" Target="BrowseSqlServers" WithoutSeq="true" AdditionalSeq="AI_DATA_SETTER_2"/>
    <ROW Action="CheckFTPAction" Type="1" Source="CheckFTPAction.CA.dll" Target="CustomAction1" WithoutSeq="true"/>
    <ROW Action="CopyToFTPAction" Type="65" Source="CopyToFTPAction.CA.dll" Target="CustomAction1"/>
    <ROW Action="CreateSettingsFile" Type="65" Source="CreateSettingsFile.CA.dll" Target="CustomAction1"/>
    <ROW Action="Lunch1CProc" Type="65" Source="Lunch1CProc.CA.dll" Target="CustomAction1"/>
    <ROW Action="SET_APPDIR" Type="307" Source="APPDIR" Target="[ProgramFilesFolder][Manufacturer]\[ProductName]" MultiBuildTarget="DefaultBuild:[ProgramFilesFolder]\[ProductName]"/>
    <ROW Action="SET_SHORTCUTDIR" Type="307" Source="SHORTCUTDIR" Target="[ProgramMenuFolder][ProductName]"/>
    <ROW Action="SET_TARGETDIR_TO_APPDIR" Type="51" Source="TARGETDIR" Target="[APPDIR]"/>
    <ROW Action="ShowDatabases" Type="1" Source="sql.dll" Target="ShowDatabases" WithoutSeq="true" AdditionalSeq="AI_DATA_SETTER_3"/>
    <ROW Action="TestODBCConnection" Type="1" Source="sql.dll" Target="TestSqlConnection" WithoutSeq="true"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.MsiDialogComponent">
    <ROW Dialog="FtpConnectionDialog" HCentering="50" VCentering="50" Width="370" Height="270" Attributes="3" Title="[ProductName] [Setup]" Control_Default="Next" Control_Cancel="Cancel"/>
    <ROW Dialog="OdinAssConnectionDialog" HCentering="50" VCentering="50" Width="370" Height="270" Attributes="3" Title="[ProductName] [Setup]" Control_Default="Next" Control_Cancel="Cancel"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.MsiInstExSeqComponent">
    <ROW Action="AI_DOWNGRADE" Condition="AI_NEWERPRODUCTFOUND AND (UILevel &lt;&gt; 5)" Sequence="210"/>
    <ROW Action="AI_RESTORE_LOCATION" Condition="APPDIR=&quot;&quot;" Sequence="749"/>
    <ROW Action="AI_STORE_LOCATION" Condition="(Not Installed) OR REINSTALL" Sequence="1501"/>
    <ROW Action="AI_PREPARE_UPGRADE" Condition="AI_UPGRADE=&quot;No&quot; AND (Not Installed)" Sequence="1399"/>
    <ROW Action="AI_ResolveKnownFolders" Sequence="52"/>
    <ROW Action="AI_EnableDebugLog" Sequence="51"/>
    <ROW Action="AI_XmlInstall" Condition="(REMOVE &lt;&gt; &quot;ALL&quot;)" Sequence="5102"/>
    <ROW Action="AI_DATA_SETTER" Condition="(REMOVE &lt;&gt; &quot;ALL&quot;)" Sequence="5101"/>
    <ROW Action="AI_XmlUninstall" Condition="(REMOVE)" Sequence="3102"/>
    <ROW Action="AI_DATA_SETTER_1" Condition="(REMOVE)" Sequence="3101"/>
    <ROW Action="AI_AppSearchEx" Sequence="102"/>
    <ROW Action="AI_SqlInstall" Condition="(VersionNT &gt;= 500) AND (REMOVE &lt;&gt; &quot;ALL&quot;)" Sequence="5502"/>
    <ROW Action="AI_DATA_SETTER_4" Condition="(VersionNT &gt;= 500) AND (REMOVE &lt;&gt; &quot;ALL&quot;)" Sequence="5501"/>
    <ROW Action="AI_SqlUninstall" Condition="(VersionNT &gt;= 500) AND (REMOVE=&quot;ALL&quot;)" Sequence="1702"/>
    <ROW Action="AI_DATA_SETTER_5" Condition="(VersionNT &gt;= 500) AND (REMOVE=&quot;ALL&quot;)" Sequence="1701"/>
    <ROW Action="AI_AiRemoveFilesRollback" Sequence="3099"/>
    <ROW Action="AI_BACKUP_AI_SETUPEXEPATH" Sequence="99" Builds="DefaultBuild"/>
    <ROW Action="CreateSettingsFile" Condition="( NOT Installed )" Sequence="6601"/>
    <ROW Action="Lunch1CProc" Condition="( NOT Installed ) AND ( ONLY_MONITOR = &quot;0&quot; )" Sequence="6602"/>
    <ROW Action="CopyToFTPAction" Condition="( NOT Installed ) AND ( ONLY_MONITOR = &quot;0&quot; )" Sequence="6603"/>
    <ROW Action="AI_RESTORE_AI_SETUPEXEPATH" Condition="AI_SETUPEXEPATH_ORIGINAL" Sequence="101" Builds="DefaultBuild"/>
    <ROW Action="AI_DeleteCadLzma" Condition="SETUPEXEDIR=&quot;&quot; AND Installed AND (REMOVE&lt;&gt;&quot;ALL&quot;) AND (AI_INSTALL_MODE&lt;&gt;&quot;Remove&quot;) AND (NOT PATCH)" Sequence="199" Builds="DefaultBuild"/>
    <ROW Action="AI_DeleteRCadLzma" Condition="SETUPEXEDIR=&quot;&quot; AND Installed AND (REMOVE&lt;&gt;&quot;ALL&quot;) AND (AI_INSTALL_MODE&lt;&gt;&quot;Remove&quot;) AND (NOT PATCH)" Sequence="198" Builds="DefaultBuild"/>
    <ROW Action="AI_ExtractCadLzma" Condition="SETUPEXEDIR=&quot;&quot; AND Installed AND (REMOVE&lt;&gt;&quot;ALL&quot;) AND (AI_INSTALL_MODE&lt;&gt;&quot;Remove&quot;) AND (NOT PATCH)" Sequence="197" Builds="DefaultBuild"/>
    <ROW Action="AI_FindExeLzma" Condition="SETUPEXEDIR=&quot;&quot; AND Installed AND (REMOVE&lt;&gt;&quot;ALL&quot;) AND (AI_INSTALL_MODE&lt;&gt;&quot;Remove&quot;) AND (NOT PATCH)" Sequence="196" Builds="DefaultBuild"/>
    <ROW Action="AI_ExtractLzma" Condition="SETUPEXEDIR=&quot;&quot; AND Installed AND (REMOVE&lt;&gt;&quot;ALL&quot;) AND (AI_INSTALL_MODE&lt;&gt;&quot;Remove&quot;) AND (NOT PATCH)" Sequence="1549" Builds="DefaultBuild"/>
    <ROW Action="AI_DeleteRLzma" Condition="SETUPEXEDIR=&quot;&quot; AND Installed AND (REMOVE&lt;&gt;&quot;ALL&quot;) AND (AI_INSTALL_MODE&lt;&gt;&quot;Remove&quot;) AND (NOT PATCH)" Sequence="1548" Builds="DefaultBuild"/>
    <ROW Action="AI_DeleteLzma" Condition="SETUPEXEDIR=&quot;&quot; AND Installed AND (REMOVE&lt;&gt;&quot;ALL&quot;) AND (AI_INSTALL_MODE&lt;&gt;&quot;Remove&quot;) AND (NOT PATCH)" Sequence="6599" Builds="DefaultBuild"/>
    <ROW Action="AI_ExtractFiles" Sequence="3998" Builds="DefaultBuild"/>
    <ROW Action="AI_DATA_SETTER_6" Sequence="3997"/>
    <ROW Action="AI_EstimateExtractFiles" Sequence="3999" Builds="DefaultBuild"/>
    <ROW Action="AI_AiRemoveFilesImmediate" Sequence="3499"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.MsiInstallUISequenceComponent">
    <ROW Action="AI_RESTORE_LOCATION" Condition="APPDIR=&quot;&quot;" Sequence="749"/>
    <ROW Action="AI_ResolveKnownFolders" Sequence="53"/>
    <ROW Action="AI_DpiContentScale" Sequence="52"/>
    <ROW Action="AI_EnableDebugLog" Sequence="51"/>
    <ROW Action="AI_AppSearchEx" Sequence="102"/>
    <ROW Action="AI_BACKUP_AI_SETUPEXEPATH" Sequence="99"/>
    <ROW Action="AI_RESTORE_AI_SETUPEXEPATH" Condition="AI_SETUPEXEPATH_ORIGINAL" Sequence="101"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.MsiLaunchConditionsComponent">
    <ROW Condition="( Version9X OR ( NOT VersionNT64 ) OR ( VersionNT64 AND ((VersionNT64 &lt;&gt; 502) OR (ServicePackLevel &lt;&gt; 2) OR (MsiNTProductType &lt;&gt; 1)) AND ((VersionNT64 &lt;&gt; 502) OR (ServicePackLevel &lt;&gt; 2) OR (MsiNTProductType = 1)) AND ((VersionNT64 &lt;&gt; 600) OR (ServicePackLevel &lt;&gt; 0) OR (MsiNTProductType &lt;&gt; 1)) AND ((VersionNT64 &lt;&gt; 600) OR (ServicePackLevel &lt;&gt; 1) OR (MsiNTProductType &lt;&gt; 1)) AND ((VersionNT64 &lt;&gt; 600) OR (ServicePackLevel &lt;&gt; 2) OR (MsiNTProductType &lt;&gt; 1)) ) )" Description="[ProductName] не может быть установлен в следующих версиях Windows: [WindowsTypeNT64Display]." DescriptionLocId="AI.LaunchCondition.NoSpecificNT64" IsPredefined="true" Builds="DefaultBuild"/>
    <ROW Condition="( Version9X OR VersionNT64 OR ( VersionNT AND ((VersionNT &lt;&gt; 501) OR (ServicePackLevel &lt;&gt; 3)) AND ((VersionNT &lt;&gt; 502) OR (ServicePackLevel &lt;&gt; 2)) AND ((VersionNT &lt;&gt; 600) OR (ServicePackLevel &lt;&gt; 0) OR (MsiNTProductType &lt;&gt; 1)) AND ((VersionNT &lt;&gt; 600) OR (ServicePackLevel &lt;&gt; 1) OR (MsiNTProductType &lt;&gt; 1)) AND ((VersionNT &lt;&gt; 600) OR (ServicePackLevel &lt;&gt; 2) OR (MsiNTProductType &lt;&gt; 1)) ) )" Description="[ProductName] не может быть установлен в следующих версиях Windows: [WindowsTypeNTDisplay]." DescriptionLocId="AI.LaunchCondition.NoSpecificNT" IsPredefined="true" Builds="DefaultBuild"/>
    <ROW Condition="(VersionNT &lt;&gt; 400)" Description="[ProductName] невозможно установить на [WindowsTypeNT40Display]." DescriptionLocId="AI.LaunchCondition.NoNT40" IsPredefined="true" Builds="DefaultBuild"/>
    <ROW Condition="(VersionNT &lt;&gt; 500)" Description="[ProductName] невозможно установить на [WindowsTypeNT50Display]." DescriptionLocId="AI.LaunchCondition.NoNT50" IsPredefined="true" Builds="DefaultBuild"/>
    <ROW Condition="(VersionNT64 OR ((VersionNT &lt;&gt; 501) OR (ServicePackLevel = 3))) AND ((VersionNT &lt;&gt; 502) OR (ServicePackLevel = 2))" Description="[ProductName] невозможно установить на [WindowsTypeNT5XDisplay]." DescriptionLocId="AI.LaunchCondition.NoNT5X" IsPredefined="true" Builds="DefaultBuild"/>
    <ROW Condition="SETUPEXEDIR OR (REMOVE=&quot;ALL&quot;)" Description="Этот пакет можно запускать только из загрузчика." DescriptionLocId="AI.LaunchCondition.RequireBootstrapper" IsPredefined="true" Builds="DefaultBuild"/>
    <ROW Condition="VersionNT" Description="[ProductName] невозможно установить на [WindowsType9XDisplay]." DescriptionLocId="AI.LaunchCondition.No9X" IsPredefined="true" Builds="DefaultBuild"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.MsiRegLocatorComponent">
    <ROW Signature_="AI_EXE_PATH_CU" Root="1" Key="Software\Caphyon\Advanced Installer\LZMA\[ProductCode]\[ProductVersion]" Name="AI_ExePath" Type="2"/>
    <ROW Signature_="AI_EXE_PATH_LM" Root="2" Key="Software\Caphyon\Advanced Installer\LZMA\[ProductCode]\[ProductVersion]" Name="AI_ExePath" Type="2"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.MsiRegsComponent">
    <ROW Registry="AI_ExePath" Root="-1" Key="Software\Caphyon\Advanced Installer\LZMA\[ProductCode]\[ProductVersion]" Name="AI_ExePath" Value="[AI_SETUPEXEPATH]" Component_="AI_ExePath"/>
    <ROW Registry="Path" Root="-1" Key="Software\[Manufacturer]\[ProductName]" Name="Path" Value="[APPDIR]" Component_="ProductInformation"/>
    <ROW Registry="Version" Root="-1" Key="Software\[Manufacturer]\[ProductName]" Name="Version" Value="[ProductVersion]" Component_="ProductInformation"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.MsiRemoveFileComponent">
    <ROW FileKey="_" Component_="FileDynamicUpdate1CPlugin.dll_2" DirProperty="APPDIR" InstallMode="2"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.MsiShortsComponent">
    <ROW Shortcut="MagicUpdater" Directory_="SHORTCUTDIR" Name="MAGICU~1|Magic Updater" Component_="MagicUpdaterMonitor.exe" Target="[#MagicUpdaterMonitor.exe]" Hotkey="0" IconIndex="0" ShowCmd="1" WkDir="APPDIR"/>
    <ROW Shortcut="MagicUpdater_1" Directory_="MagicUpdater_Dir" Name="MAGICU~1|Magic Updater" Component_="MagicUpdaterMonitor.exe" Target="[#MagicUpdaterMonitor.exe]" Hotkey="0" IconIndex="0" ShowCmd="1" WkDir="APPDIR"/>
    <ROW Shortcut="MagicUpdater_2" Directory_="DesktopFolder" Name="MAGICU~1|Magic Updater" Component_="MagicUpdaterMonitor.exe" Target="[#MagicUpdaterMonitor.exe]" Hotkey="0" IconIndex="0" ShowCmd="1" WkDir="APPDIR"/>
    <ROW Shortcut="_" Directory_="MagicUpdater_Dir" Name="УСТАНО~1|Установщик агента" Component_="FileDynamicUpdate1CPlugin.dll_2" Target="[ServiceInstaller_Dir]" Hotkey="0" IconIndex="0" ShowCmd="1"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.MsiThemeComponent">
    <ATTRIBUTE name="UsedTheme" value="classic"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.MsiUpgradeComponent">
    <ROW UpgradeCode="[|UpgradeCode]" VersionMin="0.0.1" VersionMax="[|ProductVersion]" Attributes="257" ActionProperty="OLDPRODUCTS"/>
    <ROW UpgradeCode="[|UpgradeCode]" VersionMin="[|ProductVersion]" Attributes="2" ActionProperty="AI_NEWERPRODUCTFOUND"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.PreReqComponent">
    <ROW PrereqKey="FB44691010D74C6D89B33E019630EAF6" DisplayName=".NET Framework 4.5" SetupFileUrl="Prerequisites\.NET Framework 4.5\dotnetfx45_full_x86_x64.exe" Location="0" ExactSize="0" WinNTVersions="Windows XP x86 Service Pack 3, Windows Server 2003 x86 Service Pack 2, Windows 8 x86, Windows 8.1 x86, Windows 10 x86" WinNT64Versions="Windows XP x64 Service Pack 2, Windows Server 2003 x64 Service Pack 2, Windows 8 x64, Windows Server 2012 x64, Windows 8.1 x64, Windows Server 2012 R2 x64, Windows 10 x64, Windows Server 2016 x64" Operator="1" NoUiComLine="/q /norestart" Options="xy" TargetName=".NET Framework 4.5\dotnetfx45_full_x86_x64.exe"/>
    <ATTRIBUTE name="PrereqsOrder" value="FB44691010D74C6D89B33E019630EAF6"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.PreReqSearchComponent">
    <ROW SearchKey="FB44691010D74C6D89B33E019630EAF6Release" Prereq="FB44691010D74C6D89B33E019630EAF6" SearchType="9" SearchString="HKLM\SOFTWARE\Microsoft\NET Framework Setup\NDP\v4\Full\Release" RefContent="G378388" Order="1" Property="PreReqSearch_FB44691010D74C6D89B33E019630EAF6"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.SqlBrowseComponent">
    <ROW BrowseName="DlgDatabaseBrowse" Flags="1082408" TimeOut="60" ComboBoxProp="DATABASE_PROP" OutputProp="SqlServerDatabases" ServerName="[SERVER_PROP]" UserName="[USERNAME_PROP]" Password="[PASSWORD_PROP]"/>
    <ROW BrowseName="DlgServerBrowse" Flags="101482" TimeOut="60" ComboBoxProp="SERVER_PROP" OutputProp="SqlServerBrowseOutput"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.SqlConnectionComponent">
    <ROW ConnectionName="DlgPredefinedConnection" Condition="1" Dbms="0" OdbcResource="SQL Server" Server="[SERVER_PROP]" Port="1433" Database="[DATABASE_PROP]" Username="[USERNAME_PROP]" PassProperty="PASSWORD_PROP" Flags="6" Order="0" LoginTimeout="60"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.SqlReplaceComponent">
    <ROW ScriptName="GlobalSettings" Token="#BASE1C" Replacement="[BASE1C_PROP]" Flags="1"/>
    <ROW ScriptName="GlobalSettings" Token="#FTPCATALOG" Replacement="[FTPCATALOG_PROP]" Flags="1"/>
    <ROW ScriptName="GlobalSettings" Token="#FTPLOGIN" Replacement="[FTPLOGIN_PROP]" Flags="1"/>
    <ROW ScriptName="GlobalSettings" Token="#FTPPASSWORD" Replacement="[FTPPASSWORD_PROP]" Flags="1"/>
    <ROW ScriptName="GlobalSettings" Token="#FTPSERVER" Replacement="[FTPSERVER_PROP]" Flags="1"/>
    <ROW ScriptName="GlobalSettings" Token="#FTPTMPCATALOG" Replacement="[FTPTMPCATALOG_PROP]" Flags="1"/>
    <ROW ScriptName="GlobalSettings" Token="#PASSWORD1C" Replacement="[PASSWORD1C_PROP]" Flags="1"/>
    <ROW ScriptName="GlobalSettings" Token="#PLATFORM1C" Replacement="[PLATFORM1C_PROP]" Flags="1"/>
    <ROW ScriptName="GlobalSettings" Token="#SERVER1C" Replacement="[SERVER1C_PROP]" Flags="1"/>
    <ROW ScriptName="GlobalSettings" Token="#USER1C" Replacement="[USER1C_PROP]" Flags="1"/>
    <ROW ScriptName="CreateDatabase" Token="[MagicUpdater]" Replacement="[DATABASE_PROP]" Flags="0"/>
    <ROW ScriptName="AddData" Token="[MagicUpdater]" Replacement="[DATABASE_PROP]" Flags="0"/>
    <ROW ScriptName="GlobalSettings" Token="[MagicUpdater]" Replacement="[DATABASE_PROP]" Flags="0"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.SqlScriptComponent">
    <ROW ScriptName="AddData" ConnectionName="DlgPredefinedConnection" Condition="ONLY_MONITOR = &quot;0&quot;" Separator="GO" ScriptInline="-- Inline SQL script&#13;&#10;-- Inline SQL script&#13;&#10;USE [MagicUpdater]&#13;&#10;GO&#13;&#10;INSERT [dbo].[LocalSettingsDictionary] ([SettingId], [Name], [Description]) VALUES (3, N&apos;Server1C&apos;, N&apos;Сервер 1С&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[LocalSettingsDictionary] ([SettingId], [Name], [Description]) VALUES (4, N&apos;Base1C&apos;, N&apos;База 1С&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[LocalSettingsDictionary] ([SettingId], [Name], [Description]) VALUES (5, N&apos;User1C&apos;, N&apos;Пользователь 1С&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[LocalSettingsDictionary] ([SettingId], [Name], [Description]) VALUES (6, N&apos;Pass1C&apos;, N&apos;Пароль 1С&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[LocalSettingsDictionary] ([SettingId], [Name], [Description]) VALUES (7, N&apos;OperationsListCheckTimeout&apos;, N&apos;Интервал опроса операций из базы заданий&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[LocalSettingsDictionary] ([SettingId], [Name], [Description]) VALUES (8, N&apos;SelfUpdatePath&apos;, N&apos;Локальный путь самообновления&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[LocalSettingsDictionary] ([SettingId], [Name], [Description]) VALUES (9, N&apos;Version1C&apos;, N&apos;Версия 1С&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[LocalSettingsDictionary] ([SettingId], [Name], [Description]) VALUES (10, N&apos;IsCheck1C&apos;, N&apos;Проверка установки 1С&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[LocalSettingsDictionary] ([SettingId], [Name], [Description]) VALUES (11, N&apos;SelfUpdateFtpServer&apos;, N&apos;Сервер Ftp для самообновления&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[LocalSettingsDictionary] ([SettingId], [Name], [Description]) VALUES (12, N&apos;SelfUpdateFtpUser&apos;, N&apos;Логин сервера Ftp для самообновления&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[LocalSettingsDictionary] ([SettingId], [Name], [Description]) VALUES (13, N&apos;SelfUpdateFtpPassword&apos;, N&apos;Пароль сервера Ftp для самообновления&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[LocalSettingsDictionary] ([SettingId], [Name], [Description]) VALUES (14, N&apos;SelfUpdateFtpPath&apos;, N&apos;Путь до папки Ftp для самообновления&apos;)&#13;&#10;GO&#13;&#10;SET IDENTITY_INSERT [dbo].[OperationGroups] ON &#13;&#10;GO&#13;&#10;INSERT [dbo].[OperationGroups] ([Id], [Name], [Description]) VALUES (1, N&apos;Стандартные&apos;, N&apos;Стандартные операции&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[OperationGroups] ([Id], [Name], [Description]) VALUES (2, N&apos;Служебные&apos;, N&apos;Операции для более опытных спецов, такие как вынужденный перезапуск агента и т.д.&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[OperationGroups] ([Id], [Name], [Description]) VALUES (3, N&apos;Тестовые&apos;, N&apos;Тестовые операции&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[OperationGroups] ([Id], [Name], [Description]) VALUES (10, N&apos;Избранные&apos;, N&apos;Избранные&apos;)&#13;&#10;GO&#13;&#10;SET IDENTITY_INSERT [dbo].[OperationGroups] OFF&#13;&#10;GO&#13;&#10;INSERT [dbo].[OperationStatesVoc] ([Id], [Name], [Description]) VALUES (1, N&apos;Begin&apos;, N&apos;Запущена&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[OperationStatesVoc] ([Id], [Name], [Description]) VALUES (2, N&apos;End&apos;, N&apos;Завершена&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[OperationStatesVoc] ([Id], [Name], [Description]) VALUES (3, N&apos;WaitingForUserConfirmation&apos;, N&apos;Ожидание подтверждения от пользователя&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[OperationStatesVoc] ([Id], [Name], [Description]) VALUES (4, N&apos;Interrupted&apos;, N&apos;Прервана&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[OperationStatesVoc] ([Id], [Name], [Description]) VALUES (5, N&apos;Runs&apos;, N&apos;Выполняется&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[OperationStatesVoc] ([Id], [Name], [Description]) VALUES (6, N&apos;ConfirmedByUser&apos;, N&apos;Подтверждена пользователем&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[OperationStatesVoc] ([Id], [Name], [Description]) VALUES (7, N&apos;CancelledByUser&apos;, N&apos;Отклонена пользователем&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[OperationStatesVoc] ([Id], [Name], [Description]) VALUES (8, N&apos;CancelledByTimer&apos;, N&apos;Отклонена по таймеру&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[OperationStatesVoc] ([Id], [Name], [Description]) VALUES (9, N&apos;EndWithError&apos;, N&apos;Завершена с ошибкой&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[ShedulerStatuses] ([Id], [Name], [NameRus]) VALUES (0, N&apos;New&apos;, N&apos;Новый&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[ShedulerStatuses] ([Id], [Name], [NameRus]) VALUES (1, N&apos;Running&apos;, N&apos;Выполняется&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[ShedulerStatuses] ([Id], [Name], [NameRus]) VALUES (2, N&apos;Competed&apos;, N&apos;Завершен успешно&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[ShedulerStatuses] ([Id], [Name], [NameRus]) VALUES (3, N&apos;CompletedWithErrors&apos;, N&apos;Завершен с ошибкой&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[ShedulerStatuses] ([Id], [Name], [NameRus]) VALUES (4, N&apos;Stoped&apos;, N&apos;Остановлен&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[ShedulerTaskModes] ([Id], [Name], [NameRus]) VALUES (0, N&apos;Once&apos;, N&apos;Один раз&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[ShedulerTaskModes] ([Id], [Name], [NameRus]) VALUES (1, N&apos;Daily&apos;, N&apos;Каждый день&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[ShedulerTaskModes] ([Id], [Name], [NameRus]) VALUES (2, N&apos;Weekly&apos;, N&apos;Каждую неделю&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[ShedulerTaskModes] ([Id], [Name], [NameRus]) VALUES (3, N&apos;Monthly&apos;, N&apos;Каждый месяц&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[ShedulerTaskModes] ([Id], [Name], [NameRus]) VALUES (4, N&apos;Hours&apos;, N&apos;После кол-ва часов&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[ShedulerTaskModes] ([Id], [Name], [NameRus]) VALUES (5, N&apos;Minutes&apos;, N&apos;После кол-ва минут&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[OperationTypes] ([Id], [Name], [SavedAttributes], [NameRus], [GroupId], [FileName], [LastModifiedDate], [FileMD5], [Description], [GUID], [Visible]) VALUES (1, N&apos;SelfUpdate&apos;, NULL, N&apos;Обновить агента&apos;, 2, NULL, NULL, NULL, NULL, NULL, 1)&#13;&#10;GO&#13;&#10;INSERT [dbo].[OperationTypes] ([Id], [Name], [SavedAttributes], [NameRus], [GroupId], [FileName], [LastModifiedDate], [FileMD5], [Description], [GUID], [Visible]) VALUES (1002, N&apos;SetExternalIp_Service&apos;, NULL, N&apos;Получить внешний IP агента&apos;, 2, NULL, NULL, NULL, NULL, NULL, 1)&#13;&#10;GO&#13;&#10;INSERT [dbo].[OperationTypes] ([Id], [Name], [SavedAttributes], [NameRus], [GroupId], [FileName], [LastModifiedDate], [FileMD5], [Description], [GUID], [Visible]) VALUES (1003, N&apos;RestartMagicUpdater_Service&apos;, NULL, N&apos;Перезапустить Агента&apos;, 2, NULL, NULL, NULL, NULL, NULL, 1)&#13;&#10;GO&#13;&#10;&#13;&#10;GO&#13;&#10;&#13;&#10;&#13;&#10;" Flags="290" Order="1"/>
    <ROW ScriptName="CreateDatabase" ConnectionName="DlgPredefinedConnection" Condition="ONLY_MONITOR = &quot;0&quot;" Separator="GO" ScriptInline="ALTER DATABASE [MagicUpdater] SET COMPATIBILITY_LEVEL = 100&#13;&#10;GO&#13;&#10;ALTER DATABASE [MagicUpdater]  &#13;&#10;COLLATE SQL_Latin1_General_CP1251_CI_AS;&#13;&#10;GO&#13;&#10;IF (1 = FULLTEXTSERVICEPROPERTY(&apos;IsFullTextInstalled&apos;))&#13;&#10;begin&#13;&#10;EXEC [MagicUpdater].[dbo].[sp_fulltext_database] @action = &apos;enable&apos;&#13;&#10;end&#13;&#10;GO&#13;&#10;ALTER DATABASE [MagicUpdater] SET ANSI_NULL_DEFAULT OFF &#13;&#10;GO&#13;&#10;ALTER DATABASE [MagicUpdater] SET ANSI_NULLS OFF &#13;&#10;GO&#13;&#10;ALTER DATABASE [MagicUpdater] SET ANSI_PADDING OFF &#13;&#10;GO&#13;&#10;ALTER DATABASE [MagicUpdater] SET ANSI_WARNINGS OFF &#13;&#10;GO&#13;&#10;ALTER DATABASE [MagicUpdater] SET ARITHABORT OFF &#13;&#10;GO&#13;&#10;ALTER DATABASE [MagicUpdater] SET AUTO_CLOSE ON &#13;&#10;GO&#13;&#10;ALTER DATABASE [MagicUpdater] SET AUTO_SHRINK OFF &#13;&#10;GO&#13;&#10;ALTER DATABASE [MagicUpdater] SET AUTO_UPDATE_STATISTICS ON &#13;&#10;GO&#13;&#10;ALTER DATABASE [MagicUpdater] SET CURSOR_CLOSE_ON_COMMIT OFF &#13;&#10;GO&#13;&#10;ALTER DATABASE [MagicUpdater] SET CURSOR_DEFAULT  GLOBAL &#13;&#10;GO&#13;&#10;ALTER DATABASE [MagicUpdater] SET CONCAT_NULL_YIELDS_NULL OFF &#13;&#10;GO&#13;&#10;ALTER DATABASE [MagicUpdater] SET NUMERIC_ROUNDABORT OFF &#13;&#10;GO&#13;&#10;ALTER DATABASE [MagicUpdater] SET QUOTED_IDENTIFIER OFF &#13;&#10;GO&#13;&#10;ALTER DATABASE [MagicUpdater] SET RECURSIVE_TRIGGERS OFF &#13;&#10;GO&#13;&#10;ALTER DATABASE [MagicUpdater] SET  DISABLE_BROKER &#13;&#10;GO&#13;&#10;ALTER DATABASE [MagicUpdater] SET AUTO_UPDATE_STATISTICS_ASYNC OFF &#13;&#10;GO&#13;&#10;ALTER DATABASE [MagicUpdater] SET DATE_CORRELATION_OPTIMIZATION OFF &#13;&#10;GO&#13;&#10;ALTER DATABASE [MagicUpdater] SET TRUSTWORTHY OFF &#13;&#10;GO&#13;&#10;ALTER DATABASE [MagicUpdater] SET ALLOW_SNAPSHOT_ISOLATION OFF &#13;&#10;GO&#13;&#10;ALTER DATABASE [MagicUpdater] SET PARAMETERIZATION SIMPLE &#13;&#10;GO&#13;&#10;ALTER DATABASE [MagicUpdater] SET READ_COMMITTED_SNAPSHOT OFF &#13;&#10;GO&#13;&#10;ALTER DATABASE [MagicUpdater] SET HONOR_BROKER_PRIORITY OFF &#13;&#10;GO&#13;&#10;ALTER DATABASE [MagicUpdater] SET RECOVERY SIMPLE &#13;&#10;GO&#13;&#10;ALTER DATABASE [MagicUpdater] SET  MULTI_USER &#13;&#10;GO&#13;&#10;ALTER DATABASE [MagicUpdater] SET PAGE_VERIFY CHECKSUM  &#13;&#10;GO&#13;&#10;ALTER DATABASE [MagicUpdater] SET DB_CHAINING OFF &#13;&#10;GO&#13;&#10;ALTER DATABASE [MagicUpdater] SET FILESTREAM( NON_TRANSACTED_ACCESS = OFF ) &#13;&#10;GO&#13;&#10;ALTER DATABASE [MagicUpdater] SET TARGET_RECOVERY_TIME = 0 SECONDS &#13;&#10;GO&#13;&#10;ALTER DATABASE [MagicUpdater] SET DELAYED_DURABILITY = DISABLED &#13;&#10;GO&#13;&#10;USE [MagicUpdater]&#13;&#10;GO&#13;&#10;/****** Object:  Table [dbo].[ActionsReports]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE TABLE [dbo].[ActionsReports](&#13;&#10;&#9;[ReportId] [int] IDENTITY(1,1) NOT NULL,&#13;&#10;&#9;[OperationId] [int] NOT NULL,&#13;&#10;&#9;[ComputerId] [int] NOT NULL,&#13;&#10;&#9;[ActionName] [nvarchar](100) NOT NULL,&#13;&#10;&#9;[IsFromLan] [bit] NOT NULL,&#13;&#10;&#9;[IsCompleted] [bit] NOT NULL,&#13;&#10;&#9;[DateCompleteOrError] [datetime] NOT NULL,&#13;&#10;&#9;[Result] [nvarchar](max) NULL,&#13;&#10; CONSTRAINT [PK_ActionsReports] PRIMARY KEY CLUSTERED &#13;&#10;(&#13;&#10;&#9;[ReportId] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  Table [dbo].[CommonGlobalSettings]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE TABLE [dbo].[CommonGlobalSettings](&#13;&#10;&#9;[Id] [int] IDENTITY(1,1) NOT NULL,&#13;&#10;&#9;[Name] [nvarchar](256) NOT NULL,&#13;&#10;&#9;[Value] [nvarchar](1000) NOT NULL,&#13;&#10;&#9;[Description] [nvarchar](1000) NOT NULL,&#13;&#10; CONSTRAINT [PK_CommonGlobalSettings] PRIMARY KEY CLUSTERED &#13;&#10;(&#13;&#10;&#9;[Id] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;) ON [PRIMARY]&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  Table [dbo].[ComputerErrorsLog]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE TABLE [dbo].[ComputerErrorsLog](&#13;&#10;&#9;[ErrorId] [int] IDENTITY(1,1) NOT NULL,&#13;&#10;&#9;[ComputerId] [int] NOT NULL,&#13;&#10;&#9;[ErrorMessage] [nvarchar](max) NULL,&#13;&#10;&#9;[ErrorDate] [datetime] NOT NULL,&#13;&#10; CONSTRAINT [PK_ComputerErrorsLog] PRIMARY KEY CLUSTERED &#13;&#10;(&#13;&#10;&#9;[ErrorId] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  Table [dbo].[LocalSettings]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE TABLE [dbo].[LocalSettings](&#13;&#10;&#9;[ComputerId] [int] NOT NULL,&#13;&#10;&#9;[SettingId] [int] NOT NULL,&#13;&#10;&#9;[Value] [nvarchar](1000) NOT NULL,&#13;&#10; CONSTRAINT [PK_LocalSettings] PRIMARY KEY CLUSTERED &#13;&#10;(&#13;&#10;&#9;[ComputerId] ASC,&#13;&#10;&#9;[SettingId] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;) ON [PRIMARY]&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  Table [dbo].[LocalSettingsDictionary]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE TABLE [dbo].[LocalSettingsDictionary](&#13;&#10;&#9;[SettingId] [int] NOT NULL,&#13;&#10;&#9;[Name] [nvarchar](256) NOT NULL,&#13;&#10;&#9;[Description] [nvarchar](1000) NULL,&#13;&#10; CONSTRAINT [PK_LocalSettingsDictionary] PRIMARY KEY CLUSTERED &#13;&#10;(&#13;&#10;&#9;[SettingId] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;) ON [PRIMARY]&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  Table [dbo].[Logs1C]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE TABLE [dbo].[Logs1C](&#13;&#10;&#9;[Id] [int] IDENTITY(1,1) NOT NULL,&#13;&#10;&#9;[ComputerId] [int] NOT NULL,&#13;&#10;&#9;[OperationId] [int] NULL,&#13;&#10;&#9;[IsError] [bit] NULL,&#13;&#10;&#9;[LogMessage] [nvarchar](max) NULL,&#13;&#10;&#9;[LogDate] [datetime] NOT NULL,&#13;&#10; CONSTRAINT [PK_Logs1C] PRIMARY KEY CLUSTERED &#13;&#10;(&#13;&#10;&#9;[Id] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  Table [dbo].[OperationGroups]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE TABLE [dbo].[OperationGroups](&#13;&#10;&#9;[Id] [int] IDENTITY(1,1) NOT NULL,&#13;&#10;&#9;[Name] [nvarchar](256) NOT NULL,&#13;&#10;&#9;[Description] [nvarchar](max) NULL,&#13;&#10; CONSTRAINT [PK_OperationGroups] PRIMARY KEY CLUSTERED &#13;&#10;(&#13;&#10;&#9;[Id] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  Table [dbo].[Operations]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE TABLE [dbo].[Operations](&#13;&#10;&#9;[ID] [int] IDENTITY(1,1) NOT NULL,&#13;&#10;&#9;[ComputerId] [int] NOT NULL,&#13;&#10;&#9;[OperationType] [int] NOT NULL,&#13;&#10;&#9;[Attributes] [nvarchar](max) NULL,&#13;&#10;&#9;[CreationDate] [datetime] NOT NULL,&#13;&#10;&#9;[CreatedUser] [nvarchar](128) NULL,&#13;&#10;&#9;[PoolDate] [datetime] NULL,&#13;&#10;&#9;[GroupGUID] [uniqueidentifier] NULL,&#13;&#10;&#9;[IsFromSheduler] [bit] NULL,&#13;&#10; CONSTRAINT [PK_Operations] PRIMARY KEY CLUSTERED &#13;&#10;(&#13;&#10;&#9;[ID] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  Table [dbo].[OperationsReports]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE TABLE [dbo].[OperationsReports](&#13;&#10;&#9;[ReportId] [int] IDENTITY(1,1) NOT NULL,&#13;&#10;&#9;[OperationId] [int] NOT NULL,&#13;&#10;&#9;[IsRead] [bit] NOT NULL,&#13;&#10;&#9;[IsCompleted] [bit] NOT NULL,&#13;&#10;&#9;[Result] [nvarchar](max) NULL,&#13;&#10;&#9;[DateRead] [datetime] NOT NULL,&#13;&#10;&#9;[DateCompleteOrError] [datetime] NULL,&#13;&#10; CONSTRAINT [PK_OperationsReports] PRIMARY KEY CLUSTERED &#13;&#10;(&#13;&#10;&#9;[OperationId] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  Table [dbo].[OperationsStates]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE TABLE [dbo].[OperationsStates](&#13;&#10;&#9;[Id] [int] IDENTITY(1,1) NOT NULL,&#13;&#10;&#9;[OperationId] [int] NOT NULL,&#13;&#10;&#9;[OperStateId] [int] NOT NULL,&#13;&#10;&#9;[StateDate] [datetime] NOT NULL,&#13;&#10; CONSTRAINT [PK_OperationsStates] PRIMARY KEY CLUSTERED &#13;&#10;(&#13;&#10;&#9;[Id] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;) ON [PRIMARY]&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  Table [dbo].[OperationStatesVoc]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE TABLE [dbo].[OperationStatesVoc](&#13;&#10;&#9;[Id] [int] NOT NULL,&#13;&#10;&#9;[Name] [nvarchar](256) NOT NULL,&#13;&#10;&#9;[Description] [nvarchar](256) NOT NULL,&#13;&#10; CONSTRAINT [PK_OperationStates] PRIMARY KEY CLUSTERED &#13;&#10;(&#13;&#10;&#9;[Id] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;) ON [PRIMARY]&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  Table [dbo].[OperationTypeAttributes]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE TABLE [dbo].[OperationTypeAttributes](&#13;&#10;&#9;[Id] [int] IDENTITY(1,1) NOT NULL,&#13;&#10;&#9;[OperationTypeId] [int] NOT NULL,&#13;&#10;&#9;[UserId] [int] NOT NULL,&#13;&#10;&#9;[Attributes] [nvarchar](max) NULL,&#13;&#10; CONSTRAINT [PK_OperationTypeAttributes] PRIMARY KEY CLUSTERED &#13;&#10;(&#13;&#10;&#9;[Id] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  Table [dbo].[OperationTypes]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE TABLE [dbo].[OperationTypes](&#13;&#10;&#9;[Id] [int] NOT NULL,&#13;&#10;&#9;[Name] [nvarchar](256) NOT NULL,&#13;&#10;&#9;[SavedAttributes] [nvarchar](max) NULL,&#13;&#10;&#9;[NameRus] [nvarchar](256) NULL,&#13;&#10;&#9;[GroupId] [int] NOT NULL,&#13;&#10;&#9;[FileName] [nvarchar](255) NULL,&#13;&#10;&#9;[LastModifiedDate] [datetime] NULL,&#13;&#10;&#9;[FileMD5] [nvarchar](32) NULL,&#13;&#10;&#9;[Description] [nvarchar](max) NULL,&#13;&#10;&#9;[GUID] [uniqueidentifier] NULL,&#13;&#10;&#9;[Visible] [bit] NULL,&#13;&#10; CONSTRAINT [PK_OperationTypes] PRIMARY KEY CLUSTERED &#13;&#10;(&#13;&#10;&#9;[Id] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  Table [dbo].[ShedulerPluginTasks]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE TABLE [dbo].[ShedulerPluginTasks](&#13;&#10;&#9;[Id] [int] IDENTITY(1,1) NOT NULL,&#13;&#10;&#9;[Name] [nvarchar](80) NOT NULL,&#13;&#10;&#9;[Enabled] [bit] NULL,&#13;&#10;&#9;[Mode] [int] NOT NULL,&#13;&#10;&#9;[NextStartTime] [datetime] NOT NULL,&#13;&#10;&#9;[LastStartTime] [datetime] NULL,&#13;&#10;&#9;[LastEndTime] [datetime] NULL,&#13;&#10;&#9;[Status] [int] NOT NULL,&#13;&#10;&#9;[Description] [nvarchar](3000) NULL,&#13;&#10;&#9;[CreationDateUtc] [datetime] NULL,&#13;&#10;&#9;[CreatedUserLogin] [nvarchar](400) NULL,&#13;&#10;&#9;[PluginFileName] [nvarchar](128) NOT NULL,&#13;&#10;&#9;[RepeatValue] [int] NULL,&#13;&#10; CONSTRAINT [PK_ShedulerPluginTasks] PRIMARY KEY CLUSTERED &#13;&#10;(&#13;&#10;&#9;[Id] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;) ON [PRIMARY]&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  Table [dbo].[ShedulerPluginTasksUserHistory]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE TABLE [dbo].[ShedulerPluginTasksUserHistory](&#13;&#10;&#9;[Id] [int] NOT NULL,&#13;&#10;&#9;[Name] [nvarchar](80) NOT NULL,&#13;&#10;&#9;[Enabled] [bit] NULL,&#13;&#10;&#9;[FirstStepId] [int] NULL,&#13;&#10;&#9;[Mode] [int] NOT NULL,&#13;&#10;&#9;[NextStartTime] [datetime] NOT NULL,&#13;&#10;&#9;[LastStartTime] [datetime] NULL,&#13;&#10;&#9;[LastEndTime] [datetime] NULL,&#13;&#10;&#9;[Status] [int] NOT NULL,&#13;&#10;&#9;[HisId] [int] IDENTITY(1,1) NOT NULL,&#13;&#10;&#9;[ChangeUserDateUtc] [datetime] NOT NULL,&#13;&#10;&#9;[UserLogin] [nvarchar](400) NOT NULL,&#13;&#10;&#9;[PluginFileName] [nvarchar](128) NOT NULL,&#13;&#10;&#9;[ActionType] [nvarchar](128) NOT NULL,&#13;&#10; CONSTRAINT [PK_ShedulerPluginTasksUserHistory] PRIMARY KEY CLUSTERED &#13;&#10;(&#13;&#10;&#9;[HisId] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;) ON [PRIMARY]&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  Table [dbo].[ShedulerStatuses]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE TABLE [dbo].[ShedulerStatuses](&#13;&#10;&#9;[Id] [int] NOT NULL,&#13;&#10;&#9;[Name] [nvarchar](256) NOT NULL,&#13;&#10;&#9;[NameRus] [nvarchar](256) NULL,&#13;&#10; CONSTRAINT [PK_ShedulerStatuses] PRIMARY KEY CLUSTERED &#13;&#10;(&#13;&#10;&#9;[Id] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;) ON [PRIMARY]&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  Table [dbo].[ShedulerSteps]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE TABLE [dbo].[ShedulerSteps](&#13;&#10;&#9;[Id] [int] IDENTITY(1,1) NOT NULL,&#13;&#10;&#9;[TaskId] [int] NOT NULL,&#13;&#10;&#9;[OperationType] [int] NOT NULL,&#13;&#10;&#9;[RepeatCount] [int] NULL,&#13;&#10;&#9;[RepeatTimeout] [int] NULL,&#13;&#10;&#9;[OperationCheckIntervalMs] [int] NOT NULL,&#13;&#10;&#9;[OnOperationCompleteStep] [int] NOT NULL,&#13;&#10;&#9;[OnOperationErrorStep] [int] NOT NULL,&#13;&#10;&#9;[OrderId] [int] NOT NULL,&#13;&#10;&#9;[OperationAttributes] [nvarchar](max) NULL,&#13;&#10; CONSTRAINT [PK_ShedulerSteps] PRIMARY KEY CLUSTERED &#13;&#10;(&#13;&#10;&#9;[Id] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  Table [dbo].[ShedulerStepsUserHistory]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE TABLE [dbo].[ShedulerStepsUserHistory](&#13;&#10;&#9;[Id] [int] NOT NULL,&#13;&#10;&#9;[TaskId] [int] NOT NULL,&#13;&#10;&#9;[OperationType] [int] NOT NULL,&#13;&#10;&#9;[RepeatCount] [int] NULL,&#13;&#10;&#9;[RepeatTimeout] [int] NULL,&#13;&#10;&#9;[OperationCheckIntervalMs] [int] NOT NULL,&#13;&#10;&#9;[OnOperationCompleteStep] [int] NOT NULL,&#13;&#10;&#9;[OnOperationErrorStep] [int] NOT NULL,&#13;&#10;&#9;[OrderId] [int] NOT NULL,&#13;&#10;&#9;[HisId] [int] IDENTITY(1,1) NOT NULL,&#13;&#10;&#9;[ChangeUserDateUtc] [datetime] NOT NULL,&#13;&#10;&#9;[UserLogin] [nvarchar](400) NOT NULL,&#13;&#10;&#9;[ActionType] [nvarchar](128) NOT NULL,&#13;&#10; CONSTRAINT [PK_ShedulerStepsUserHistory] PRIMARY KEY CLUSTERED &#13;&#10;(&#13;&#10;&#9;[HisId] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;) ON [PRIMARY]&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  Table [dbo].[ShedulerTaskHistory]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE TABLE [dbo].[ShedulerTaskHistory](&#13;&#10;&#9;[Id] [int] IDENTITY(1,1) NOT NULL,&#13;&#10;&#9;[Date] [datetime] NOT NULL,&#13;&#10;&#9;[TaskId] [int] NOT NULL,&#13;&#10;&#9;[StepId] [int] NOT NULL,&#13;&#10;&#9;[ComputerId] [int] NULL,&#13;&#10;&#9;[IsComplete] [bit] NOT NULL,&#13;&#10;&#9;[Message] [nvarchar](max) NULL,&#13;&#10; CONSTRAINT [PK_ShedulerTaskHistory] PRIMARY KEY CLUSTERED &#13;&#10;(&#13;&#10;&#9;[Id] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  Table [dbo].[ShedulerTaskModes]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE TABLE [dbo].[ShedulerTaskModes](&#13;&#10;&#9;[Id] [int] NOT NULL,&#13;&#10;&#9;[Name] [nvarchar](256) NOT NULL,&#13;&#10;&#9;[NameRus] [nvarchar](256) NULL,&#13;&#10; CONSTRAINT [PK_ShedulerTaskModes] PRIMARY KEY CLUSTERED &#13;&#10;(&#13;&#10;&#9;[Id] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;) ON [PRIMARY]&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  Table [dbo].[ShedulerTasks]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE TABLE [dbo].[ShedulerTasks](&#13;&#10;&#9;[Id] [int] IDENTITY(1,1) NOT NULL,&#13;&#10;&#9;[Name] [nvarchar](80) NOT NULL,&#13;&#10;&#9;[Enabled] [bit] NULL,&#13;&#10;&#9;[FirstStepId] [int] NULL,&#13;&#10;&#9;[Mode] [int] NOT NULL,&#13;&#10;&#9;[StartTime] [datetime] NOT NULL,&#13;&#10;&#9;[NextStartTime] [datetime] NOT NULL,&#13;&#10;&#9;[LastStartTime] [datetime] NULL,&#13;&#10;&#9;[LastEndTime] [datetime] NULL,&#13;&#10;&#9;[Status] [int] NOT NULL,&#13;&#10;&#9;[Description] [nvarchar](3000) NULL,&#13;&#10;&#9;[CreationDateUtc] [datetime] NULL,&#13;&#10;&#9;[CreatedUserLogin] [nvarchar](400) NULL,&#13;&#10;&#9;[RepeatValue] [int] NULL,&#13;&#10; CONSTRAINT [PK_ShedulerTasks] PRIMARY KEY CLUSTERED &#13;&#10;(&#13;&#10;&#9;[Id] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;) ON [PRIMARY]&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  Table [dbo].[ShedulerTasksComputersList]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE TABLE [dbo].[ShedulerTasksComputersList](&#13;&#10;&#9;[TaskId] [int] NOT NULL,&#13;&#10;&#9;[ComputerId] [int] NOT NULL,&#13;&#10; CONSTRAINT [PK_ShedulerTasksComputersList] PRIMARY KEY CLUSTERED &#13;&#10;(&#13;&#10;&#9;[TaskId] ASC,&#13;&#10;&#9;[ComputerId] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;) ON [PRIMARY]&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  Table [dbo].[ShedulerTasksUserHistory]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE TABLE [dbo].[ShedulerTasksUserHistory](&#13;&#10;&#9;[Id] [int] NOT NULL,&#13;&#10;&#9;[Name] [nvarchar](80) NOT NULL,&#13;&#10;&#9;[Enabled] [bit] NULL,&#13;&#10;&#9;[FirstStepId] [int] NULL,&#13;&#10;&#9;[Mode] [int] NOT NULL,&#13;&#10;&#9;[StartTime] [datetime] NOT NULL,&#13;&#10;&#9;[NextStartTime] [datetime] NOT NULL,&#13;&#10;&#9;[LastStartTime] [datetime] NULL,&#13;&#10;&#9;[LastEndTime] [datetime] NULL,&#13;&#10;&#9;[Status] [int] NOT NULL,&#13;&#10;&#9;[HisId] [int] IDENTITY(1,1) NOT NULL,&#13;&#10;&#9;[ChangeUserDateUtc] [datetime] NOT NULL,&#13;&#10;&#9;[UserLogin] [nvarchar](400) NOT NULL,&#13;&#10;&#9;[ComputersList] [varchar](max) NULL,&#13;&#10;&#9;[ActionType] [nvarchar](128) NOT NULL,&#13;&#10; CONSTRAINT [PK_ShedulerTasksUserHistory] PRIMARY KEY CLUSTERED &#13;&#10;(&#13;&#10;&#9;[HisId] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  Table [dbo].[ShopComputers]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE TABLE [dbo].[ShopComputers](&#13;&#10;&#9;[ComputerId] [int] IDENTITY(1,1) NOT NULL,&#13;&#10;&#9;[ShopId] [nvarchar](100) NOT NULL,&#13;&#10;&#9;[ComputerName] [nvarchar](100) NULL,&#13;&#10;&#9;[ComputerAddress] [varchar](50) NULL,&#13;&#10;&#9;[Is1CServer] [bit] NOT NULL,&#13;&#10;&#9;[IsMainCashbox] [bit] NOT NULL,&#13;&#10;&#9;[LastUpdateTime] [datetime] NULL,&#13;&#10;&#9;[ComputerHash] [nvarchar](32) NULL,&#13;&#10;&#9;[Mac] [nvarchar](32) NULL,&#13;&#10;&#9;[MagicUpdaterVersion] [nvarchar](32) NULL,&#13;&#10;&#9;[External_IP] [varchar](50) NULL,&#13;&#10;&#9;[IsTaskerAlive] [bit] NULL,&#13;&#10;&#9;[IsSettingsRead] [bit] NULL,&#13;&#10;&#9;[IsON]  AS (case when dateadd(minute,(1),[LastUpdateTime])&gt;getutcdate() then (1) else (0) end),&#13;&#10;&#9;[LastErrorDate] [datetime] NULL,&#13;&#10;&#9;[LastError] [nvarchar](max) NULL,&#13;&#10;&#9;[IsAgentSettingsReaded] [bit] NULL,&#13;&#10; CONSTRAINT [PK_ShopComputers] PRIMARY KEY CLUSTERED &#13;&#10;(&#13;&#10;&#9;[ComputerId] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  Table [dbo].[Shops]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE TABLE [dbo].[Shops](&#13;&#10;&#9;[ShopId] [nvarchar](100) NOT NULL,&#13;&#10;&#9;[ShopName] [nvarchar](100) NULL,&#13;&#10;&#9;[ShopRegion] [nvarchar](100) NULL,&#13;&#10;&#9;[ExchangeError] [bit] NULL,&#13;&#10;&#9;[LastSuccessfulUpload] [datetime] NULL,&#13;&#10;&#9;[LastSuccessfulReceive] [datetime] NULL,&#13;&#10;&#9;[AddressToConnect] [nvarchar](1024) NULL,&#13;&#10;&#9;[Phone] [nvarchar](128) NULL,&#13;&#10;&#9;[IsClosed] [bit] NULL,&#13;&#10;&#9;[Email] [nvarchar](512) NULL,&#13;&#10;&#9;[VersionConfig1C] [nvarchar](50) NULL,&#13;&#10; CONSTRAINT [PK_Shops] PRIMARY KEY CLUSTERED &#13;&#10;(&#13;&#10;&#9;[ShopId] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;) ON [PRIMARY]&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  Table [dbo].[Users]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE TABLE [dbo].[Users](&#13;&#10;&#9;[Id] [int] IDENTITY(1,1) NOT NULL,&#13;&#10;&#9;[UserLogin] [nvarchar](400) NOT NULL,&#13;&#10;&#9;[UserName] [nvarchar](400) NULL,&#13;&#10; CONSTRAINT [PK_Users] PRIMARY KEY CLUSTERED &#13;&#10;(&#13;&#10;&#9;[Id] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;) ON [PRIMARY]&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  View [dbo].[ViewOperations]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;    &#13;&#10;CREATE VIEW [dbo].[ViewOperations]      &#13;&#10;AS      &#13;&#10; SELECT      &#13;&#10;  o.ID      &#13;&#10;  ,o.OperationType&#13;&#10;  ,ot.Name as OperationTypeEn    &#13;&#10;  ,ot.NameRus as OperationTypeRu&#13;&#10;  ,o.CreatedUser    &#13;&#10;  ,o.ComputerId      &#13;&#10;  ,sc.ComputerName      &#13;&#10;  ,sc.ShopId      &#13;&#10;  ,o.Attributes      &#13;&#10;  ,orp.IsRead      &#13;&#10;  ,o.CreationDate      &#13;&#10;  ,orp.DateRead      &#13;&#10;  ,lastOperState.OperStateId as OperStateId&#13;&#10;  ,lastOperState.Description as OperState      &#13;&#10;  ,orp.IsCompleted      &#13;&#10;  ,orp.DateCompleteOrError      &#13;&#10;  ,orp.Result      &#13;&#10;  ,lc.LogDate as LogDate1C      &#13;&#10;  ,lc.LogMessage as LogMessage1C      &#13;&#10;  ,case when isnull(lc.LogMessage, &apos;&apos;) &lt;&gt; &apos;&apos; then case when CHARINDEX(&apos;Обновление конфигурации успешно завершено&apos;, lc.LogMessage) &lt;&gt; 0 then 0 else 1 end else 0 end as Is1CError    &#13;&#10;  ,case when exists(select null from [dbo].[ActionsReports] where OperationId = o.ID and IsCompleted = 0) then 1 else 0 end as IsActionError    &#13;&#10;  ,isnull(o.IsFromSheduler, 0) as IsFromSheduler    &#13;&#10;  ,o.PoolDate    &#13;&#10;  ,o.GroupGUID    &#13;&#10; FROM Operations o       &#13;&#10; join OperationTypes ot on ot.Id = o.OperationType&#13;&#10; LEFT JOIN OperationsReports orp on orp.OperationId = o.ID      &#13;&#10; JOIN ShopComputers sc on sc.ComputerId = o.ComputerId      &#13;&#10; left join       &#13;&#10; (      &#13;&#10;  select os.*, osv.Description from OperationsStates os      &#13;&#10;  join OperationStatesVoc osv on osv.Id = os.OperStateId      &#13;&#10;  join      &#13;&#10;  (      &#13;&#10;   select max(id) as id, OperationId from OperationsStates      &#13;&#10;   group by OperationId       &#13;&#10;  ) q on q.id = os.Id and q.OperationId = os.OperationId      &#13;&#10; ) lastOperState on lastOperState.OperationId = o.ID      &#13;&#10; left join   &#13;&#10; (  &#13;&#10; select   &#13;&#10;  ComputerId  &#13;&#10;  ,OperationId  &#13;&#10;  ,IsError  &#13;&#10;  ,LogMessage  &#13;&#10;  ,MAX(LogDate) as LogDate  &#13;&#10; from Logs1C  &#13;&#10; group by   &#13;&#10;  ComputerId  &#13;&#10;  ,OperationId  &#13;&#10;  ,IsError  &#13;&#10;  ,LogMessage  &#13;&#10; having ISNULL(OperationId, 0) &lt;&gt; 0  &#13;&#10; ) lc on lc.OperationId = o.ID   &#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  View [dbo].[ViewOperationsTop5000]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;    &#13;&#10;CREATE VIEW [dbo].[ViewOperationsTop5000]      &#13;&#10;AS      &#13;&#10;&#9;select top 5000 &#13;&#10;&#9;&#9;ID&#13;&#10;&#9;&#9;,OperationType&#13;&#10;&#9;&#9;,OperationTypeEn&#13;&#10;&#9;&#9;,OperationTypeRu&#13;&#10;&#9;&#9;,CreatedUser&#13;&#10;&#9;&#9;,ComputerId&#13;&#10;&#9;&#9;,ComputerName&#13;&#10;&#9;&#9;,ShopId&#13;&#10;&#9;&#9;,Attributes&#13;&#10;&#9;&#9;,IsRead&#13;&#10;&#9;&#9;,CreationDate&#13;&#10;&#9;&#9;,DateRead&#13;&#10;&#9;&#9;,OperStateId&#13;&#10;&#9;&#9;,OperState&#13;&#10;&#9;&#9;,IsCompleted&#13;&#10;&#9;&#9;,DateCompleteOrError&#13;&#10;&#9;&#9;,Result&#13;&#10;&#9;&#9;,LogDate1C&#13;&#10;&#9;&#9;,LogMessage1C&#13;&#10;&#9;&#9;,Is1CError&#13;&#10;&#9;&#9;,IsActionError&#13;&#10;&#9;&#9;,IsFromSheduler&#13;&#10;&#9;&#9;,PoolDate   &#13;&#10;&#9;&#9;,GroupGUID &#13;&#10;&#9;from [dbo].[ViewOperations] with (nolock)&#13;&#10;&#9;order by ID desc&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  View [dbo].[ViewOperationsTop1000_New]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;    &#13;&#10;CREATE VIEW [dbo].[ViewOperationsTop1000_New]      &#13;&#10;AS      &#13;&#10;&#9;select top 1000 &#13;&#10;&#9;&#9;ID&#13;&#10;&#9;&#9;,OperationType&#13;&#10;&#9;&#9;,OperationTypeEn&#13;&#10;&#9;&#9;,OperationTypeRu&#13;&#10;&#9;&#9;,CreatedUser&#13;&#10;&#9;&#9;,ComputerId&#13;&#10;&#9;&#9;,ComputerName&#13;&#10;&#9;&#9;,ShopId&#13;&#10;&#9;&#9;,Attributes&#13;&#10;&#9;&#9;,IsRead&#13;&#10;&#9;&#9;,CreationDate&#13;&#10;&#9;&#9;,DateRead&#13;&#10;&#9;&#9;,OperStateId&#13;&#10;&#9;&#9;,OperState&#13;&#10;&#9;&#9;,IsCompleted&#13;&#10;&#9;&#9;,DateCompleteOrError&#13;&#10;&#9;&#9;,Result&#13;&#10;&#9;&#9;,LogDate1C&#13;&#10;&#9;&#9;,LogMessage1C&#13;&#10;&#9;&#9;,Is1CError&#13;&#10;&#9;&#9;,IsActionError&#13;&#10;&#9;&#9;,IsFromSheduler&#13;&#10;&#9;&#9;,PoolDate   &#13;&#10;&#9;&#9;,GroupGUID &#13;&#10;&#9;from [dbo].[ViewOperations] with (nolock)&#13;&#10;&#9;order by ID desc&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  View [dbo].[ViewOperationsLight]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;&#13;&#10;&#13;&#10;    &#13;&#10;CREATE VIEW [dbo].[ViewOperationsLight]      &#13;&#10;AS      &#13;&#10; SELECT      &#13;&#10;  o.ID      &#13;&#10;  ,ot.Name as OperationTypeEn    &#13;&#10;  ,ot.NameRus as OperationTypeRu &#13;&#10;  ,o.ComputerId                &#13;&#10;  ,o.CreationDate     &#13;&#10;  ,orp.IsCompleted &#13;&#10;  ,lastOperState.OperStateId as OperStateId&#13;&#10;  ,lastOperState.Description as OperState    &#13;&#10;  ,case when isnull(lc.LogMessage, &apos;&apos;) &lt;&gt; &apos;&apos; then case when CHARINDEX(&apos;Обновление конфигурации успешно завершено&apos;, lc.LogMessage) &lt;&gt; 0 then 0 else 1 end else 0 end as Is1CError      &#13;&#10; FROM Operations o (nolock)&#13;&#10; join OperationTypes ot on ot.Id = o.OperationType&#13;&#10; JOIN ShopComputers sc on sc.ComputerId = o.ComputerId      &#13;&#10; LEFT JOIN OperationsReports orp on orp.OperationId = o.ID  &#13;&#10; left join   &#13;&#10; (  &#13;&#10; select   &#13;&#10;  ComputerId  &#13;&#10;  ,OperationId  &#13;&#10;  ,IsError  &#13;&#10;  ,LogMessage  &#13;&#10;  ,MAX(LogDate) as LogDate  &#13;&#10; from Logs1C  &#13;&#10; group by   &#13;&#10;  ComputerId  &#13;&#10;  ,OperationId  &#13;&#10;  ,IsError  &#13;&#10;  ,LogMessage  &#13;&#10; having ISNULL(OperationId, 0) &lt;&gt; 0  &#13;&#10; ) lc on lc.OperationId = o.ID   &#13;&#10; left join       &#13;&#10; (      &#13;&#10;  select os.*, osv.Description from OperationsStates os (nolock)      &#13;&#10;  join OperationStatesVoc osv on osv.Id = os.OperStateId      &#13;&#10;  join      &#13;&#10;  (      &#13;&#10;   select max(id) as id, OperationId from OperationsStates (nolock)    &#13;&#10;   group by OperationId       &#13;&#10;  ) q on q.id = os.Id and q.OperationId = os.OperationId      &#13;&#10; ) lastOperState on lastOperState.OperationId = o.ID      &#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  View [dbo].[ViewShopComputersServer]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;&#13;&#10;&#13;&#10;CREATE view [dbo].[ViewShopComputersServer] as&#13;&#10;select &#13;&#10;&#9;ISNULL(sc.ComputerId, (ROW_NUMBER() OVER(ORDER BY sc.ComputerId ASC)) * -1) as ComputerId&#13;&#10;&#9;,s.ShopId&#13;&#10;&#9;,s.ShopName&#13;&#10;&#9;,s.ShopRegion&#13;&#10;&#9;,s.ExchangeError&#13;&#10;&#9;,s.AddressToConnect&#13;&#10;&#9;,s.Phone&#13;&#10;&#9;,s.IsClosed&#13;&#10;&#9;,s.Email&#13;&#10;&#9;,case when s.LastSuccessfulUpload = &apos;19000101&apos; then null else s.LastSuccessfulUpload end as LastSuccessfulUpload&#13;&#10;&#9;,case when s.LastSuccessfulReceive = &apos;19000101&apos; then null else s.LastSuccessfulReceive end as LastSuccessfulReceive&#13;&#10;&#9;,ISNULL(sc.ComputerName, &apos;&apos;) as ComputerName&#13;&#10;&#9;,ISNULL(sc.ComputerAddress, &apos;&apos;) as ComputerAddress&#13;&#10;&#9;,ISNULL(sc.Is1CServer, 0) as Is1CServer&#13;&#10;&#9;,ISNULL(sc.IsMainCashbox, 0) as IsMainCashbox&#13;&#10;&#9;,ISNULL(sc.LastUpdateTime, null) as LastUpdateTime&#13;&#10;&#9;,ISNULL(sc.ComputerHash, &apos;&apos;) as ComputerHash&#13;&#10;&#9;,ISNULL(sc.Mac, &apos;&apos;) as Mac&#13;&#10;&#9;,ISNULL(sc.MagicUpdaterVersion, &apos;&apos;) as MagicUpdaterVersion&#13;&#10;&#9;,ISNULL(sc.External_IP, &apos;&apos;) as External_IP &#13;&#10;&#9;,ISNULL(sc.IsTaskerAlive, 0) as IsTaskerAlive&#13;&#10;&#9;,sc.LastErrorDate&#13;&#10;&#9;,ISNULL(sc.LastError, &apos;&apos;) as LastError&#13;&#10;&#9;,ISNULL(sc.IsON, 0) as IsON&#13;&#10;&#9;,case when &#13;&#10;&#9;&#9;ISNULL(os.OperationTypeRu, &apos;&apos;) &lt;&gt; &apos;&apos;&#13;&#10;&#9; then&#13;&#10;&#9;&#9;ISNULL(os.OperationTypeRu, &apos;&apos;)&#13;&#10;&#9; else&#13;&#10;&#9;&#9;ISNULL(os.OperationTypeEn, &apos;&apos;) &#13;&#10;&#9; end as OperationTypeRu&#13;&#10;&#13;&#10;&#9;,ISNULL(os.CreationDate, null) as OperationCreationDate&#13;&#10;&#13;&#10;&#9;,ISNULL(case when isnull(os.OperStateId, 0) &lt;&gt; 2 then os.OperState else &#13;&#10;&#9;&#9; case when os.IsCompleted = 1 and os.Is1CError = 0 and os.OperStateId = 2 then &apos;Завершена успешно&apos;&#13;&#10;&#9;&#9; else &apos;Завершена с ошибкой&apos; end end, &apos;&apos;) as OperState&#13;&#10;from&#13;&#10;(&#13;&#10;&#9;select&#13;&#10;&#9;&#9;*&#13;&#10;&#9;from [dbo].[ShopComputers] sc&#13;&#10;&#9;where sc.Is1CServer = 1&#13;&#10;) sc&#13;&#10;left join &#13;&#10;(&#13;&#10;&#9;select &#13;&#10;&#9;&#9;o.OperationTypeEn&#13;&#10;&#9;&#9;,o.OperationTypeRu&#13;&#10;&#9;&#9;,o.ComputerId&#13;&#10;&#9;&#9;,o.CreationDate&#13;&#10;&#9;&#9;,o.OperStateId&#13;&#10;&#9;&#9;,o.IsCompleted&#13;&#10;&#9;&#9;,o.OperState &#13;&#10;&#9;&#9;,o.Is1CError&#13;&#10;&#9;from [dbo].[ViewOperationsLight] o&#13;&#10;&#9;join&#13;&#10;&#9;(&#13;&#10;&#9;&#9;select&#13;&#10;&#9;&#9;&#9;ComputerId,&#13;&#10;&#9;&#9;&#9;max(ID) as ID&#13;&#10;&#9;&#9;from [dbo].[ViewOperationsLight]&#13;&#10;&#9;&#9;group by ComputerId&#13;&#10;&#9;) co on co.ID = o.ID&#13;&#10;&#9;where o.CreationDate &gt; dateadd(hh,-4,getdate())&#13;&#10;) os on os.ComputerId = sc.ComputerId&#13;&#10;right join [dbo].[Shops] s on s.ShopId = sc.ShopId&#13;&#10;--where s.IsClosed = 0&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;--select &#13;&#10;--&#9;ISNULL(sc.ComputerId, (ROW_NUMBER() OVER(ORDER BY ComputerId ASC)) * -1) as ComputerId&#13;&#10;--&#9;,s.ShopId&#13;&#10;--&#9;,s.ShopName&#13;&#10;--&#9;,s.ShopRegion&#13;&#10;--&#9;,s.ExchangeError&#13;&#10;--&#9;,s.AddressToConnect&#13;&#10;--&#9;,s.Phone&#13;&#10;--&#9;,s.IsClosed&#13;&#10;--&#9;,s.Email&#13;&#10;--&#9;,case when s.LastSuccessfulUpload = &apos;19000101&apos; then null else s.LastSuccessfulUpload end as LastSuccessfulUpload&#13;&#10;--&#9;,case when s.LastSuccessfulReceive = &apos;19000101&apos; then null else s.LastSuccessfulReceive end as LastSuccessfulReceive&#13;&#10;--&#9;,ISNULL(sc.ComputerName, &apos;&apos;) as ComputerName&#13;&#10;--&#9;,ISNULL(sc.ComputerAddress, &apos;&apos;) as ComputerAddress&#13;&#10;--&#9;,ISNULL(sc.Is1CServer, 0) as Is1CServer&#13;&#10;--&#9;,ISNULL(sc.IsMainCashbox, 0) as IsMainCashbox&#13;&#10;--&#9;,ISNULL(sc.LastUpdateTime, null) as LastUpdateTime&#13;&#10;--&#9;,ISNULL(sc.ComputerHash, &apos;&apos;) as ComputerHash&#13;&#10;--&#9;,ISNULL(sc.Mac, &apos;&apos;) as Mac&#13;&#10;--&#9;,ISNULL(sc.MagicUpdaterVersion, &apos;&apos;) as MagicUpdaterVersion&#13;&#10;--&#9;,ISNULL(sc.External_IP, &apos;&apos;) as External_IP &#13;&#10;--&#9;,ISNULL(sc.IsTaskerAlive, 0) as IsTaskerAlive&#13;&#10;--&#9;,ISNULL(sc.IsON, 0) as IsON&#13;&#10;--&#9;,case when &#13;&#10;--&#9;&#9;ISNULL((select OperationTypeRu from [dbo].[ViewOperations] where ID = (select max(ID) from Operations where ComputerId = sc.ComputerId and CreationDate &gt; dateadd(hh,-4,getdate()))), &apos;&apos;) &lt;&gt; &apos;&apos;&#13;&#10;--&#9; then&#13;&#10;--&#9;&#9;ISNULL((select OperationTypeRu from [dbo].[ViewOperations] where ID = (select max(ID) from Operations where ComputerId = sc.ComputerId and CreationDate &gt; dateadd(hh,-4,getdate()))), &apos;&apos;)&#13;&#10;--&#9; else&#13;&#10;--&#9;&#9;ISNULL((select OperationTypeEn from [dbo].[ViewOperations] where ID = (select max(ID) from Operations where ComputerId = sc.ComputerId and CreationDate &gt; dateadd(hh,-4,getdate()))), &apos;&apos;) &#13;&#10;--&#9; end as OperationTypeRu&#13;&#10;&#13;&#10;--&#9;,ISNULL((select CreationDate from [dbo].[ViewOperations] where ID = (select max(ID) from Operations where ComputerId = sc.ComputerId and CreationDate &gt; dateadd(hh,-4,getdate()))), null) as OperationCreationDate&#13;&#10;--&#9;,ISNULL((select &#13;&#10;--&#9;&#9; case when isnull(OperStateId, 0) &lt;&gt; 2 then OperState else &#13;&#10;--&#9;&#9; case when IsCompleted = 1 and Is1CError = 0 and OperStateId = 2 then &apos;Завершена успешно&apos;&#13;&#10;--&#9;&#9; else &apos;Завершена с ошибкой&apos; end end as OperState&#13;&#10;--&#9;from [dbo].[ViewOperations]&#13;&#10;--&#9;where ID = (select max(ID) from Operations where ComputerId = sc.ComputerId and CreationDate &gt; dateadd(hh,-4,getdate()))), &apos;&apos;) as OperState&#13;&#10;--&#9;,ISNULL(sc.LastError, &apos;&apos;) as LastError&#13;&#10;--from&#13;&#10;--(&#13;&#10;--&#9;select&#13;&#10;--&#9;&#9;*&#13;&#10;--&#9;from [dbo].[ShopComputers] sc&#13;&#10;--&#9;where sc.Is1CServer = 1&#13;&#10;--) sc&#13;&#10;--right join [dbo].[Shops] s on s.ShopId = sc.ShopId&#13;&#10;--where s.IsClosed = 0&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  View [dbo].[ViewShopComputersServerFull]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;CREATE view [dbo].[ViewShopComputersServerFull] as&#13;&#10;select &#13;&#10;&#9;ISNULL(sc.ComputerId, (ROW_NUMBER() OVER(ORDER BY ComputerId ASC)) * -1) as ComputerId&#13;&#10;&#9;,s.ShopId&#13;&#10;&#9;,s.ShopName&#13;&#10;&#9;,s.ShopRegion&#13;&#10;&#9;,s.ExchangeError&#13;&#10;&#9;,s.AddressToConnect&#13;&#10;&#9;,s.Phone&#13;&#10;&#9;,s.IsClosed&#13;&#10;&#9;,s.Email&#13;&#10;&#9;,case when s.LastSuccessfulUpload = &apos;19000101&apos; then null else s.LastSuccessfulUpload end as LastSuccessfulUpload&#13;&#10;&#9;,case when s.LastSuccessfulReceive = &apos;19000101&apos; then null else s.LastSuccessfulReceive end as LastSuccessfulReceive&#13;&#10;&#9;,ISNULL(sc.ComputerName, &apos;&apos;) as ComputerName&#13;&#10;&#9;,ISNULL(sc.ComputerAddress, &apos;&apos;) as ComputerAddress&#13;&#10;&#9;,ISNULL(sc.Is1CServer, 0) as Is1CServer&#13;&#10;&#9;,ISNULL(sc.IsMainCashbox, 0) as IsMainCashbox&#13;&#10;&#9;,ISNULL(sc.LastUpdateTime, null) as LastUpdateTime&#13;&#10;&#9;,ISNULL(sc.ComputerHash, &apos;&apos;) as ComputerHash&#13;&#10;&#9;,ISNULL(sc.Mac, &apos;&apos;) as Mac&#13;&#10;&#9;,ISNULL(sc.MagicUpdaterVersion, &apos;&apos;) as MagicUpdaterVersion&#13;&#10;&#9;,ISNULL(sc.External_IP, &apos;&apos;) as External_IP &#13;&#10;&#9;,ISNULL(sc.IsTaskerAlive, 0) as IsTaskerAlive&#13;&#10;&#9;,ISNULL(sc.IsON, 0) as IsON&#13;&#10;&#9;,ISNULL((select OperationTypeRu from [dbo].[ViewOperations] where ID = (select max(ID) from Operations where ComputerId = sc.ComputerId and CreationDate &gt; dateadd(hh,-4,getdate()))), &apos;&apos;) as OperationTypeRu&#13;&#10;&#9;,ISNULL((select CreationDate from [dbo].[ViewOperations] where ID = (select max(ID) from Operations where ComputerId = sc.ComputerId and CreationDate &gt; dateadd(hh,-4,getdate()))), null) as OperationCreationDate&#13;&#10;&#9;,ISNULL((select &#13;&#10;&#9;&#9; case when OperStateId = 5 then OperState else &#13;&#10;&#9;&#9; case when IsCompleted = 1 and Is1CError = 0 and OperStateId = 2 then &apos;Завершена успешно&apos;&#13;&#10;&#9;&#9; else &apos;Завершена с ошибкой&apos; end end as OperState&#13;&#10;&#9;from [dbo].[ViewOperations]&#13;&#10;&#9;where ID = (select max(ID) from Operations where ComputerId = sc.ComputerId and CreationDate &gt; dateadd(hh,-4,getdate()))), &apos;&apos;) as OperState&#13;&#10;&#9;,ISNULL(sc.LastError, &apos;&apos;) as LastError&#13;&#10;from&#13;&#10;(&#13;&#10;&#9;select&#13;&#10;&#9;&#9;*&#13;&#10;&#9;from [dbo].[ShopComputers] sc&#13;&#10;&#9;--where sc.Is1CServer = 1&#13;&#10;) sc&#13;&#10;right join [dbo].[Shops] s on s.ShopId = sc.ShopId&#13;&#10;--where s.IsClosed = 0&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  View [dbo].[ViewOperationsTop1000]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;    &#13;&#10;CREATE VIEW [dbo].[ViewOperationsTop1000]      &#13;&#10;AS      &#13;&#10;&#9;select top 1000 &#13;&#10;&#9;&#9;ID&#13;&#10;&#9;&#9;,OperationType&#13;&#10;&#9;&#9;,OperationTypeEn&#13;&#10;&#9;&#9;,OperationTypeRu&#13;&#10;&#9;&#9;,CreatedUser&#13;&#10;&#9;&#9;,ComputerId&#13;&#10;&#9;&#9;,ComputerName&#13;&#10;&#9;&#9;,ShopId&#13;&#10;&#9;&#9;,Attributes&#13;&#10;&#9;&#9;,IsRead&#13;&#10;&#9;&#9;,CreationDate&#13;&#10;&#9;&#9;,DateRead&#13;&#10;&#9;&#9;,OperStateId&#13;&#10;&#9;&#9;,OperState&#13;&#10;&#9;&#9;,IsCompleted&#13;&#10;&#9;&#9;,DateCompleteOrError&#13;&#10;&#9;&#9;,Result&#13;&#10;&#9;&#9;,LogDate1C&#13;&#10;&#9;&#9;,LogMessage1C&#13;&#10;&#9;&#9;,Is1CError&#13;&#10;&#9;&#9;,IsActionError&#13;&#10;&#9;&#9;,IsFromSheduler&#13;&#10;&#9;&#9;,PoolDate   &#13;&#10;&#9;&#9;,GroupGUID &#13;&#10;&#9;from [dbo].[ViewOperations] with (nolock)&#13;&#10;&#9;order by ID desc&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  View [dbo].[ComputerErrorsLogView]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;create view [dbo].[ComputerErrorsLogView] as&#13;&#10;select &#13;&#10;&#9;cel.ErrorId&#13;&#10;&#9;, sc.ShopId&#13;&#10;&#9;, cel.ComputerId&#13;&#10;&#9;, sc.ComputerName&#13;&#10;&#9;, cel.ErrorMessage&#13;&#10;&#9;, cel.ErrorDate&#13;&#10;&#9;, sc.Mac&#13;&#10;from [dbo].[ComputerErrorsLog] cel&#13;&#10;join ShopComputers sc on sc.ComputerId = cel.ComputerId&#13;&#10;GO&#13;&#10;/****** Object:  View [dbo].[LocalSettingsView]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;create view [dbo].[LocalSettingsView]&#13;&#10;as&#13;&#10;select &#13;&#10;&#9;ls.ComputerId&#13;&#10;&#9;, ls.SettingId&#13;&#10;&#9;, lsd.Name&#13;&#10;&#9;, ls.Value&#13;&#10;&#9;, lsd.Description&#13;&#10;from [dbo].[LocalSettings] ls&#13;&#10;join [dbo].[LocalSettingsDictionary] lsd on lsd.SettingId = ls.SettingId&#13;&#10;GO&#13;&#10;/****** Object:  View [dbo].[ViewComputerErrorsLog]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE VIEW [dbo].[ViewComputerErrorsLog]  &#13;&#10;AS  &#13;&#10; SELECT  &#13;&#10;&#9;cel.ErrorId&#13;&#10;&#9;, cel.ComputerId&#13;&#10;&#9;, sc.ComputerName&#13;&#10;&#9;, sc.External_IP&#13;&#10;&#9;, sc.Is1CServer&#13;&#10;&#9;, sc.IsMainCashbox&#13;&#10;&#9;, sc.IsTaskerAlive&#13;&#10;&#9;, sc.IsON&#13;&#10;&#9;, cel.ErrorMessage&#13;&#10;&#9;, cel.ErrorDate&#13;&#10; FROM [dbo].[ComputerErrorsLog] cel   &#13;&#10; JOIN ShopComputers sc on sc.ComputerId = cel.ComputerId  &#13;&#10;GO&#13;&#10;/****** Object:  View [dbo].[ViewOperationsForExecute]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;&#13;&#10;CREATE VIEW [dbo].[ViewOperationsForExecute]&#13;&#10;AS&#13;&#10;&#9;SELECT &#13;&#10;&#9;&#9;o.ID &#13;&#10;&#9;&#9;,o.OperationType &#13;&#10;&#9;&#9;,o.Attributes&#13;&#10;&#9;FROM Operations o &#13;&#10;&#9;LEFT JOIN OperationsReports opr ON opr.OperationId = o.ID&#13;&#10;&#9;WHERE &#13;&#10;&#9;&#9;isnull(opr.IsRead, 0) = 0&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  View [dbo].[ViewOperStates]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;create view [dbo].[ViewOperStates] &#13;&#10;as&#13;&#10;select&#13;&#10;&#9;os.OperationId&#13;&#10;&#9;, o.OperationType&#13;&#10;&#9;, sc.ShopId&#13;&#10;&#9;, sc.ComputerName&#13;&#10;&#9;, os.OperStateId&#13;&#10;&#9;, osv.Name&#13;&#10;&#9;, osv.Description&#13;&#10;&#9;, os.StateDate&#13;&#10;from OperationsStates os&#13;&#10;join OperationStatesVoc osv on osv.Id = os.OperStateId&#13;&#10;join Operations o on o.ID = os.OperationId&#13;&#10;join ShopComputers sc on sc.ComputerId = o.ComputerId&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  View [dbo].[ViewShedulerSteps]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;&#13;&#10;CREATE VIEW [dbo].[ViewShedulerSteps] AS&#13;&#10;SELECT&#13;&#10;&#9;taskId,&#13;&#10;&#9;st.Id AS ParentId,&#13;&#10;&#9;st.OnOperationCompleteStep AS ChildId,&#13;&#10;&#9;1 AS IsChildPositiveBranch&#13;&#10;FROM &#13;&#10;&#9;[dbo].[ShedulerSteps]  st&#13;&#10;WHERE st.OnOperationCompleteStep &lt;&gt; 0&#13;&#10;UNION&#13;&#10;SELECT &#13;&#10;&#9;taskId,&#13;&#10;&#9;st.Id AS ParentId,&#13;&#10;&#9;st.OnOperationErrorStep AS ChildId,&#13;&#10;&#9;0 AS IsChildPositiveBranch&#13;&#10;FROM &#13;&#10;&#9;[dbo].[ShedulerSteps]  st&#13;&#10;WHERE st.OnOperationErrorStep &lt;&gt; 0&#13;&#10;UNION&#13;&#10;SELECT &#13;&#10;&#9;Id as taskId,&#13;&#10;&#9;0 as ParentId,&#13;&#10;&#9;FirstStepId AS ChildId,&#13;&#10;&#9;1 AS IsChildPositiveBranch&#13;&#10;FROM [dbo].[ShedulerTasks]&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  View [dbo].[ViewShedulerStepsVis]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE VIEW [dbo].[ViewShedulerStepsVis] AS  &#13;&#10;  &#13;&#10;WITH steps   &#13;&#10;(  &#13;&#10; Id  &#13;&#10; ,Step  &#13;&#10; ,TaskId  &#13;&#10; ,OperationType  &#13;&#10; ,Name  &#13;&#10; ,NameRus  &#13;&#10; ,nameVis  &#13;&#10; ,nameVisCount  &#13;&#10; ,RepeatCount  &#13;&#10; ,RepeatTimeout  &#13;&#10; ,OperationCheckIntervalMs  &#13;&#10; ,OnOperationCompleteStep  &#13;&#10; ,OnOperationErrorStep  &#13;&#10; ,OrderId  &#13;&#10; ,OperationAttributes&#13;&#10;)  &#13;&#10;AS  &#13;&#10;(  &#13;&#10; SELECT  &#13;&#10;  ss.Id  &#13;&#10;  ,(ROW_NUMBER() OVER(partition by ss.TaskId order by ss.Id)) as Step  &#13;&#10;  ,ss.TaskId  &#13;&#10;  ,ss.OperationType  &#13;&#10;  ,ot.Name  &#13;&#10;  ,ot.NameRus  &#13;&#10;  ,CASE WHEN ISNULL(ot.NameRus, &apos;&apos;) = &apos;&apos; THEN ot.Name ELSE ot.NameRus END as nameVis  &#13;&#10;  ,&apos;[&apos;+CAST((ROW_NUMBER() OVER(partition by ss.TaskId order by ss.Id)) as nvarchar)+&apos;] &apos; + CASE WHEN ISNULL(ot.NameRus, &apos;&apos;) = &apos;&apos; THEN ot.Name ELSE ot.NameRus END as nameVisCount  &#13;&#10;  ,ss.RepeatCount  &#13;&#10;  ,ss.RepeatTimeout  &#13;&#10;  ,ss.OperationCheckIntervalMs  &#13;&#10;  ,ss.OnOperationCompleteStep  &#13;&#10;  ,ss.OnOperationErrorStep  &#13;&#10;  ,ss.OrderId&#13;&#10;  ,ss.OperationAttributes  &#13;&#10; FROM   &#13;&#10;  [dbo].[ShedulerSteps] ss  &#13;&#10;  join OperationTypes ot on ot.Id = ss.OperationType  &#13;&#10;)  &#13;&#10;  &#13;&#10;SELECT  &#13;&#10; bs.Id  &#13;&#10; ,bs.Step  &#13;&#10; ,bs.TaskId  &#13;&#10; ,bs.OperationType  &#13;&#10; ,bs.Name  &#13;&#10; ,bs.NameRus  &#13;&#10; ,bs.nameVis  &#13;&#10; ,bs.nameVisCount  &#13;&#10; ,bs.RepeatCount  &#13;&#10; ,bs.RepeatTimeout  &#13;&#10; ,bs.OperationCheckIntervalMs  &#13;&#10; ,bs.OnOperationCompleteStep  &#13;&#10; ,cs.Name as NameCompleteStep  &#13;&#10; ,cs.NameRus as NameRusCompleteStep  &#13;&#10; ,cs.NameVis as nameVisCompleteStep  &#13;&#10; ,CASE WHEN ISNULL(cs.NameVisCount, N&apos;&apos;) = N&apos;&apos; THEN N&apos;Завершить&apos; ELSE cs.NameVisCount END as nameVisCountCompleteStep  &#13;&#10; ,bs.OnOperationErrorStep  &#13;&#10; ,es.Name as NameErrorStep  &#13;&#10; ,es.NameRus as NameRusErrorStep  &#13;&#10; ,es.NameVis as nameVisErrorStep  &#13;&#10; ,CASE WHEN ISNULL(es.NameVisCount, N&apos;&apos;) = N&apos;&apos; THEN N&apos;Завершить&apos; ELSE es.NameVisCount END as nameVisCountErrorStep  &#13;&#10; ,bs.OrderId &#13;&#10; ,bs.OperationAttributes   &#13;&#10;FROM   &#13;&#10; steps bs  &#13;&#10; left join steps cs on cs.Id = bs.OnOperationCompleteStep  &#13;&#10; left join steps es on es.Id = bs.OnOperationErrorStep  &#13;&#10;GO&#13;&#10;SET ANSI_PADDING ON&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  Index [IU_CommonGlobalSettings_Name]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;CREATE UNIQUE NONCLUSTERED INDEX [IU_CommonGlobalSettings_Name] ON [dbo].[CommonGlobalSettings]&#13;&#10;(&#13;&#10;&#9;[Name] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;GO&#13;&#10;/****** Object:  Index [UI_LocalSettingsDictionary]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;CREATE UNIQUE NONCLUSTERED INDEX [UI_LocalSettingsDictionary] ON [dbo].[LocalSettingsDictionary]&#13;&#10;(&#13;&#10;&#9;[SettingId] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;GO&#13;&#10;SET ANSI_PADDING ON&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  Index [IX_OperationGroups]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;CREATE UNIQUE NONCLUSTERED INDEX [IX_OperationGroups] ON [dbo].[OperationGroups]&#13;&#10;(&#13;&#10;&#9;[Name] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;GO&#13;&#10;/****** Object:  Index [IX_OperationId]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;CREATE NONCLUSTERED INDEX [IX_OperationId] ON [dbo].[OperationsReports]&#13;&#10;(&#13;&#10;&#9;[OperationId] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;GO&#13;&#10;/****** Object:  Index [Id]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;CREATE UNIQUE NONCLUSTERED INDEX [Id] ON [dbo].[OperationStatesVoc]&#13;&#10;(&#13;&#10;&#9;[Id] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;GO&#13;&#10;SET ANSI_PADDING ON&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  Index [IX_OperationTypes_1]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;CREATE UNIQUE NONCLUSTERED INDEX [IX_OperationTypes_1] ON [dbo].[OperationTypes]&#13;&#10;(&#13;&#10;&#9;[Name] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;GO&#13;&#10;SET ANSI_PADDING ON&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  Index [IX_Users]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;CREATE UNIQUE NONCLUSTERED INDEX [IX_Users] ON [dbo].[Users]&#13;&#10;(&#13;&#10;&#9;[UserLogin] ASC&#13;&#10;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[Operations] ADD  CONSTRAINT [DF_Operations_CreationDate]  DEFAULT (getutcdate()) FOR [CreationDate]&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[ActionsReports]  WITH CHECK ADD  CONSTRAINT [FK_ActionsReports_Operations] FOREIGN KEY([OperationId])&#13;&#10;REFERENCES [dbo].[Operations] ([ID])&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[ActionsReports] CHECK CONSTRAINT [FK_ActionsReports_Operations]&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[ActionsReports]  WITH CHECK ADD  CONSTRAINT [FK_ActionsReports_ShopComputers] FOREIGN KEY([ComputerId])&#13;&#10;REFERENCES [dbo].[ShopComputers] ([ComputerId])&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[ActionsReports] CHECK CONSTRAINT [FK_ActionsReports_ShopComputers]&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[ComputerErrorsLog]  WITH CHECK ADD  CONSTRAINT [FK_ComputerErrorsLog_ShopComputers] FOREIGN KEY([ComputerId])&#13;&#10;REFERENCES [dbo].[ShopComputers] ([ComputerId])&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[ComputerErrorsLog] CHECK CONSTRAINT [FK_ComputerErrorsLog_ShopComputers]&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[LocalSettings]  WITH NOCHECK ADD  CONSTRAINT [FK_LocalSettings_LocalSettingsDictionary] FOREIGN KEY([SettingId])&#13;&#10;REFERENCES [dbo].[LocalSettingsDictionary] ([SettingId])&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[LocalSettings] CHECK CONSTRAINT [FK_LocalSettings_LocalSettingsDictionary]&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[LocalSettings]  WITH NOCHECK ADD  CONSTRAINT [FK_LocalSettings_ShopComputers] FOREIGN KEY([ComputerId])&#13;&#10;REFERENCES [dbo].[ShopComputers] ([ComputerId])&#13;&#10;ON DELETE CASCADE&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[LocalSettings] CHECK CONSTRAINT [FK_LocalSettings_ShopComputers]&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[Logs1C]  WITH CHECK ADD  CONSTRAINT [FK_Logs1C_ShopComputers] FOREIGN KEY([ComputerId])&#13;&#10;REFERENCES [dbo].[ShopComputers] ([ComputerId])&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[Logs1C] CHECK CONSTRAINT [FK_Logs1C_ShopComputers]&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[Operations]  WITH CHECK ADD  CONSTRAINT [FK_Operations_OperationTypes] FOREIGN KEY([OperationType])&#13;&#10;REFERENCES [dbo].[OperationTypes] ([Id])&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[Operations] CHECK CONSTRAINT [FK_Operations_OperationTypes]&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[Operations]  WITH CHECK ADD  CONSTRAINT [FK_Operations_ShopComputers] FOREIGN KEY([ComputerId])&#13;&#10;REFERENCES [dbo].[ShopComputers] ([ComputerId])&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[Operations] CHECK CONSTRAINT [FK_Operations_ShopComputers]&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[OperationsReports]  WITH CHECK ADD  CONSTRAINT [FK_OperationsReports_Operations] FOREIGN KEY([OperationId])&#13;&#10;REFERENCES [dbo].[Operations] ([ID])&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[OperationsReports] CHECK CONSTRAINT [FK_OperationsReports_Operations]&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[OperationsStates]  WITH CHECK ADD  CONSTRAINT [FK_OperationsStates_Operations] FOREIGN KEY([OperationId])&#13;&#10;REFERENCES [dbo].[Operations] ([ID])&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[OperationsStates] CHECK CONSTRAINT [FK_OperationsStates_Operations]&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[OperationsStates]  WITH NOCHECK ADD  CONSTRAINT [FK_OperationsStates_OperationStatesVoc] FOREIGN KEY([OperStateId])&#13;&#10;REFERENCES [dbo].[OperationStatesVoc] ([Id])&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[OperationsStates] CHECK CONSTRAINT [FK_OperationsStates_OperationStatesVoc]&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[OperationTypeAttributes]  WITH NOCHECK ADD  CONSTRAINT [FK_OperationTypeAttributes_OperationTypes] FOREIGN KEY([OperationTypeId])&#13;&#10;REFERENCES [dbo].[OperationTypes] ([Id])&#13;&#10;ON DELETE CASCADE&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[OperationTypeAttributes] CHECK CONSTRAINT [FK_OperationTypeAttributes_OperationTypes]&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[OperationTypeAttributes]  WITH NOCHECK ADD  CONSTRAINT [FK_OperationTypeAttributes_Users] FOREIGN KEY([UserId])&#13;&#10;REFERENCES [dbo].[Users] ([Id])&#13;&#10;ON DELETE CASCADE&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[OperationTypeAttributes] CHECK CONSTRAINT [FK_OperationTypeAttributes_Users]&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[OperationTypes]  WITH CHECK ADD  CONSTRAINT [FK_OperationTypes_OperationGroups] FOREIGN KEY([GroupId])&#13;&#10;REFERENCES [dbo].[OperationGroups] ([Id])&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[OperationTypes] CHECK CONSTRAINT [FK_OperationTypes_OperationGroups]&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[ShedulerPluginTasks]  WITH NOCHECK ADD  CONSTRAINT [FK_ShedulerPluginTasks_ShedulerStatuses] FOREIGN KEY([Status])&#13;&#10;REFERENCES [dbo].[ShedulerStatuses] ([Id])&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[ShedulerPluginTasks] CHECK CONSTRAINT [FK_ShedulerPluginTasks_ShedulerStatuses]&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[ShedulerPluginTasks]  WITH NOCHECK ADD  CONSTRAINT [FK_ShedulerPluginTasks_ShedulerTaskModes] FOREIGN KEY([Mode])&#13;&#10;REFERENCES [dbo].[ShedulerTaskModes] ([Id])&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[ShedulerPluginTasks] CHECK CONSTRAINT [FK_ShedulerPluginTasks_ShedulerTaskModes]&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[ShedulerSteps]  WITH NOCHECK ADD  CONSTRAINT [FK_ShedulerSteps_ShedulerTasks] FOREIGN KEY([TaskId])&#13;&#10;REFERENCES [dbo].[ShedulerTasks] ([Id])&#13;&#10;ON DELETE CASCADE&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[ShedulerSteps] CHECK CONSTRAINT [FK_ShedulerSteps_ShedulerTasks]&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[ShedulerTaskHistory]  WITH NOCHECK ADD  CONSTRAINT [FK_ShedulerTaskHistory_ShedulerSteps] FOREIGN KEY([StepId])&#13;&#10;REFERENCES [dbo].[ShedulerSteps] ([Id])&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[ShedulerTaskHistory] CHECK CONSTRAINT [FK_ShedulerTaskHistory_ShedulerSteps]&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[ShedulerTaskHistory]  WITH NOCHECK ADD  CONSTRAINT [FK_ShedulerTaskHistory_ShedulerTasks] FOREIGN KEY([TaskId])&#13;&#10;REFERENCES [dbo].[ShedulerTasks] ([Id])&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[ShedulerTaskHistory] CHECK CONSTRAINT [FK_ShedulerTaskHistory_ShedulerTasks]&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[ShedulerTasks]  WITH NOCHECK ADD  CONSTRAINT [FK_ShedulerTasks_ShedulerStatuses] FOREIGN KEY([Status])&#13;&#10;REFERENCES [dbo].[ShedulerStatuses] ([Id])&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[ShedulerTasks] CHECK CONSTRAINT [FK_ShedulerTasks_ShedulerStatuses]&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[ShedulerTasks]  WITH NOCHECK ADD  CONSTRAINT [FK_ShedulerTasks_ShedulerSteps] FOREIGN KEY([FirstStepId])&#13;&#10;REFERENCES [dbo].[ShedulerSteps] ([Id])&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[ShedulerTasks] CHECK CONSTRAINT [FK_ShedulerTasks_ShedulerSteps]&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[ShedulerTasks]  WITH NOCHECK ADD  CONSTRAINT [FK_ShedulerTasks_ShedulerTaskModes] FOREIGN KEY([Mode])&#13;&#10;REFERENCES [dbo].[ShedulerTaskModes] ([Id])&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[ShedulerTasks] CHECK CONSTRAINT [FK_ShedulerTasks_ShedulerTaskModes]&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[ShedulerTasksComputersList]  WITH NOCHECK ADD  CONSTRAINT [FK_ShedulerTasksComputersList_ShedulerTasks] FOREIGN KEY([TaskId])&#13;&#10;REFERENCES [dbo].[ShedulerTasks] ([Id])&#13;&#10;ON DELETE CASCADE&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[ShedulerTasksComputersList] CHECK CONSTRAINT [FK_ShedulerTasksComputersList_ShedulerTasks]&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[ShopComputers]  WITH CHECK ADD  CONSTRAINT [FK_ShopComputers_Shops] FOREIGN KEY([ShopId])&#13;&#10;REFERENCES [dbo].[Shops] ([ShopId])&#13;&#10;GO&#13;&#10;ALTER TABLE [dbo].[ShopComputers] CHECK CONSTRAINT [FK_ShopComputers_Shops]&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[AddOperationType]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;        &#13;&#10;CREATE PROCEDURE [dbo].[AddOperationType](        &#13;&#10; @Name nvarchar(512)        &#13;&#10; ,@NameRus nvarchar(512)        &#13;&#10; ,@GroupId int        &#13;&#10; ,@FileName nvarchar(510)        &#13;&#10; ,@LastModifiedDate datetime      &#13;&#10; ,@FileMD5 nvarchar(64)        &#13;&#10; ,@Description nvarchar(MAX)        &#13;&#10; )        &#13;&#10;AS           &#13;&#10; declare @currentId int        &#13;&#10; declare @errorText varchar(512) = &apos;&apos;        &#13;&#10;        &#13;&#10; if(EXISTS(select null from [dbo].[OperationTypes] where UPPER([FileName]) = UPPER(@FileName)))        &#13;&#10;  set @errorText = &apos;Имя файла &apos;+@FileName+&apos; уже зарегистрировано в типах операций&apos;        &#13;&#10; else        &#13;&#10; begin        &#13;&#10;  select @currentId = max(Id) from [dbo].[OperationTypes]        &#13;&#10;        &#13;&#10;  if(@currentId&gt;=10000)        &#13;&#10;   set @currentId = @currentId + 1        &#13;&#10;  else        &#13;&#10;   set @currentId = 10000        &#13;&#10;        &#13;&#10;  INSERT [dbo].[OperationTypes]          &#13;&#10;  (        &#13;&#10;   [Id]        &#13;&#10;   ,[Name]           &#13;&#10;   ,[NameRus]          &#13;&#10;   ,[GroupId]          &#13;&#10;   ,[FileName]        &#13;&#10;   ,[LastModifiedDate]        &#13;&#10;   ,[FileMD5]          &#13;&#10;   ,[Description]      &#13;&#10;   ,[Visible]       &#13;&#10;  )        &#13;&#10;  VALUES        &#13;&#10;  (        &#13;&#10;   @currentId        &#13;&#10;   ,@Name        &#13;&#10;   ,@NameRus        &#13;&#10;   ,@GroupId        &#13;&#10;   ,@FileName       &#13;&#10;   ,@LastModifiedDate       &#13;&#10;   ,@FileMD5        &#13;&#10;   ,@Description       &#13;&#10;   ,1     &#13;&#10;  )      &#13;&#10;  select @currentId as Id    &#13;&#10; end &#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[AddOperState]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE PROCEDURE [dbo].[AddOperState]&#13;&#10;    @OperationId int,&#13;&#10;    @OperStateId int&#13;&#10;AS &#13;&#10;   SET NOCOUNT ON;&#13;&#10;&#13;&#10;   INSERT INTO [dbo].OperationsStates&#13;&#10;   (&#13;&#10;&#9;&#9;OperationId,&#13;&#10;&#9;&#9;OperStateId,&#13;&#10;&#9;&#9;StateDate&#13;&#10;   )&#13;&#10;   VALUES&#13;&#10;   (&#13;&#10;&#9;&#9;@OperationId,&#13;&#10;&#9;&#9;@OperStateId,&#13;&#10;&#9;&#9;GETUTCDATE()&#13;&#10;   )&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[AddShopFrom1CIfNotExists]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;&#13;&#10;&#13;&#10;CREATE PROCEDURE [dbo].[AddShopFrom1CIfNotExists]( &#13;&#10;  @pShopId nvarchar(200)&#13;&#10;) AS   &#13;&#10;IF NOT EXISTS(SELECT NULL FROM Shops WHERE (UPPER(ShopName) = UPPER(@pShopId)) or (UPPER(ShopId) = UPPER(@pShopId)))&#13;&#10;BEGIN&#13;&#10;&#9;INSERT Shops &#13;&#10;&#9;(&#13;&#10;&#9;&#9;ShopId&#13;&#10;&#9;&#9;,ShopName&#13;&#10;&#9;&#9;,ShopRegion&#13;&#10;&#9;&#9;,ExchangeError&#13;&#10;&#9;&#9;,LastSuccessfulUpload&#13;&#10;&#9;&#9;,LastSuccessfulReceive&#13;&#10;&#9;&#9;,AddressToConnect&#13;&#10;&#9;&#9;,Phone&#13;&#10;&#9;&#9;,IsClosed&#13;&#10;&#9;)&#13;&#10;&#9;VALUES&#9;&#9;&#9; &#13;&#10;&#9;(&#13;&#10;&#9;&#9;@pShopId&#13;&#10;&#9;&#9;,@pShopId &#13;&#10;&#9;&#9;,null&#13;&#10;&#9;&#9;,0&#13;&#10;&#9;&#9;,null&#13;&#10;&#9;&#9;,null&#13;&#10;&#9;&#9;,null&#13;&#10;&#9;&#9;,null&#13;&#10;&#9;&#9;,0)&#13;&#10;END&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[ChangeComputerParams]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10; &#13;&#10;CREATE PROCEDURE [dbo].[ChangeComputerParams]( &#13;&#10;  @pComputerId int&#13;&#10;  ,@pShopId nvarchar(100)&#13;&#10;  ,@ComputerName nvarchar(100)&#13;&#10;  ,@ComputerAddress varchar(50)&#13;&#10;  ,@pIs1CServer bit&#13;&#10;  ,@pIsMainCashbox bit&#13;&#10;) AS   &#13;&#10;&#9;UPDATE ShopComputers SET &#13;&#10;&#9;&#9;ShopId = @pShopId&#13;&#10;&#9;&#9;, ComputerName = @ComputerName&#13;&#10;&#9;&#9;, ComputerAddress = @ComputerAddress&#13;&#10;&#9;&#9;, Is1CServer = @pIs1CServer&#13;&#10;&#9;&#9;, IsMainCashbox = @pIsMainCashbox&#13;&#10;&#9;&#9;, LastUpdateTime = GETUTCDATE()&#13;&#10;&#9;WHERE ComputerId = @pComputerId&#13;&#10;&#13;&#10;&#9;SELECT NULL FROM ShopComputers WHERE ComputerId = @pComputerId&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[ChangeComputerParams_Servece]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE PROCEDURE [dbo].[ChangeComputerParams_Servece]( &#13;&#10;  @pComputerId int&#13;&#10;  ,@pShopId nvarchar(100)&#13;&#10;  ,@ComputerName nvarchar(100)&#13;&#10;  ,@ComputerAddress varchar(50)&#13;&#10;  ,@pIs1CServer bit&#13;&#10;  ,@pIsMainCashbox bit&#13;&#10;  ,@pMagicUpdaterVersion nvarchar(32)&#13;&#10;) AS   &#13;&#10;&#9;UPDATE ShopComputers SET &#13;&#10;&#9;&#9;ShopId = @pShopId&#13;&#10;&#9;&#9;, ComputerName = @ComputerName&#13;&#10;&#9;&#9;, ComputerAddress = @ComputerAddress&#13;&#10;&#9;&#9;, Is1CServer = @pIs1CServer&#13;&#10;&#9;&#9;, IsMainCashbox = @pIsMainCashbox&#13;&#10;&#9;&#9;, LastUpdateTime = GETUTCDATE()&#13;&#10;&#9;&#9;, MagicUpdaterVersion = @pMagicUpdaterVersion&#13;&#10;&#9;WHERE ComputerId = @pComputerId&#13;&#10;&#13;&#10;&#9;SELECT NULL FROM ShopComputers WHERE ComputerId = @pComputerId&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[ChengeShopForComputer]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10; &#13;&#10;CREATE PROCEDURE [dbo].[ChengeShopForComputer]( &#13;&#10;  @pComputerId int&#13;&#10;  ,@pShopId nvarchar(100)&#13;&#10;) AS   &#13;&#10;&#9;UPDATE ShopComputers SET ShopId = @pShopId WHERE ComputerId = @pComputerId&#13;&#10;&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[ComputerResponse]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10; &#13;&#10;CREATE PROCEDURE [dbo].[ComputerResponse]( &#13;&#10;  @pComputerId int&#13;&#10;  ,@ComputerName nvarchar(100)&#13;&#10;  ,@ComputerAddress varchar(50)&#13;&#10;  ,@isTaskerAlive bit = 0&#13;&#10;) AS  &#13;&#10;&#9;UPDATE ShopComputers SET ComputerName = @ComputerName, ComputerAddress = @ComputerAddress, LastUpdateTime = GETUTCDATE(), IsTaskerAlive = @isTaskerAlive WHERE ComputerId = @pComputerId&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[DeleteComputer]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE PROCEDURE [dbo].[DeleteComputer]( &#13;&#10;  @ComputerId int&#13;&#10;) AS   &#13;&#10;&#9;delete ComputerErrorsLog where ComputerId = @ComputerId&#13;&#10;&#9;delete ActionsReports where ComputerId = @ComputerId&#13;&#10;&#9;delete Logs1C where ComputerId = @ComputerId&#13;&#10;&#9;delete OperationsReports where OperationId in (select ID from Operations where ComputerId = @ComputerId)&#13;&#10;&#9;delete OperationsStates where OperationId in (select ID from Operations where ComputerId = @ComputerId)&#13;&#10;&#9;delete Operations where ComputerId = @ComputerId&#13;&#10;&#9;delete ShopComputers where ComputerId = @ComputerId&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[DeleteOneOperationReport]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE PROCEDURE [dbo].[DeleteOneOperationReport]( &#13;&#10;  @OperationId int&#13;&#10;) AS   &#13;&#10;&#9;delete OperationsStates where OperationId = @OperationId&#13;&#10;&#9;delete OperationsReports where OperationId = @OperationId&#13;&#10;&#9;delete operations where ID = @OperationId&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[DeleteOperationReports]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE PROCEDURE [dbo].[DeleteOperationReports]( &#13;&#10;  @OperationTypeId int&#13;&#10;) AS   &#13;&#10;&#9;delete OperationsStates where OperationId in (select id from operations where OperationType = @OperationTypeId) &#13;&#10;&#9;delete OperationsReports where OperationId in (select id from operations where OperationType = @OperationTypeId) &#13;&#10;&#9;delete operations where OperationType = @OperationTypeId&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[DeleteOperationType]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE PROCEDURE [dbo].[DeleteOperationType]( &#13;&#10;  @OperationTypeId int&#13;&#10;) AS   &#13;&#10;&#9;exec [dbo].[DeleteOperationReports] @OperationTypeId&#13;&#10;&#9;delete [dbo].[OperationTypes] where Id = @OperationTypeId&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[GetCommonGlobalSettings]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;&#13;&#10;CREATE procedure [dbo].[GetCommonGlobalSettings]  &#13;&#10;as  &#13;&#10;begin  &#13;&#10; select   &#13;&#10;  Id  &#13;&#10;  , Name  &#13;&#10;  , Value  &#13;&#10;  , Description  &#13;&#10; from [dbo].[CommonGlobalSettings]&#13;&#10;end&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[GetComputerById]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE PROCEDURE [dbo].[GetComputerById] ( &#13;&#10;  @ComputerId int&#13;&#10;) AS   &#13;&#10;select * from ShopComputers where ComputerId = @ComputerId&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[GetComputerSettings]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10; &#13;&#10;CREATE PROCEDURE [dbo].[GetComputerSettings]( &#13;&#10;  @pComputerHash nvarchar(32)&#13;&#10;) AS   &#13;&#10;&#9;SELECT  Computerid, ShopId, Is1CServer, IsMainCashbox FROM ShopComputers WHERE ComputerHash = @pComputerHash&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[GetComputerSettingsViaMac]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE PROCEDURE [dbo].[GetComputerSettingsViaMac]( &#13;&#10;  @pMac nvarchar(32)&#13;&#10;) AS   &#13;&#10;&#9;SELECT  Computerid, ShopId, Is1CServer, IsMainCashbox FROM ShopComputers WHERE Mac = @pMac&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[GetComputersList]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE PROCEDURE [dbo].[GetComputersList] ( &#13;&#10;  @ComputerId int&#13;&#10;) AS   &#13;&#10;select ComputerId, ShopId, ComputerName, ComputerAddress, is1CServer, isMainCashbox from ShopComputers where ShopID in (SELECT ShopId FROM ShopComputers WHERE ComputerId = @ComputerId &#13;&#10;) AND ComputerId &lt;&gt; @ComputerId AND IsON = 1&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[GetLocalSettingsForComputer]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE procedure [dbo].[GetLocalSettingsForComputer]  &#13;&#10;(  &#13;&#10; @ComputerId int  &#13;&#10;)  &#13;&#10;as  &#13;&#10;begin  &#13;&#10; select   &#13;&#10;  SettingId  &#13;&#10;  , Name  &#13;&#10;  , Value  &#13;&#10;  , Description  &#13;&#10; from [LocalSettingsView]  &#13;&#10; where ComputerId = @ComputerId&#13;&#10;end&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[GetOperationTypeByFileName]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;&#13;&#10;CREATE PROCEDURE [dbo].[GetOperationTypeByFileName]( &#13;&#10;  @FileName nvarchar(510)&#13;&#10;) AS   &#13;&#10;SELECT  &#13;&#10;&#9;Id&#13;&#10;&#9;,Name&#13;&#10;&#9;,NameRus&#13;&#10;&#9;,GroupId&#13;&#10;&#9;,LastModifiedDate&#13;&#10;&#9;,FileMD5&#13;&#10;&#9;,[Description]&#13;&#10;&#9;,[GUID] &#13;&#10;FROM [dbo].[OperationTypes] WHERE [FileName] = @FileName&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[GetOperationTypesList]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE PROCEDURE [dbo].[GetOperationTypesList] AS     &#13;&#10;select&#13;&#10;&#9;Id&#13;&#10;&#9;,Name&#13;&#10;&#9;,NameRus&#13;&#10;&#9;,GroupId&#13;&#10;&#9;,FileName&#13;&#10;&#9;,FileMD5&#13;&#10;&#9;,Description&#13;&#10;&#9;,GUID&#13;&#10;from [dbo].[OperationTypes]&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[IsShopExists]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;&#13;&#10;CREATE PROCEDURE [dbo].[IsShopExists]&#13;&#10;(&#13;&#10;&#9;@ShopId nvarchar(200)&#13;&#10;)&#13;&#10;AS   &#13;&#10;&#9;if(exists(SELECT NULL FROM Shops where ShopId = @ShopId))&#13;&#10;&#9;&#9;select 1 as result&#13;&#10;&#9;else&#13;&#10;&#9;&#9;select 0 as result&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[LogError]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;&#13;&#10;CREATE PROCEDURE [dbo].[LogError]&#13;&#10;    @ComputerId int,&#13;&#10;    @ErrorMessage nvarchar(max)&#13;&#10;AS &#13;&#10;&#9;SET NOCOUNT ON;&#13;&#10;&#13;&#10;&#9;--Костыль от засорения таблицы неизвестными агентами&#13;&#10;&#9;if @ComputerId in (95)&#13;&#10;&#9;begin&#13;&#10;&#9;&#9;return&#9;&#13;&#10;&#9;end&#13;&#10;&#13;&#10;&#9;INSERT INTO [dbo].ComputerErrorsLog&#13;&#10;&#9;(&#13;&#10;&#9;&#9;ComputerId,&#13;&#10;&#9;&#9;ErrorMessage,&#13;&#10;&#9;&#9;ErrorDate&#13;&#10;&#9;)&#13;&#10;&#9;VALUES&#13;&#10;&#9;(&#13;&#10;&#9;&#9;@ComputerId,&#13;&#10;&#9;&#9;@ErrorMessage,&#13;&#10;&#9;&#9;GETUTCDATE()&#13;&#10;&#9;)&#13;&#10;&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[RegisterComputer]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10; &#13;&#10;CREATE PROCEDURE [dbo].[RegisterComputer]( &#13;&#10;  @pShopId nvarchar(100)&#13;&#10;  ,@pComputerName nvarchar(100)&#13;&#10;  ,@pComputerAddress varchar(50)&#13;&#10;  ,@pIs1CServer bit&#13;&#10;  ,@pIsMainCashbox bit&#13;&#10;  ,@pMac nvarchar(32)&#13;&#10;) AS   &#13;&#10;IF NOT EXISTS(SELECT NULL FROM ShopComputers WHERE Mac = @pMac)&#13;&#10;BEGIN&#13;&#10;&#9;INSERT ShopComputers (ShopId  , ComputerName  , ComputerAddress  , Is1CServer  , IsMainCashbox  , LastUpdateTime                       , Mac)&#13;&#10;&#9;&#9;VALUES&#9;&#9;&#9; (@pShopId, @pComputerName, @pComputerAddress, @pIs1CServer, @pIsMainCashbox, GETUTCDATE(), @pMac)&#13;&#10;&#9;&#13;&#10;&#9;&#9;SELECT SCOPE_IDENTITY() AS ComputerId, 1 AS isNew&#13;&#10;END&#13;&#10;ELSE&#13;&#10;&#9;&#9;SELECT ComputerId, 0 AS isNew FROM ShopComputers WHERE Mac = @pMac&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[RegisterComputer_Service]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;&#13;&#10; &#13;&#10;CREATE PROCEDURE [dbo].[RegisterComputer_Service]( &#13;&#10;  @pShopId nvarchar(100)&#13;&#10;  ,@pComputerName nvarchar(100)&#13;&#10;  ,@pComputerAddress varchar(50)&#13;&#10;  ,@pIs1CServer bit&#13;&#10;  ,@pIsMainCashbox bit&#13;&#10;  ,@pMac nvarchar(32)&#13;&#10;) AS   &#13;&#10;IF NOT EXISTS(SELECT NULL FROM ShopComputers WHERE Mac = @pMac)&#13;&#10;BEGIN&#13;&#10;&#9;INSERT ShopComputers (ShopId  , ComputerName  , ComputerAddress  , Is1CServer  , IsMainCashbox  , LastUpdateTime                       , Mac)&#13;&#10;&#9;&#9;VALUES&#9;&#9;&#9; (@pShopId, @pComputerName, @pComputerAddress, @pIs1CServer, @pIsMainCashbox, GETUTCDATE(), @pMac)&#13;&#10;&#9;&#13;&#10;&#9;&#9;SELECT SCOPE_IDENTITY() AS ComputerId, 1 AS isNew&#13;&#10;END&#13;&#10;ELSE&#13;&#10;&#9;&#9;SELECT ComputerId, 0 AS isNew FROM ShopComputers WHERE Mac = @pMac&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[SelectComputersByShop]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10; &#13;&#10;CREATE PROCEDURE [dbo].[SelectComputersByShop](&#13;&#10;&#9;@pComputerID int &#13;&#10;&#9;, @pShopId nvarchar(200)&#13;&#10;)AS   &#13;&#10;    if isnull(@pComputerID, 0) = 0&#13;&#10;&#9;&#9;SELECT * FROM ShopComputers where ShopId = @pShopId&#13;&#10;&#9;else&#13;&#10;&#9;&#9;SELECT * FROM ShopComputers where ShopId = @pShopId AND ComputerId &lt;&gt; @pComputerID&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[SelectOperationsList]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE PROCEDURE [dbo].[SelectOperationsList](   &#13;&#10;  @pComputerID int  &#13;&#10;) AS     &#13;&#10;SELECT   &#13;&#10; o.ID   &#13;&#10; ,o.OperationType   &#13;&#10; ,o.Attributes  &#13;&#10;FROM Operations o   &#13;&#10;LEFT JOIN OperationsReports opr ON opr.OperationId = o.ID  &#13;&#10;WHERE   &#13;&#10; o.ComputerID = @pComputerID  &#13;&#10; AND isnull(opr.IsRead, 0) = 0&#13;&#10; AND o.OperationType &lt;&gt; 1003&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[SelectOperationsView]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE PROCEDURE [dbo].[SelectOperationsView] AS       &#13;&#10;SELECT &#13;&#10;&#9;*   &#13;&#10;FROM ViewOperations     &#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[SelectRestartOperation]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE PROCEDURE [dbo].[SelectRestartOperation](   &#13;&#10;  @pComputerID int  &#13;&#10;) AS     &#13;&#10;SELECT   &#13;&#10; o.ID   &#13;&#10; ,o.OperationType   &#13;&#10; ,o.Attributes  &#13;&#10;FROM Operations o   &#13;&#10;LEFT JOIN OperationsReports opr ON opr.OperationId = o.ID  &#13;&#10;WHERE   &#13;&#10; o.ComputerID = @pComputerID  &#13;&#10; AND isnull(opr.IsRead, 0) = 0&#13;&#10; AND o.OperationType = 1003&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[SelectShopsList]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10; &#13;&#10;CREATE PROCEDURE [dbo].[SelectShopsList]&#13;&#10;AS   &#13;&#10;&#9;SELECT * FROM Shops&#13;&#10;&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[SendLog1C]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;&#13;&#10;&#13;&#10;CREATE PROCEDURE [dbo].[SendLog1C]&#13;&#10;    @ComputerId int,&#13;&#10;&#9;@IsError bit,&#13;&#10;    @LogMessage nvarchar(max),&#13;&#10;&#9;@OperationId int = 0&#13;&#10;AS &#13;&#10;   SET NOCOUNT ON;&#13;&#10;&#13;&#10;   INSERT INTO [dbo].Logs1C&#13;&#10;   (&#13;&#10;&#9;&#9;ComputerId,&#13;&#10;&#9;&#9;IsError,&#13;&#10;&#9;&#9;LogMessage,&#13;&#10;&#9;&#9;LogDate,&#13;&#10;&#9;&#9;OperationId&#13;&#10;   )&#13;&#10;   VALUES&#13;&#10;   (&#13;&#10;&#9;&#9;@ComputerId,&#13;&#10;&#9;&#9;@IsError,&#13;&#10;&#9;&#9;@LogMessage,&#13;&#10;&#9;&#9;GETUTCDATE(),&#13;&#10;&#9;&#9;@OperationId&#13;&#10;   )&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[SendOperationReport]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10; &#13;&#10;CREATE PROCEDURE [dbo].[SendOperationReport]( &#13;&#10;  @pOperationID int&#13;&#10;  ,@pIsCompleted bit&#13;&#10;  ,@pResult varchar(MAX)&#13;&#10;) AS   &#13;&#10;&#9;UPDATE OperationsReports SET IsCompleted = @pIsCompleted, Result = @pResult, DateCompleteOrError = GETUTCDATE() WHERE OperationId = @pOperationID&#13;&#10;&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[SetActionReport]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;&#13;&#10;CREATE PROCEDURE [dbo].[SetActionReport]( &#13;&#10;  @pOperationId int&#13;&#10;  ,@pComputerId int&#13;&#10;  ,@pActionName nvarchar(100)&#13;&#10;  ,@pIsFromLan bit&#13;&#10;  ,@pIsCompleted bit&#13;&#10;  ,@pResult nvarchar(MAX)&#13;&#10;) AS   &#13;&#10;insert ActionsReports (OperationId, ComputerId, ActionName, IsFromLan, IsCompleted, DateCompleteOrError, Result)&#13;&#10;&#9;values&#13;&#10;&#9;&#9;&#9;&#9;&#9;  (@pOperationId, @pComputerId, @pActionName, @pIsFromLan, @pIsCompleted, GETUTCDATE(), @pResult)&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#9;&#9;&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[SetAgentLastError]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE PROCEDURE [dbo].[SetAgentLastError]&#13;&#10;    @ComputerId int,&#13;&#10;    @ErrorMessage nvarchar(max)&#13;&#10;AS &#13;&#10;   SET NOCOUNT ON;&#13;&#10;&#13;&#10;   UPDATE [dbo].[ShopComputers]&#13;&#10;   SET &#13;&#10;&#9;LastError = @ErrorMessage&#13;&#10;&#9;,LastErrorDate = GETUTCDATE()&#13;&#10;   WHERE ComputerId = @ComputerId&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[SetCommonGlobalSettings]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;Create procedure [dbo].[SetCommonGlobalSettings]  &#13;&#10;(  &#13;&#10; @SettingName nvarchar(512)  &#13;&#10; , @SettingValue nvarchar(2000)  &#13;&#10;)  &#13;&#10;as  &#13;&#10;begin  &#13;&#10; declare @settingId int  &#13;&#10;  &#13;&#10; select @settingId = id from [dbo].[CommonGlobalSettings] where Name = @SettingName  &#13;&#10;  &#13;&#10; if (isnull(@settingId, 0) &lt;&gt; 0)  &#13;&#10; begin  &#13;&#10;   if not exists(select null from [dbo].[CommonGlobalSettings] where Id = @settingId)  &#13;&#10;   begin  &#13;&#10;     insert [dbo].[CommonGlobalSettings] (Id, Value)  &#13;&#10;     values  &#13;&#10;     (@settingId, @SettingValue)  &#13;&#10;   end  &#13;&#10;   else  &#13;&#10;   begin  &#13;&#10;     update [dbo].[CommonGlobalSettings] set Value = @SettingValue where Id = @settingId  &#13;&#10;   end  &#13;&#10; end  &#13;&#10;end&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[SetExternalIp_Service]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;&#13;&#10;CREATE PROCEDURE [dbo].[SetExternalIp_Service]( &#13;&#10;  @pComputerId int&#13;&#10;  , @pExternalAddress varchar(50)&#13;&#10;) AS  &#13;&#10;&#9;UPDATE ShopComputers SET External_IP = @pExternalAddress WHERE ComputerId = @pComputerId&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[SetIsAgentSettingsReaded]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;        &#13;&#10;CREATE PROCEDURE [dbo].[SetIsAgentSettingsReaded](        &#13;&#10;&#9;@ComputerId int&#13;&#10;&#9;,@value bit       &#13;&#10;)        &#13;&#10;AS           &#13;&#10;&#9;update [dbo].[ShopComputers]&#13;&#10;&#9;&#9;set IsAgentSettingsReaded = @value&#13;&#10;&#9;where ComputerId = @ComputerId&#13;&#10; &#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[SetLocalSettingsForComputer]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE procedure [dbo].[SetLocalSettingsForComputer]  &#13;&#10;(  &#13;&#10; @ComputerId int  &#13;&#10; , @SettingName nvarchar(512)  &#13;&#10; , @SettingValue nvarchar(2000)  &#13;&#10;)  &#13;&#10;as  &#13;&#10;begin  &#13;&#10; declare @settingId int  &#13;&#10;  &#13;&#10; select @settingId = SettingId from [dbo].[LocalSettingsDictionary] where Name = @SettingName  &#13;&#10;  &#13;&#10; if (isnull(@settingId, 0) &lt;&gt; 0)  &#13;&#10; begin  &#13;&#10;   if not exists(select null from [dbo].[LocalSettingsView] where ComputerId = @ComputerId and SettingId = @settingId)  &#13;&#10;   begin  &#13;&#10;     insert [dbo].[LocalSettings] (ComputerId, SettingId, Value)  &#13;&#10;     values  &#13;&#10;     (@ComputerId, @settingId, @SettingValue)  &#13;&#10;   end  &#13;&#10;   else  &#13;&#10;   begin  &#13;&#10;     update [dbo].[LocalSettings] set Value = @SettingValue where ComputerId = @ComputerId and SettingId = @settingId  &#13;&#10;   end  &#13;&#10; end  &#13;&#10;end&#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[SetMacAddress_Service]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;&#13;&#10;CREATE PROCEDURE [dbo].[SetMacAddress_Service]( &#13;&#10;  @pComputerId int&#13;&#10;  ,@pShopId nvarchar(100)&#13;&#10;  ,@ComputerName nvarchar(100)&#13;&#10;  ,@ComputerAddress varchar(50)&#13;&#10;  ,@pIs1CServer bit&#13;&#10;  ,@pIsMainCashbox bit&#13;&#10;  ,@pMac nvarchar(32)&#13;&#10;) AS   &#13;&#10;&#9;UPDATE ShopComputers SET &#13;&#10;&#9;&#9;ShopId = @pShopId&#13;&#10;&#9;&#9;, ComputerName = @ComputerName&#13;&#10;&#9;&#9;, ComputerAddress = @ComputerAddress&#13;&#10;&#9;&#9;, Is1CServer = @pIs1CServer&#13;&#10;&#9;&#9;, IsMainCashbox = @pIsMainCashbox&#13;&#10;&#9;&#9;, LastUpdateTime = GETUTCDATE()&#13;&#10;&#9;&#9;, Mac = @pMac&#13;&#10;&#9;WHERE ComputerId = @pComputerId&#13;&#10;&#13;&#10;&#9;SELECT NULL FROM ShopComputers WHERE ComputerId = @pComputerId&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[SetMainSqlSettings]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10; CREATE PROCEDURE [dbo].[SetMainSqlSettings](   &#13;&#10;  @pComputerId int  &#13;&#10;  ,@pShopId nvarchar(100)  &#13;&#10;  ,@pIs1CServer bit  &#13;&#10;  ,@pIsMainCashbox bit  &#13;&#10;) AS     &#13;&#10; UPDATE ShopComputers SET   &#13;&#10;  ShopId = @pShopId  &#13;&#10;  , Is1CServer = @pIs1CServer  &#13;&#10;  , IsMainCashbox = @pIsMainCashbox  &#13;&#10; WHERE ComputerId = @pComputerId  &#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[SetOperationIsReaded]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE PROCEDURE [dbo].[SetOperationIsReaded]( &#13;&#10;  @pOperationID int&#13;&#10;) AS   &#13;&#10;if not exists(select null from OperationsReports where OperationId = @pOperationID)&#13;&#10;begin&#13;&#10;&#9;insert OperationsReports &#13;&#10;&#9;&#9;(OperationId, IsRead, isCompleted, Result, DateRead) &#13;&#10;&#9;&#9;values&#13;&#10;&#9;&#9;(@pOperationID, 1, 0, &apos;&apos;, GETUTCDATE())&#13;&#10;&#9;select 1 as Result&#13;&#10;end&#13;&#10;else&#13;&#10;&#9;select 0 as Result&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[SetShopToOpen]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE PROCEDURE [dbo].[SetShopToOpen](   &#13;&#10;  @pShopId nvarchar(100)  &#13;&#10;) AS     &#13;&#10;update [dbo].[Shops] set IsClosed = 0 where ShopId = @pShopId&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[sp_GetTableData]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;CREATE PROCEDURE [dbo].[sp_GetTableData] (    &#13;&#10;   @TableName varchar(200))    &#13;&#10;AS     &#13;&#10;   -- Remove any square brackets, we only want the table name    &#13;&#10;   SET @TableName = REPLACE(REPLACE(@TableName, &apos;[&apos;, &apos;&apos;), &apos;]&apos;, &apos;&apos;)    &#13;&#10;     &#13;&#10;   DECLARE @SelectFrom nvarchar(max);    &#13;&#10;   -- If temp table exists remove it    &#13;&#10;   IF OBJECT_ID(&apos;tempdb..#TableNames&apos;) IS NOT NULL     &#13;&#10;      DROP TABLE #TableNames;    &#13;&#10;     &#13;&#10;   -- Get a list of all tables that match in all schemas    &#13;&#10;   SELECT   TableName = s.NAME + &apos;.&apos; + o.name    &#13;&#10;   INTO     #TableNames    &#13;&#10;   FROM     sys.objects o    &#13;&#10;   JOIN     sys.schemas s ON o.schema_id = s.schema_id    &#13;&#10;   WHERE    o.name = @TableName    &#13;&#10;            AND o.type in (&apos;U&apos;,&apos;V&apos;)    &#13;&#10;     &#13;&#10;   -- Loop through all tables and output table results    &#13;&#10;   WHILE ( SELECT COUNT (1) FROM #TableNames ) &gt;= 1     &#13;&#10;      BEGIN    &#13;&#10;         SELECT TOP 1 @SelectFrom = N&apos;SELECT * FROM &apos; + TableName    &#13;&#10;         FROM     #TableNames T    &#13;&#10;     &#13;&#10;         EXECUTE sp_executesql @SelectFrom;    &#13;&#10;     &#13;&#10;         DELETE TOP (1) FROM #TableNames    &#13;&#10;      END    &#13;&#10;     &#13;&#10;   -- clean up    &#13;&#10;   DROP TABLE #TableNames  &#13;&#10;&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[UpdateOperationTypeById]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;&#13;&#10;CREATE PROCEDURE [dbo].[UpdateOperationTypeById](     &#13;&#10; @Id int    &#13;&#10; ,@Name nvarchar(512)    &#13;&#10; ,@NameRus nvarchar(512)    &#13;&#10; ,@GroupId int    &#13;&#10; ,@FileName nvarchar(510)    &#13;&#10; ,@LastModifiedDate datetime  &#13;&#10; ,@FileMD5 nvarchar(64)    &#13;&#10; ,@Description nvarchar(MAX)    &#13;&#10;) AS       &#13;&#10; UPDATE [dbo].[OperationTypes] SET     &#13;&#10;  [Name]   = @Name    &#13;&#10;  ,[NameRus]  = @NameRus    &#13;&#10;  ,[GroupId]  = @GroupId    &#13;&#10;  ,[FileName]  = @FileName   &#13;&#10;  ,[LastModifiedDate] = @LastModifiedDate   &#13;&#10;  ,[FileMD5]  = @FileMD5    &#13;&#10;  ,[Description] = @Description&#13;&#10;  ,[Visible] = 1 &#13;&#10; WHERE [Id] = @Id    &#13;&#10;    &#13;&#10;    &#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[UpdateOperationTypesFieldsById]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10;&#13;&#10;CREATE PROCEDURE [dbo].[UpdateOperationTypesFieldsById]&#13;&#10;&#9;@Id int&#13;&#10;&#9;,@FieldName nvarchar(512)&#13;&#10;&#9;,@Value nvarchar(max)&#13;&#10;AS &#13;&#10;BEGIN TRY &#13;&#10;&#9;declare @IdStr nvarchar(512) = cast(@Id as nvarchar)&#13;&#10;&#9;exec (N&apos;update [dbo].[OperationTypes] set [&apos;+@FieldName+&apos;] = &apos;&apos;&apos;+@Value+&apos;&apos;&apos; where Id = &apos;+@IdStr)&#13;&#10;&#9;select 0 as ResultId, N&apos;&apos; as [Message]&#13;&#10;END TRY  &#13;&#10;BEGIN CATCH&#13;&#10;&#9;select -1 as ResultId, N&apos;Ошибка изменения поля &apos;+@FieldName as [Message]&#13;&#10;END CATCH&#13;&#10;GO&#13;&#10;/****** Object:  StoredProcedure [dbo].[UpdateVersion]    Script Date: 18.07.2017 18:12:46 ******/&#13;&#10;SET ANSI_NULLS ON&#13;&#10;GO&#13;&#10;SET QUOTED_IDENTIFIER ON&#13;&#10;GO&#13;&#10; &#13;&#10;CREATE PROCEDURE [dbo].[UpdateVersion]( &#13;&#10;  @pComputerId int&#13;&#10;  ,@pVersion nvarchar(32)&#13;&#10;) AS   &#13;&#10;&#9;UPDATE ShopComputers SET &#13;&#10;&#9;&#9;MagicUpdaterVersion = @pVersion&#13;&#10;&#9;WHERE ComputerId = @pComputerId&#13;&#10;&#13;&#10;&#9;SELECT NULL FROM ShopComputers WHERE ComputerId = @pComputerId&#13;&#10;" Flags="290" Order="0"/>
    <ROW ScriptName="GlobalSettings" ConnectionName="DlgPredefinedConnection" Condition="ONLY_MONITOR = &quot;0&quot;" Separator="GO" ScriptInline="-- Inline SQL script&#13;&#10;USE [MagicUpdater]&#13;&#10;GO&#13;&#10;SET IDENTITY_INSERT [dbo].[CommonGlobalSettings] ON &#13;&#10;GO&#13;&#10;INSERT [dbo].[CommonGlobalSettings] ([Id], [Name], [Value], [Description]) VALUES (1, N&apos;MonitorSelfUpdatePath&apos;, N&apos;&apos;, N&apos;Путь для обновления монитора&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[CommonGlobalSettings] ([Id], [Name], [Value], [Description]) VALUES (2, N&apos;SelfUpdateFtpServer&apos;, N&apos;#FTPSERVER&apos;, N&apos;Сервер Ftp для самообновления&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[CommonGlobalSettings] ([Id], [Name], [Value], [Description]) VALUES (3, N&apos;SelfUpdateFtpUser&apos;, N&apos;#FTPLOGIN&apos;, N&apos;Логин сервера Ftp для самообновления&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[CommonGlobalSettings] ([Id], [Name], [Value], [Description]) VALUES (4, N&apos;SelfUpdateFtpPassword&apos;, N&apos;#FTPPASSWORD&apos;, N&apos;Пароль сервера Ftp для самообновления&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[CommonGlobalSettings] ([Id], [Name], [Value], [Description]) VALUES (5, N&apos;SelfUpdateFtpPath&apos;, N&apos;#FTPCATALOG&apos;, N&apos;Путь до папки Ftp для самообновления&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[CommonGlobalSettings] ([Id], [Name], [Value], [Description]) VALUES (7, N&apos;AgentLastVersionPathForMonitor&apos;, N&apos;&apos;, N&apos;Путь до exe агента последней версии. Для определения последний версии агента и маркировки версий в основном гриде.&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[CommonGlobalSettings] ([Id], [Name], [Value], [Description]) VALUES (9, N&apos;TempFilesFtpPath&apos;, N&apos;#FTPTMPCATALOG&apos;, N&apos;Поть для временных файлов с которыми работают некоторые операции (например обработок 1С)&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[CommonGlobalSettings] ([Id], [Name], [Value], [Description]) VALUES (10, N&apos;Server1C&apos;, N&apos;#SERVER1C&apos;, N&apos;Сервер 1С&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[CommonGlobalSettings] ([Id], [Name], [Value], [Description]) VALUES (11, N&apos;Base1C&apos;, N&apos;#BASE1C&apos;, N&apos;База 1С&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[CommonGlobalSettings] ([Id], [Name], [Value], [Description]) VALUES (13, N&apos;User1C&apos;, N&apos;#USER1C&apos;, N&apos;Пользователь базы 1С&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[CommonGlobalSettings] ([Id], [Name], [Value], [Description]) VALUES (14, N&apos;Password1C&apos;, N&apos;#PASSWORD1C&apos;, N&apos;Пароль пользователя 1С&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[CommonGlobalSettings] ([Id], [Name], [Value], [Description]) VALUES (15, N&apos;Platform&apos;, N&apos;#PLATFORM1C&apos;, N&apos;Версия платформы 1С&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[CommonGlobalSettings] ([Id], [Name], [Value], [Description]) VALUES (16, N&apos;AddressAst&apos;, N&apos;&apos;, N&apos;Адрес астериск&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[CommonGlobalSettings] ([Id], [Name], [Value], [Description]) VALUES (17, N&apos;UserAst&apos;, N&apos;&apos;, N&apos;Пользователь астериск&apos;)&#13;&#10;GO&#13;&#10;INSERT [dbo].[CommonGlobalSettings] ([Id], [Name], [Value], [Description]) VALUES (18, N&apos;PasswordAst&apos;, N&apos;&apos;, N&apos;Пароль астериск&apos;)&#13;&#10;GO&#13;&#10;SET IDENTITY_INSERT [dbo].[CommonGlobalSettings] OFF&#13;&#10;GO&#13;&#10;" Flags="290" Order="2"/>
    <ATTRIBUTE name="ImpersonateUser" value="true"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.XmlAttributeComponent">
    <ROW XmlAttribute="allowExeDefinition" XmlElement="section_1" Name="allowExeDefinition" Flags="14" Order="2" Value="MachineToLocalUser"/>
    <ROW XmlAttribute="invariantName" XmlElement="provider" Name="invariantName" Flags="14" Order="0" Value="System.Data.SqlClient"/>
    <ROW XmlAttribute="name" XmlElement="section" Name="name" Flags="15" Order="0" Value="entityFramework"/>
    <ROW XmlAttribute="name_1" XmlElement="sectionGroup" Name="name" Flags="15" Order="0" Value="userSettings"/>
    <ROW XmlAttribute="name_10" XmlElement="setting_7" Name="name" Flags="15" Order="0" Value="MainWindowStartPosition"/>
    <ROW XmlAttribute="name_11" XmlElement="setting_8" Name="name" Flags="15" Order="0" Value="Setting"/>
    <ROW XmlAttribute="name_2" XmlElement="section_1" Name="name" Flags="15" Order="0" Value="MagicUpdaterMonitor.Properties.Settings"/>
    <ROW XmlAttribute="name_3" XmlElement="setting" Name="name" Flags="15" Order="0" Value="MainWindowLocation"/>
    <ROW XmlAttribute="name_4" XmlElement="setting_1" Name="name" Flags="15" Order="0" Value="MainWindowState"/>
    <ROW XmlAttribute="name_5" XmlElement="setting_2" Name="name" Flags="15" Order="0" Value="MainWindowSize"/>
    <ROW XmlAttribute="name_6" XmlElement="setting_3" Name="name" Flags="15" Order="0" Value="scShopsOpersDistance"/>
    <ROW XmlAttribute="name_7" XmlElement="setting_4" Name="name" Flags="15" Order="0" Value="scOpersDistance"/>
    <ROW XmlAttribute="name_8" XmlElement="setting_5" Name="name" Flags="15" Order="0" Value="scMainDistance"/>
    <ROW XmlAttribute="name_9" XmlElement="setting_6" Name="name" Flags="15" Order="0" Value="scSendOpersDistance"/>
    <ROW XmlAttribute="requirePermission" XmlElement="section" Name="requirePermission" Flags="14" Order="2" Value="false"/>
    <ROW XmlAttribute="requirePermission_1" XmlElement="section_1" Name="requirePermission" Flags="14" Order="3" Value="false"/>
    <ROW XmlAttribute="serializeAs" XmlElement="setting" Name="serializeAs" Flags="14" Order="1" Value="String"/>
    <ROW XmlAttribute="serializeAs_1" XmlElement="setting_1" Name="serializeAs" Flags="14" Order="1" Value="String"/>
    <ROW XmlAttribute="serializeAs_2" XmlElement="setting_2" Name="serializeAs" Flags="14" Order="1" Value="String"/>
    <ROW XmlAttribute="serializeAs_3" XmlElement="setting_3" Name="serializeAs" Flags="14" Order="1" Value="String"/>
    <ROW XmlAttribute="serializeAs_4" XmlElement="setting_4" Name="serializeAs" Flags="14" Order="1" Value="String"/>
    <ROW XmlAttribute="serializeAs_5" XmlElement="setting_5" Name="serializeAs" Flags="14" Order="1" Value="String"/>
    <ROW XmlAttribute="serializeAs_6" XmlElement="setting_6" Name="serializeAs" Flags="14" Order="1" Value="String"/>
    <ROW XmlAttribute="serializeAs_7" XmlElement="setting_7" Name="serializeAs" Flags="14" Order="1" Value="String"/>
    <ROW XmlAttribute="serializeAs_8" XmlElement="setting_8" Name="serializeAs" Flags="14" Order="1" Value="String"/>
    <ROW XmlAttribute="sku" XmlElement="supportedRuntime" Name="sku" Flags="14" Order="1" Value=".NETFramework,Version=v4.5"/>
    <ROW XmlAttribute="type" XmlElement="section" Name="type" Flags="14" Order="1" Value="System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"/>
    <ROW XmlAttribute="type_1" XmlElement="sectionGroup" Name="type" Flags="14" Order="1" Value="System.Configuration.UserSettingsGroup, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"/>
    <ROW XmlAttribute="type_2" XmlElement="section_1" Name="type" Flags="14" Order="1" Value="System.Configuration.ClientSettingsSection, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"/>
    <ROW XmlAttribute="type_3" XmlElement="defaultConnectionFactory" Name="type" Flags="14" Order="0" Value="System.Data.Entity.Infrastructure.LocalDbConnectionFactory, EntityFramework"/>
    <ROW XmlAttribute="type_4" XmlElement="provider" Name="type" Flags="14" Order="1" Value="System.Data.Entity.SqlServer.SqlProviderServices, EntityFramework.SqlServer"/>
    <ROW XmlAttribute="value" XmlElement="parameter" Name="value" Flags="14" Order="0" Value="mssqllocaldb"/>
    <ROW XmlAttribute="version" XmlElement="supportedRuntime" Name="version" Flags="14" Order="0" Value="v4.0"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.XmlElementComponent">
    <ROW XmlElement="Comment" ParentElement="configSections" Name="Comment" Condition="1" Order="0" Flags="1" Text="&lt;section name=&quot;entityFramework&quot; type=&quot;System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot; requirePermission=&quot;false&quot; /&gt;"/>
    <ROW XmlElement="Comment_1" ParentElement="configSections" Name="Comment" Condition="1" Order="1" Flags="1" Text=" For more information on Entity Framework configuration, visit http://go.microsoft.com/fwlink/?LinkID=237468 "/>
    <ROW XmlElement="Comment_2" ParentElement="configuration" Name="Comment" Condition="1" Order="3" Flags="1" Text="&lt;connectionStrings&gt;&#13;&#10;&#9;&#9;&lt;add name=&quot;MagicUpdaterEntities&quot; connectionString=&quot;metadata=res://*/TaskDBModel.csdl|res://*/TaskDBModel.ssdl|res://*/TaskDBModel.msl;provider=System.Data.SqlClient;provider connection string=&amp;quot;data source=mu.sela.ru;initial catalog=MagicUpdater;persist security info=True;user id=Sela;password=Kizombo1313;MultipleActiveResultSets=True;App=EntityFramework&amp;quot;&quot; providerName=&quot;System.Data.EntityClient&quot; /&gt;&#13;&#10;&#9;&lt;/connectionStrings&gt;"/>
    <ROW XmlElement="MagicUpdaterMonitor.Properties.Settings" ParentElement="userSettings" Name="MagicUpdaterMonitor.Properties.Settings" Condition="1" Order="0" Flags="14"/>
    <ROW XmlElement="configSections" ParentElement="configuration" Name="configSections" Condition="1" Order="0" Flags="14"/>
    <ROW XmlElement="configuration" Name="configuration" Condition="1" Order="0" Flags="30"/>
    <ROW XmlElement="defaultConnectionFactory" ParentElement="entityFramework" Name="defaultConnectionFactory" Condition="1" Order="0" Flags="14"/>
    <ROW XmlElement="entityFramework" ParentElement="configuration" Name="entityFramework" Condition="1" Order="2" Flags="14"/>
    <ROW XmlElement="parameter" ParentElement="parameters" Name="parameter" Condition="1" Order="0" Flags="14"/>
    <ROW XmlElement="parameters" ParentElement="defaultConnectionFactory" Name="parameters" Condition="1" Order="0" Flags="14"/>
    <ROW XmlElement="provider" ParentElement="providers" Name="provider" Condition="1" Order="0" Flags="14"/>
    <ROW XmlElement="providers" ParentElement="entityFramework" Name="providers" Condition="1" Order="1" Flags="14"/>
    <ROW XmlElement="section" ParentElement="configSections" Name="section" Condition="1" Order="2" Flags="14"/>
    <ROW XmlElement="sectionGroup" ParentElement="configSections" Name="sectionGroup" Condition="1" Order="3" Flags="14"/>
    <ROW XmlElement="section_1" ParentElement="sectionGroup" Name="section" Condition="1" Order="0" Flags="14"/>
    <ROW XmlElement="setting" ParentElement="MagicUpdaterMonitor.Properties.Settings" Name="setting" Condition="1" Order="0" Flags="14"/>
    <ROW XmlElement="setting_1" ParentElement="MagicUpdaterMonitor.Properties.Settings" Name="setting" Condition="1" Order="1" Flags="14"/>
    <ROW XmlElement="setting_2" ParentElement="MagicUpdaterMonitor.Properties.Settings" Name="setting" Condition="1" Order="2" Flags="14"/>
    <ROW XmlElement="setting_3" ParentElement="MagicUpdaterMonitor.Properties.Settings" Name="setting" Condition="1" Order="3" Flags="14"/>
    <ROW XmlElement="setting_4" ParentElement="MagicUpdaterMonitor.Properties.Settings" Name="setting" Condition="1" Order="4" Flags="14"/>
    <ROW XmlElement="setting_5" ParentElement="MagicUpdaterMonitor.Properties.Settings" Name="setting" Condition="1" Order="5" Flags="14"/>
    <ROW XmlElement="setting_6" ParentElement="MagicUpdaterMonitor.Properties.Settings" Name="setting" Condition="1" Order="6" Flags="14"/>
    <ROW XmlElement="setting_7" ParentElement="MagicUpdaterMonitor.Properties.Settings" Name="setting" Condition="1" Order="7" Flags="14"/>
    <ROW XmlElement="setting_8" ParentElement="MagicUpdaterMonitor.Properties.Settings" Name="setting" Condition="1" Order="8" Flags="14"/>
    <ROW XmlElement="startup" ParentElement="configuration" Name="startup" Condition="1" Order="1" Flags="14"/>
    <ROW XmlElement="supportedRuntime" ParentElement="startup" Name="supportedRuntime" Condition="1" Order="0" Flags="14"/>
    <ROW XmlElement="userSettings" ParentElement="configuration" Name="userSettings" Condition="1" Order="4" Flags="14"/>
    <ROW XmlElement="value" ParentElement="setting" Name="value" Condition="1" Order="0" Flags="14" Text="0, 0"/>
    <ROW XmlElement="value_1" ParentElement="setting_1" Name="value" Condition="1" Order="0" Flags="14" Text="Maximized"/>
    <ROW XmlElement="value_2" ParentElement="setting_2" Name="value" Condition="1" Order="0" Flags="14" Text="0, 0"/>
    <ROW XmlElement="value_3" ParentElement="setting_3" Name="value" Condition="1" Order="0" Flags="14" Text="0"/>
    <ROW XmlElement="value_4" ParentElement="setting_4" Name="value" Condition="1" Order="0" Flags="14" Text="0"/>
    <ROW XmlElement="value_5" ParentElement="setting_5" Name="value" Condition="1" Order="0" Flags="14" Text="0"/>
    <ROW XmlElement="value_6" ParentElement="setting_6" Name="value" Condition="1" Order="0" Flags="14" Text="0"/>
    <ROW XmlElement="value_7" ParentElement="setting_7" Name="value" Condition="1" Order="0" Flags="14" Text="Manual"/>
    <ROW XmlElement="value_8" ParentElement="setting_8" Name="value" Condition="1" Order="0" Flags="14"/>
  </COMPONENT>
  <COMPONENT cid="caphyon.advinst.msicomp.XmlFileComponent">
    <ROW XmlFile="MagicUpdaterMonitor.exe.config" FileName="MAGICU~1.CON|MagicUpdaterMonitor.exe.config" DirProperty="APPDIR" Component="ProductInformation" RootElement="configuration" Flags="89" Version="1.0" Encoding="utf-8" IndentUnits="2"/>
  </COMPONENT>
</DOCUMENT>
